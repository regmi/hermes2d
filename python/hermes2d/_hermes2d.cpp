/* Generated by Cython 0.11.2 on Tue Jun 22 14:46:39 2010 */
/* Corrected by convert_api.py on Tue Jun 22 14:46:40 2010 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
  #define PyDict_CheckExact(op) (Py_TYPE(op) == &PyDict_Type)
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PY_FORMAT_SIZE_T ""
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)

  typedef struct {
       void *buf;
       PyObject *obj;
       Py_ssize_t len;
       Py_ssize_t itemsize;
       int readonly;
       int ndim;
       char *format;
       Py_ssize_t *shape;
       Py_ssize_t *strides;
       Py_ssize_t *suboffsets;
       void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyString_Type                PyBytes_Type
  #define PyString_CheckExact          PyBytes_CheckExact
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define PyBytes_Type                 PyString_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#else
  #define _USE_MATH_DEFINES
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),((char *)(n)))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),((char *)(n)),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),((char *)(n)))
#else
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),(n))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),(n),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),(n))
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_NAMESTR(n) ((char *)(n))
  #define __Pyx_DOCSTR(n)  ((char *)(n))
#else
  #define __Pyx_NAMESTR(n) (n)
  #define __Pyx_DOCSTR(n)  (n)
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#define __PYX_HAVE_API__hermes2d___hermes2d
#include "math.h"
#include "stdlib.h"
#include "arrayobject.h"
#include "stdcython.h"
#include "hermes2d.h"
#include "dummy_solver.h"
#include "matrix.h"
#define __PYX_USE_C99_COMPLEX defined(_Complex_I)


#ifdef __GNUC__
#define INLINE __inline__
#elif _WIN32
#define INLINE __inline
#else
#define INLINE 
#endif

typedef struct {PyObject **p; char *s; long n; char is_unicode; char intern; char is_identifier;} __Pyx_StringTabEntry; /*proto*/



static int __pyx_skip_dispatch = 0;


/* Type Conversion Predeclarations */

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyBytes_FromString          PyString_FromString
#define __Pyx_PyBytes_FromStringAndSize   PyString_FromStringAndSize
#define __Pyx_PyBytes_AsString            PyString_AsString
#else
#define __Pyx_PyBytes_FromString          PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize   PyBytes_FromStringAndSize
#define __Pyx_PyBytes_AsString            PyBytes_AsString
#endif

#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);

#if !defined(T_PYSSIZET)
#if PY_VERSION_HEX < 0x02050000
#define T_PYSSIZET T_INT
#elif !defined(T_LONGLONG)
#define T_PYSSIZET \
        ((sizeof(Py_ssize_t) == sizeof(int))  ? T_INT  : \
        ((sizeof(Py_ssize_t) == sizeof(long)) ? T_LONG : -1))
#else
#define T_PYSSIZET \
        ((sizeof(Py_ssize_t) == sizeof(int))          ? T_INT      : \
        ((sizeof(Py_ssize_t) == sizeof(long))         ? T_LONG     : \
        ((sizeof(Py_ssize_t) == sizeof(PY_LONG_LONG)) ? T_LONGLONG : -1)))
#endif
#endif

#if !defined(T_SIZET)
#if !defined(T_ULONGLONG)
#define T_SIZET \
        ((sizeof(size_t) == sizeof(unsigned int))  ? T_UINT  : \
        ((sizeof(size_t) == sizeof(unsigned long)) ? T_ULONG : -1))
#else
#define T_SIZET \
        ((sizeof(size_t) == sizeof(unsigned int))          ? T_UINT      : \
        ((sizeof(size_t) == sizeof(unsigned long))         ? T_ULONG     : \
        ((sizeof(size_t) == sizeof(unsigned PY_LONG_LONG)) ? T_ULONGLONG : -1)))
#endif
#endif

static INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
static INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);

#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))


#ifdef __GNUC__
/* Test for GCC > 2.95 */
#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
#define likely(x)   __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* __GNUC__ > 2 ... */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;
static const char **__pyx_f;


#ifdef CYTHON_REFNANNY
typedef struct {
  void (*INCREF)(void*, PyObject*, int);
  void (*DECREF)(void*, PyObject*, int);
  void (*GOTREF)(void*, PyObject*, int);
  void (*GIVEREF)(void*, PyObject*, int);
  void* (*NewContext)(const char*, int, const char*);
  void (*FinishContext)(void**);
} __Pyx_RefnannyAPIStruct;
static __Pyx_RefnannyAPIStruct *__Pyx_Refnanny = NULL;
#define __Pyx_ImportRefcountAPI(name)   (__Pyx_RefnannyAPIStruct *) PyCObject_Import((char *)name, (char *)"RefnannyAPI")
#define __Pyx_INCREF(r) __Pyx_Refnanny->INCREF(__pyx_refchk, (PyObject *)(r), __LINE__)
#define __Pyx_DECREF(r) __Pyx_Refnanny->DECREF(__pyx_refchk, (PyObject *)(r), __LINE__)
#define __Pyx_GOTREF(r) __Pyx_Refnanny->GOTREF(__pyx_refchk, (PyObject *)(r), __LINE__)
#define __Pyx_GIVEREF(r) __Pyx_Refnanny->GIVEREF(__pyx_refchk, (PyObject *)(r), __LINE__)
#define __Pyx_XDECREF(r) if((r) == NULL) ; else __Pyx_DECREF(r)
#define __Pyx_SetupRefcountContext(name)   void* __pyx_refchk = __Pyx_Refnanny->NewContext((name), __LINE__, __FILE__)
#define __Pyx_FinishRefcountContext()   __Pyx_Refnanny->FinishContext(&__pyx_refchk)
#else
#define __Pyx_INCREF(r) Py_INCREF(r)
#define __Pyx_DECREF(r) Py_DECREF(r)
#define __Pyx_GOTREF(r)
#define __Pyx_GIVEREF(r)
#define __Pyx_XDECREF(r) Py_XDECREF(r)
#define __Pyx_SetupRefcountContext(name)
#define __Pyx_FinishRefcountContext()
#endif /* CYTHON_REFNANNY */
#define __Pyx_XGIVEREF(r) if((r) == NULL) ; else __Pyx_GIVEREF(r)
#define __Pyx_XGOTREF(r) if((r) == NULL) ; else __Pyx_GOTREF(r)

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict,
    const char* function_name, int kw_allowed); /*proto*/


static INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}


#define __Pyx_GetItemInt_List(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_List_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
            PyObject *r = PyList_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyList_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyList_GET_ITEM(o, PyList_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
}

#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Tuple_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyTuple_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyTuple_GET_ITEM(o, PyTuple_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
}


#define __Pyx_GetItemInt(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    PyObject *r;
    if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (PyTuple_CheckExact(o) && ((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_item && (likely(i >= 0))) {
        r = PySequence_GetItem(o, i);
    }
    else {
        r = __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
    }
    return r;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name, PyObject* kw_name); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,     const char* function_name); /*proto*/

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact); /*proto*/

static INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb); /*proto*/
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static INLINE PyObject* __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (PyList_Append(L, x) < 0) return NULL;
        Py_INCREF(Py_None);
        return Py_None; /* this is just to have an accurate signature */
    }
    else {
        PyObject *r, *m;
        m = __Pyx_GetAttrString(L, "append");
        if (!m) return NULL;
        r = PyObject_CallFunctionObjArgs(m, x, NULL);
        Py_DECREF(m);
        return r;
    }
}

static int __Pyx_Print(PyObject *, int); /*proto*/
#if PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

static int __Pyx_PrintOne(PyObject *o); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static INLINE void __Pyx_RaiseTooManyValuesError(void);

static PyObject *__Pyx_UnpackItem(PyObject *, Py_ssize_t index); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

#if __PYX_USE_C99_COMPLEX
    #define __Pyx_REAL_PART(z) __real__(z)
    #define __Pyx_IMAG_PART(z) __imag__(z)
#else
    #define __Pyx_REAL_PART(z) ((z).real)
    #define __Pyx_IMAG_PART(z) ((z).imag)
#endif

#define __pyx_PyObject_from_complex(z) PyComplex_FromDoubles((double)__Pyx_REAL_PART(z), (double)__Pyx_IMAG_PART(z))

#if __PYX_USE_C99_COMPLEX

    typedef double _Complex __pyx_t_double_complex;
    static INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      return x + y*(__pyx_t_double_complex)_Complex_I;
    }
    
    #define __pyx_t_double_complex_is_zero(a) ((a) == 0)
    #define __pyx_t_double_complex_eq(a, b) ((a) == (b))
    #define __pyx_t_double_complex_add(a, b) ((a)+(b))
    #define __pyx_t_double_complex_sub(a, b) ((a)-(b))
    #define __pyx_t_double_complex_mul(a, b) ((a)*(b))
    #define __pyx_t_double_complex_div(a, b) ((a)/(b))
    #define __pyx_t_double_complex_neg(a) (-(a))

#else

    typedef struct { double real, imag; } __pyx_t_double_complex;
    static INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      __pyx_t_double_complex c; c.real = x; c.imag = y; return c;
    }
    
    static INLINE int __pyx_t_double_complex_is_zero(__pyx_t_double_complex a) {
       return (a.real == 0) & (a.imag == 0);
    }

    static INLINE int __pyx_t_double_complex_eq(__pyx_t_double_complex a, __pyx_t_double_complex b) {
       return (a.real == b.real) & (a.imag == b.imag);
    }

    static INLINE __pyx_t_double_complex __pyx_t_double_complex_add(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }

    static INLINE __pyx_t_double_complex __pyx_t_double_complex_sub(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }

    static INLINE __pyx_t_double_complex __pyx_t_double_complex_mul(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }

    static INLINE __pyx_t_double_complex __pyx_t_double_complex_div(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        double denom = b.real*b.real + b.imag*b.imag;
        z.real = (a.real * b.real + a.imag * b.imag) / denom;
        z.imag = (a.imag * b.real - a.real * b.imag) / denom;
        return z;
    }

    static INLINE __pyx_t_double_complex __pyx_t_double_complex_neg(__pyx_t_double_complex a) {
        __pyx_t_double_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }

#endif

static INLINE int __Pyx_StrEq(const char *, const char *); /*proto*/

static INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject *);

static INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject *);

static INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject *);

static INLINE char __Pyx_PyInt_AsChar(PyObject *);

static INLINE short __Pyx_PyInt_AsShort(PyObject *);

static INLINE int __Pyx_PyInt_AsInt(PyObject *);

static INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject *);

static INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject *);

static INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject *);

static INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject *);

static INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject *);

static INLINE long __Pyx_PyInt_AsLong(PyObject *);

static INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject *);

static INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject *);

static INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject *);

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig); /*proto*/

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, long size);  /*proto*/

static PyObject *__Pyx_ImportModule(const char *name); /*proto*/

static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig); /*proto*/

static void __Pyx_AddTraceback(const char *funcname); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

/* Type declarations */

typedef __pyx_t_double_complex __pyx_t_14_hermes_common_cplx;

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":473
 *     pass
 * 
 * cdef class WeakForm:             # <<<<<<<<<<<<<<
 *     cdef c_WeakForm *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm {
  PyObject_HEAD
  struct WeakForm *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1524
 *         return vec.reshape((ndashes, 2))
 * 
 * cdef class View:             # <<<<<<<<<<<<<<
 *     def wait(self):
 *         View_wait()
 */

struct __pyx_obj_8hermes2d_9_hermes2d_View {
  PyObject_HEAD
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1528
 *         View_wait()
 * 
 * cdef class ScalarView(View):             # <<<<<<<<<<<<<<
 *     cdef c_ScalarView *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView {
  struct __pyx_obj_8hermes2d_9_hermes2d_View __pyx_base;
  struct ScalarView *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1561
 *         self.thisptr.wait()
 * 
 * cdef class BaseView(View):             # <<<<<<<<<<<<<<
 *     cdef c_BaseView *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_BaseView {
  struct __pyx_obj_8hermes2d_9_hermes2d_View __pyx_base;
  struct BaseView *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":482
 *     cdef c_L2Space *thisptr
 * 
 * cdef class Transformable:             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Transformable {
  PyObject_HEAD
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":485
 *     pass
 * 
 * cdef class Function(Transformable):             # <<<<<<<<<<<<<<
 *     cdef c_Function *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Function {
  struct __pyx_obj_8hermes2d_9_hermes2d_Transformable __pyx_base;
  struct MeshFunction *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":488
 *     cdef c_Function *thisptr
 * 
 * cdef class ScalarFunction(Function):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_ScalarFunction {
  struct __pyx_obj_8hermes2d_9_hermes2d_Function __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":491
 *     pass
 * 
 * cdef class MeshFunction(ScalarFunction):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction {
  struct __pyx_obj_8hermes2d_9_hermes2d_ScalarFunction __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":818
 *     #    return vec
 * 
 * cdef class Filter(MeshFunction):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Filter {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":821
 *     pass
 * 
 * cdef class SimpleFilter(Filter):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_Filter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":858
 *     #    delete(self.thisptr)
 * 
 * cdef class SquareFilter(SimpleFilter):             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, MeshFunction sln, int item=H2D_FN_VAL):
 */

struct __pyx_obj_8hermes2d_9_hermes2d_SquareFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":467
 *     pass
 * 
 * cdef class Solver:             # <<<<<<<<<<<<<<
 *     cdef c_Solver *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Solver {
  PyObject_HEAD
  struct Solver *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":470
 *     cdef c_Solver *thisptr
 * 
 * cdef class DummySolver(Solver):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_DummySolver {
  struct __pyx_obj_8hermes2d_9_hermes2d_Solver __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1600
 *         self.thisptr.show(s.thisptr)
 * 
 * cdef class VectorView(View):             # <<<<<<<<<<<<<<
 *     cdef c_VectorView *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_VectorView {
  struct __pyx_obj_8hermes2d_9_hermes2d_View __pyx_base;
  struct VectorView *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":586
 *         delete(self.thisptr)
 * 
 * cdef class L2Shapeset:             # <<<<<<<<<<<<<<
 *     """ L2 Shapeset.
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset {
  PyObject_HEAD
  L2Shapeset *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":521
 *     pass
 * 
 * cdef class Mesh:             # <<<<<<<<<<<<<<
 *     cdef c_Mesh *thisptr
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Mesh {
  PyObject_HEAD
  struct Mesh *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1154
 * #        self.thisptr.free_matrix()
 * 
 * cdef class CandList:             # <<<<<<<<<<<<<<
 *     """ A prefined list of andidates.
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_CandList {
  PyObject_HEAD
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":110
 *         return self.thisptr.x, self.thisptr.y
 * 
 * cdef class Element:             # <<<<<<<<<<<<<<
 *     cdef c_Element *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Element {
  PyObject_HEAD
  struct Element *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":599
 *         delete(self.thisptr)
 * 
 * cdef class PrecalcShapeset:             # <<<<<<<<<<<<<<
 *     cdef c_PrecalcShapeset *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset {
  PyObject_HEAD
  struct PrecalcShapeset *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":840
 *     #    delete(self.thisptr)
 * 
 * cdef class DiffFilter(SimpleFilter):             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 */

struct __pyx_obj_8hermes2d_9_hermes2d_DiffFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":494
 *     pass
 * 
 * cdef class Solution(MeshFunction):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Solution {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":21
 * H2D_ELEMENT_ERROR_ABS = c_H2D_ELEMENT_ERROR_ABS
 * 
 * cdef class Nurbs:             # <<<<<<<<<<<<<<
 *     cdef c_Nurbs *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs {
  PyObject_HEAD
  struct Nurbs *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":577
 *         self.thisptr.convert_quads_to_triangles()
 * 
 * cdef class H1Shapeset:             # <<<<<<<<<<<<<<
 *     cdef c_H1Shapeset *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset {
  PyObject_HEAD
  H1Shapeset *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":503
 *     pass
 * 
 * cdef class ProjBasedSelector:             # <<<<<<<<<<<<<<
 *     cdef c_ProjBasedSelector *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector {
  PyObject_HEAD
  RefinementSelectors::ProjBasedSelector *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":509
 *     pass
 * 
 * cdef class L2ProjBasedSelector(ProjBasedSelector):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_L2ProjBasedSelector {
  struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1177
 *     HP_ANISO = c_H2D_HP_ANISO
 * 
 * cdef class SelOption:             # <<<<<<<<<<<<<<
 *     """ Options of the selector.
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_SelOption {
  PyObject_HEAD
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":459
 * 
 * 
 * cdef class LinSystem:             # <<<<<<<<<<<<<<
 *     cdef c_LinSystem *thisptr
 *     cdef object _spaces
 */

struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem {
  PyObject_HEAD
  struct LinSystem *thisptr;
  PyObject *_spaces;
  PyObject *_pss;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":849
 *     #    delete(self.thisptr)
 * 
 * cdef class SumFilter(SimpleFilter):             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 */

struct __pyx_obj_8hermes2d_9_hermes2d_SumFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":479
 *     cdef c_H1Space *thisptr
 * 
 * cdef class L2Space:             # <<<<<<<<<<<<<<
 *     cdef c_L2Space *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_L2Space {
  PyObject_HEAD
  struct L2Space *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":497
 *     pass
 * 
 * cdef class Linearizer:             # <<<<<<<<<<<<<<
 *     cdef c_Linearizer *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer {
  PyObject_HEAD
  struct Linearizer *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":500
 *     cdef c_Linearizer *thisptr
 * 
 * cdef class Vectorizer(Linearizer):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer {
  struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":512
 *     pass
 * 
 * cdef class Adapt:             # <<<<<<<<<<<<<<
 *     cdef c_Adapt *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Adapt {
  PyObject_HEAD
  Adapt *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":515
 *     cdef c_Adapt *thisptr
 * 
 * cdef class H1Adapt(Adapt):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_H1Adapt {
  struct __pyx_obj_8hermes2d_9_hermes2d_Adapt __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":832
 *     #    delete(self.thisptr)
 * 
 * cdef class MagFilter(SimpleFilter):             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, int item1, int item2):
 */

struct __pyx_obj_8hermes2d_9_hermes2d_MagFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":518
 *     pass
 * 
 * cdef class L2Adapt(Adapt):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_L2Adapt {
  struct __pyx_obj_8hermes2d_9_hermes2d_Adapt __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":476
 *     cdef c_WeakForm *thisptr
 * 
 * cdef class H1Space:             # <<<<<<<<<<<<<<
 *     cdef c_H1Space *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_H1Space {
  PyObject_HEAD
  struct H1Space *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":464
 *     cdef object _pss
 * 
 * cdef class RefSystem(LinSystem):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_RefSystem {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":824
 *     pass
 * 
 * cdef class VonMisesFilter(Filter):             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, double l, double m):
 */

struct __pyx_obj_8hermes2d_9_hermes2d_VonMisesFilter {
  struct __pyx_obj_8hermes2d_9_hermes2d_Filter __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1587
 *         self.thisptr.show(s.thisptr)
 * 
 * cdef class OrderView(View):             # <<<<<<<<<<<<<<
 *     cdef c_OrderView *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_OrderView {
  struct __pyx_obj_8hermes2d_9_hermes2d_View __pyx_base;
  struct OrderView *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pxd":506
 *     cdef c_ProjBasedSelector *thisptr
 * 
 * cdef class H1ProjBasedSelector(ProjBasedSelector):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_H1ProjBasedSelector {
  struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector __pyx_base;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1574
 *         self.thisptr.show(s.thisptr)
 * 
 * cdef class MeshView(View):             # <<<<<<<<<<<<<<
 *     cdef c_MeshView *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_MeshView {
  struct __pyx_obj_8hermes2d_9_hermes2d_View __pyx_base;
  struct MeshView *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":76
 *         return n
 * 
 * cdef class Node:             # <<<<<<<<<<<<<<
 *     cdef c_Node *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_Node {
  PyObject_HEAD
  struct Node *thisptr;
};

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":55
 *         return self.thisptr.nk
 * 
 * cdef class CurvMap:             # <<<<<<<<<<<<<<
 *     cdef c_CurvMap *thisptr
 * 
 */

struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap {
  PyObject_HEAD
  struct CurvMap *thisptr;
};
/* Module declarations from numpy */

/* Module declarations from ref */

/* Module declarations from numpy */

/* Module declarations from _hermes_common */

static PyTypeObject *__pyx_ptype_14_hermes_common_ndarray = 0;
extern PyObject *(*c2numpy_int)(int *, int); /*proto*/
extern PyObject *(*c2numpy_double)(double *, int); /*proto*/
static PyObject *(*__pyx_f_14_hermes_common_PY_NEW)(PyObject *); /*proto*/
/* Module declarations from hermes2d._hermes2d */

static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_ndarray = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_LinSystem = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_RefSystem = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Solver = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_DummySolver = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_WeakForm = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_H1Space = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_L2Space = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Transformable = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Function = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_ScalarFunction = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_MeshFunction = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Solution = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Linearizer = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Vectorizer = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_ProjBasedSelector = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_H1ProjBasedSelector = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_L2ProjBasedSelector = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Adapt = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_H1Adapt = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_L2Adapt = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Mesh = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Nurbs = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_CurvMap = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Node = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Element = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_H1Shapeset = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_L2Shapeset = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_Filter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_VonMisesFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_MagFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_DiffFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_SumFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_SquareFilter = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_CandList = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_SelOption = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_View = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_ScalarView = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_BaseView = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_MeshView = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_OrderView = 0;
static PyTypeObject *__pyx_ptype_8hermes2d_9_hermes2d_VectorView = 0;
static int __pyx_k_29;
static int __pyx_k_30;
static int __pyx_k_31;
static int __pyx_k_32;
static int __pyx_k_33;
static int __pyx_k_35;
static int __pyx_k_36;
static int __pyx_k_37;
static double __pyx_k_38;
static PyObject *__pyx_k_39 = 0;
static PyObject *__pyx_k_40 = 0;
static PyObject *__pyx_k_44 = 0;
static PyObject *__pyx_k_45 = 0;
static PyObject *H1Space_from_C(struct H1Space *); /*proto*/
static PyObject *Mesh_from_C(struct Mesh *); /*proto*/
static PyObject *LinSystem_from_C(struct LinSystem *); /*proto*/
static PyObject *Solution_from_C(struct Solution *); /*proto*/
#define __Pyx_MODULE_NAME "hermes2d._hermes2d"
int __pyx_module_is_main_hermes2d___hermes2d = 0;

/* Implementation of hermes2d._hermes2d */
static char __pyx_k_41[] = "BaseView";
static char __pyx_k_42[] = "MeshView";
static char __pyx_k_43[] = "OrderView";
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_5;
static PyObject *__pyx_int_2;
static char __pyx_k___main__[] = "__main__";
static PyObject *__pyx_kp___main__;
static char __pyx_k_degree[] = "degree";
static PyObject *__pyx_kp_degree;
static char __pyx_k_np[] = "np";
static PyObject *__pyx_kp_np;
static char __pyx_k_pt[] = "pt";
static PyObject *__pyx_kp_pt;
static char __pyx_k_nk[] = "nk";
static PyObject *__pyx_kp_nk;
static char __pyx_k_kv[] = "kv";
static PyObject *__pyx_kp_kv;
static char __pyx_k_ref[] = "ref";
static PyObject *__pyx_kp_ref;
static char __pyx_k_order[] = "order";
static PyObject *__pyx_kp_order;
static char __pyx_k_toplevel[] = "toplevel";
static PyObject *__pyx_kp_toplevel;
static char __pyx_k_get_nurbs[] = "get_nurbs";
static PyObject *__pyx_kp_get_nurbs;
static char __pyx_k_id[] = "id";
static PyObject *__pyx_kp_id;
static char __pyx_k_type[] = "type";
static PyObject *__pyx_kp_type;
static char __pyx_k_bnd[] = "bnd";
static PyObject *__pyx_kp_bnd;
static char __pyx_k_marker[] = "marker";
static PyObject *__pyx_kp_marker;
static char __pyx_k_used[] = "used";
static PyObject *__pyx_kp_used;
static char __pyx_k___str__[] = "__str__";
static PyObject *__pyx_kp___str__;
static char __pyx_k_coord[] = "coord";
static PyObject *__pyx_kp_coord;
static char __pyx_k_nvert[] = "nvert";
static PyObject *__pyx_kp_nvert;
static char __pyx_k_active[] = "active";
static PyObject *__pyx_kp_active;
static char __pyx_k_nodes_vertex[] = "nodes_vertex";
static PyObject *__pyx_kp_nodes_vertex;
static char __pyx_k_nodes_vertex_id[] = "nodes_vertex_id";
static PyObject *__pyx_kp_nodes_vertex_id;
static char __pyx_k_nodes_edge[] = "nodes_edge";
static PyObject *__pyx_kp_nodes_edge;
static char __pyx_k_get_vertex_node[] = "get_vertex_node";
static PyObject *__pyx_kp_get_vertex_node;
static char __pyx_k_curved_map[] = "curved_map";
static PyObject *__pyx_kp_curved_map;
static char __pyx_k_get_edge_node[] = "get_edge_node";
static PyObject *__pyx_kp_get_edge_node;
static char __pyx_k_get_son_element[] = "get_son_element";
static PyObject *__pyx_kp_get_son_element;
static char __pyx_k_get_diameter[] = "get_diameter";
static PyObject *__pyx_kp_get_diameter;
static char __pyx_k_get_area[] = "get_area";
static PyObject *__pyx_kp_get_area;
static char __pyx_k___cinit__[] = "__cinit__";
static PyObject *__pyx_kp___cinit__;
static char __pyx_k___dealloc__[] = "__dealloc__";
static PyObject *__pyx_kp___dealloc__;
static char __pyx_k_copy[] = "copy";
static PyObject *__pyx_kp_copy;
static char __pyx_k_load[] = "load";
static PyObject *__pyx_kp_load;
static char __pyx_k_load_str[] = "load_str";
static PyObject *__pyx_kp_load_str;
static char __pyx_k_elements_markers[] = "elements_markers";
static PyObject *__pyx_kp_elements_markers;
static char __pyx_k_elements[] = "elements";
static PyObject *__pyx_kp_elements;
static char __pyx_k_active_elements[] = "active_elements";
static PyObject *__pyx_kp_active_elements;
static char __pyx_k_nodes[] = "nodes";
static PyObject *__pyx_kp_nodes;
static char __pyx_k_nodes_dict[] = "nodes_dict";
static PyObject *__pyx_kp_nodes_dict;
static char __pyx_k_curves[] = "curves";
static PyObject *__pyx_kp_curves;
static char __pyx_k_1[] = "get_polygonal_boundary";
static PyObject *__pyx_kp_1;
static char __pyx_k_num_elements[] = "num_elements";
static PyObject *__pyx_kp_num_elements;
static char __pyx_k_num_base_elements[] = "num_base_elements";
static PyObject *__pyx_kp_num_base_elements;
static char __pyx_k_num_active_elements[] = "num_active_elements";
static PyObject *__pyx_kp_num_active_elements;
static char __pyx_k_max_element_id[] = "max_element_id";
static PyObject *__pyx_kp_max_element_id;
static char __pyx_k_load_hermes[] = "load_hermes";
static PyObject *__pyx_kp_load_hermes;
static char __pyx_k_get_elements_order[] = "get_elements_order";
static PyObject *__pyx_kp_get_elements_order;
static char __pyx_k_create[] = "create";
static PyObject *__pyx_kp_create;
static char __pyx_k_save[] = "save";
static PyObject *__pyx_kp_save;
static char __pyx_k_refine_element[] = "refine_element";
static PyObject *__pyx_kp_refine_element;
static char __pyx_k_refine_all_elements[] = "refine_all_elements";
static PyObject *__pyx_kp_refine_all_elements;
static char __pyx_k_2[] = "refine_towards_boundary";
static PyObject *__pyx_kp_2;
static char __pyx_k_3[] = "refine_towards_vertex";
static PyObject *__pyx_kp_3;
static char __pyx_k_get_element[] = "get_element";
static PyObject *__pyx_kp_get_element;
static char __pyx_k_plot[] = "plot";
static PyObject *__pyx_kp_plot;
static char __pyx_k_show[] = "show";
static PyObject *__pyx_kp_show;
static char __pyx_k_4[] = "convert_triangles_to_quads";
static PyObject *__pyx_kp_4;
static char __pyx_k_5[] = "convert_quads_to_triangles";
static PyObject *__pyx_kp_5;
static char __pyx_k___init__[] = "__init__";
static PyObject *__pyx_kp___init__;
static char __pyx_k_set_uniform_order[] = "set_uniform_order";
static PyObject *__pyx_kp_set_uniform_order;
static char __pyx_k_assign_dofs[] = "assign_dofs";
static PyObject *__pyx_kp_assign_dofs;
static char __pyx_k_copy_orders[] = "copy_orders";
static PyObject *__pyx_kp_copy_orders;
static char __pyx_k_get_element_order[] = "get_element_order";
static PyObject *__pyx_kp_get_element_order;
static char __pyx_k_get_num_dofs[] = "get_num_dofs";
static PyObject *__pyx_kp_get_num_dofs;
static char __pyx_k___add__[] = "__add__";
static PyObject *__pyx_kp___add__;
static char __pyx_k___sub__[] = "__sub__";
static PyObject *__pyx_kp___sub__;
static char __pyx_k___pow__[] = "__pow__";
static PyObject *__pyx_kp___pow__;
static char __pyx_k___neg__[] = "__neg__";
static PyObject *__pyx_kp___neg__;
static char __pyx_k_6[] = "l2_norm";
static PyObject *__pyx_kp_6;
static char __pyx_k_7[] = "h1_norm";
static PyObject *__pyx_kp_7;
static char __pyx_k_get_pt_value[] = "get_pt_value";
static PyObject *__pyx_kp_get_pt_value;
static char __pyx_k_get_mesh[] = "get_mesh";
static PyObject *__pyx_kp_get_mesh;
static char __pyx_k_copy_by_reference[] = "copy_by_reference";
static PyObject *__pyx_kp_copy_by_reference;
static char __pyx_k_set_zero[] = "set_zero";
static PyObject *__pyx_kp_set_zero;
static char __pyx_k_set_const[] = "set_const";
static PyObject *__pyx_kp_set_const;
static char __pyx_k_set_fe_solution[] = "set_fe_solution";
static PyObject *__pyx_kp_set_fe_solution;
static char __pyx_k_set_spaces[] = "set_spaces";
static PyObject *__pyx_kp_set_spaces;
static char __pyx_k_set_pss[] = "set_pss";
static PyObject *__pyx_kp_set_pss;
static char __pyx_k_solve_system[] = "solve_system";
static PyObject *__pyx_kp_solve_system;
static char __pyx_k_assemble[] = "assemble";
static PyObject *__pyx_kp_assemble;
static char __pyx_k_get_matrix_csc[] = "get_matrix_csc";
static PyObject *__pyx_kp_get_matrix_csc;
static char __pyx_k_get_matrix[] = "get_matrix";
static PyObject *__pyx_kp_get_matrix;
static char __pyx_k_get_rhs[] = "get_rhs";
static PyObject *__pyx_kp_get_rhs;
static char __pyx_k_P_ISO[] = "P_ISO";
static PyObject *__pyx_kp_P_ISO;
static char __pyx_k_P_ANISO[] = "P_ANISO";
static PyObject *__pyx_kp_P_ANISO;
static char __pyx_k_H_ISO[] = "H_ISO";
static PyObject *__pyx_kp_H_ISO;
static char __pyx_k_H_ANISO[] = "H_ANISO";
static PyObject *__pyx_kp_H_ANISO;
static char __pyx_k_HP_ISO[] = "HP_ISO";
static PyObject *__pyx_kp_HP_ISO;
static char __pyx_k_HP_ANISO_H[] = "HP_ANISO_H";
static PyObject *__pyx_kp_HP_ANISO_H;
static char __pyx_k_HP_ANISO_P[] = "HP_ANISO_P";
static PyObject *__pyx_kp_HP_ANISO_P;
static char __pyx_k_HP_ANISO[] = "HP_ANISO";
static PyObject *__pyx_kp_HP_ANISO;
static char __pyx_k_8[] = "PREFER_SYMMETRIC_MESH";
static PyObject *__pyx_kp_8;
static char __pyx_k_APPLY_CONV_EXP_DOF[] = "APPLY_CONV_EXP_DOF";
static PyObject *__pyx_kp_APPLY_CONV_EXP_DOF;
static char __pyx_k_set_error_weights[] = "set_error_weights";
static PyObject *__pyx_kp_set_error_weights;
static char __pyx_k_set_option[] = "set_option";
static PyObject *__pyx_kp_set_option;
static char __pyx_k_set_solutions[] = "set_solutions";
static PyObject *__pyx_kp_set_solutions;
static char __pyx_k_calc_error[] = "calc_error";
static PyObject *__pyx_kp_calc_error;
static char __pyx_k_adapt[] = "adapt";
static PyObject *__pyx_kp_adapt;
static char __pyx_k_process_solution[] = "process_solution";
static PyObject *__pyx_kp_process_solution;
static char __pyx_k_get_vertices[] = "get_vertices";
static PyObject *__pyx_kp_get_vertices;
static char __pyx_k_get_num_vertices[] = "get_num_vertices";
static PyObject *__pyx_kp_get_num_vertices;
static char __pyx_k_get_triangles[] = "get_triangles";
static PyObject *__pyx_kp_get_triangles;
static char __pyx_k_get_num_triangles[] = "get_num_triangles";
static PyObject *__pyx_kp_get_num_triangles;
static char __pyx_k_get_edges[] = "get_edges";
static PyObject *__pyx_kp_get_edges;
static char __pyx_k_get_num_edges[] = "get_num_edges";
static PyObject *__pyx_kp_get_num_edges;
static char __pyx_k_get_min_value[] = "get_min_value";
static PyObject *__pyx_kp_get_min_value;
static char __pyx_k_get_max_value[] = "get_max_value";
static PyObject *__pyx_kp_get_max_value;
static char __pyx_k_save_data[] = "save_data";
static PyObject *__pyx_kp_save_data;
static char __pyx_k_load_data[] = "load_data";
static PyObject *__pyx_kp_load_data;
static char __pyx_k_get_dashes[] = "get_dashes";
static PyObject *__pyx_kp_get_dashes;
static char __pyx_k_wait[] = "wait";
static PyObject *__pyx_kp_wait;
static char __pyx_k_show_mesh[] = "show_mesh";
static PyObject *__pyx_kp_show_mesh;
static char __pyx_k_show_scale[] = "show_scale";
static PyObject *__pyx_kp_show_scale;
static char __pyx_k_set_min_max_range[] = "set_min_max_range";
static PyObject *__pyx_kp_set_min_max_range;
static char __pyx_k_set_title[] = "set_title";
static PyObject *__pyx_kp_set_title;
static char __pyx_k_k[] = "k";
static PyObject *__pyx_kp_k;
static char __pyx_k_node[] = "node";
static PyObject *__pyx_kp_node;
static char __pyx_k_m[] = "m";
static PyObject *__pyx_kp_m;
static char __pyx_k_filename[] = "filename";
static PyObject *__pyx_kp_filename;
static char __pyx_k_mesh[] = "mesh";
static PyObject *__pyx_kp_mesh;
static char __pyx_k_space[] = "space";
static PyObject *__pyx_kp_space;
static char __pyx_k_boundary[] = "boundary";
static PyObject *__pyx_kp_boundary;
static char __pyx_k_nurbs[] = "nurbs";
static PyObject *__pyx_kp_nurbs;
static char __pyx_k_refinement[] = "refinement";
static PyObject *__pyx_kp_refinement;
static char __pyx_k_depth[] = "depth";
static PyObject *__pyx_kp_depth;
static char __pyx_k_h[] = "h";
static PyObject *__pyx_kp_h;
static char __pyx_k_tri_order[] = "tri_order";
static PyObject *__pyx_kp_tri_order;
static char __pyx_k_first_dof[] = "first_dof";
static PyObject *__pyx_kp_first_dof;
static char __pyx_k_stride[] = "stride";
static PyObject *__pyx_kp_stride;
static char __pyx_k_s[] = "s";
static PyObject *__pyx_kp_s;
static char __pyx_k_inc[] = "inc";
static PyObject *__pyx_kp_inc;
static char __pyx_k_el_id[] = "el_id";
static PyObject *__pyx_kp_el_id;
static char __pyx_k_x[] = "x";
static PyObject *__pyx_kp_x;
static char __pyx_k_y[] = "y";
static PyObject *__pyx_kp_y;
static char __pyx_k_z[] = "z";
static PyObject *__pyx_kp_z;
static char __pyx_k_scalar[] = "scalar";
static PyObject *__pyx_kp_scalar;
static char __pyx_k_pss[] = "pss";
static PyObject *__pyx_kp_pss;
static char __pyx_k_v[] = "v";
static PyObject *__pyx_kp_v;
static char __pyx_k_9[] = "sln1";
static PyObject *__pyx_kp_9;
static char __pyx_k_10[] = "sln2";
static PyObject *__pyx_kp_10;
static char __pyx_k_l[] = "l";
static PyObject *__pyx_kp_l;
static char __pyx_k_11[] = "item1";
static PyObject *__pyx_kp_11;
static char __pyx_k_12[] = "item2";
static PyObject *__pyx_kp_12;
static char __pyx_k_sln[] = "sln";
static PyObject *__pyx_kp_sln;
static char __pyx_k_item[] = "item";
static PyObject *__pyx_kp_item;
static char __pyx_k_neq[] = "neq";
static PyObject *__pyx_kp_neq;
static char __pyx_k_wf[] = "wf";
static PyObject *__pyx_kp_wf;
static char __pyx_k_solver[] = "solver";
static PyObject *__pyx_kp_solver;
static char __pyx_k_lib[] = "lib";
static PyObject *__pyx_kp_lib;
static char __pyx_k_ls[] = "ls";
static PyObject *__pyx_kp_ls;
static char __pyx_k_weight_h[] = "weight_h";
static PyObject *__pyx_kp_weight_h;
static char __pyx_k_weight_p[] = "weight_p";
static PyObject *__pyx_kp_weight_p;
static char __pyx_k_weight_aniso[] = "weight_aniso";
static PyObject *__pyx_kp_weight_aniso;
static char __pyx_k_option[] = "option";
static PyObject *__pyx_kp_option;
static char __pyx_k_enable[] = "enable";
static PyObject *__pyx_kp_enable;
static char __pyx_k_cand_list[] = "cand_list";
static PyObject *__pyx_kp_cand_list;
static char __pyx_k_conv_exp[] = "conv_exp";
static PyObject *__pyx_kp_conv_exp;
static char __pyx_k_max_order[] = "max_order";
static PyObject *__pyx_kp_max_order;
static char __pyx_k_shapeset[] = "shapeset";
static PyObject *__pyx_kp_shapeset;
static char __pyx_k_sln_list[] = "sln_list";
static PyObject *__pyx_kp_sln_list;
static char __pyx_k_rsln_list[] = "rsln_list";
static PyObject *__pyx_kp_rsln_list;
static char __pyx_k_error_flags[] = "error_flags";
static PyObject *__pyx_kp_error_flags;
static char __pyx_k_selector[] = "selector";
static PyObject *__pyx_kp_selector;
static char __pyx_k_thr[] = "thr";
static PyObject *__pyx_kp_thr;
static char __pyx_k_strat[] = "strat";
static PyObject *__pyx_kp_strat;
static char __pyx_k_regularize[] = "regularize";
static PyObject *__pyx_kp_regularize;
static char __pyx_k_same_orders[] = "same_orders";
static PyObject *__pyx_kp_same_orders;
static char __pyx_k_to_be_processed[] = "to_be_processed";
static PyObject *__pyx_kp_to_be_processed;
static char __pyx_k_space_list[] = "space_list";
static PyObject *__pyx_kp_space_list;
static char __pyx_k_xsln[] = "xsln";
static PyObject *__pyx_kp_xsln;
static char __pyx_k_ysln[] = "ysln";
static PyObject *__pyx_kp_ysln;
static char __pyx_k_xitem[] = "xitem";
static PyObject *__pyx_kp_xitem;
static char __pyx_k_yitem[] = "yitem";
static PyObject *__pyx_kp_yitem;
static char __pyx_k_eps[] = "eps";
static PyObject *__pyx_kp_eps;
static char __pyx_k_title[] = "title";
static PyObject *__pyx_kp_title;
static char __pyx_k_width[] = "width";
static PyObject *__pyx_kp_width;
static char __pyx_k_height[] = "height";
static PyObject *__pyx_kp_height;
static char __pyx_k_min[] = "min";
static PyObject *__pyx_kp_min;
static char __pyx_k_max[] = "max";
static PyObject *__pyx_kp_max;
static char __pyx_k_13[] = "s1";
static PyObject *__pyx_kp_13;
static char __pyx_k_14[] = "s2";
static PyObject *__pyx_kp_14;
static char __pyx_k_verbose[] = "verbose";
static PyObject *__pyx_kp_verbose;
static char __pyx_k_warn_integration[] = "warn_integration";
static PyObject *__pyx_kp_warn_integration;
static char __pyx_k_15[] = "H2D_FN_DX";
static PyObject *__pyx_kp_15;
static char __pyx_k_16[] = "H2D_FN_DY";
static PyObject *__pyx_kp_16;
static char __pyx_k_17[] = "H2D_FN_VAL";
static PyObject *__pyx_kp_17;
static char __pyx_k_18[] = "H2D_FN_DXX";
static PyObject *__pyx_kp_18;
static char __pyx_k_19[] = "H2D_FN_DYY";
static PyObject *__pyx_kp_19;
static char __pyx_k_20[] = "H2D_FN_DXY";
static PyObject *__pyx_kp_20;
static char __pyx_k_21[] = "H2D_FN_DEFAULT";
static PyObject *__pyx_kp_21;
static char __pyx_k_22[] = "H2D_FN_ALL";
static PyObject *__pyx_kp_22;
static char __pyx_k_23[] = "H2D_EPS_NORMAL";
static PyObject *__pyx_kp_23;
static char __pyx_k_24[] = "H2D_EPS_HIGH";
static PyObject *__pyx_kp_24;
static char __pyx_k_25[] = "H2D_TOTAL_ERROR_REL";
static PyObject *__pyx_kp_25;
static char __pyx_k_26[] = "H2D_TOTAL_ERROR_ABS";
static PyObject *__pyx_kp_26;
static char __pyx_k_27[] = "H2D_ELEMENT_ERROR_REL";
static PyObject *__pyx_kp_27;
static char __pyx_k_28[] = "H2D_ELEMENT_ERROR_ABS";
static PyObject *__pyx_kp_28;
static char __pyx_k_property[] = "property";
static PyObject *__pyx_kp_property;
static char __pyx_k_34[] = "scipy";
static PyObject *__pyx_kp_34;
static char __pyx_k_46[] = "init_hermes2d_wrappers";
static PyObject *__pyx_kp_46;
static char __pyx_k_reshape[] = "reshape";
static PyObject *__pyx_kp_reshape;
static char __pyx_k_range[] = "range";
static PyObject *__pyx_kp_range;
static char __pyx_k_append[] = "append";
static PyObject *__pyx_kp_append;
static char __pyx_k_extend[] = "extend";
static PyObject *__pyx_kp_extend;
static char __pyx_k_values[] = "values";
static PyObject *__pyx_kp_values;
static char __pyx_k_sort[] = "sort";
static PyObject *__pyx_kp_sort;
static char __pyx_k_key[] = "key";
static PyObject *__pyx_kp_key;
static char __pyx_k_get_node_id[] = "get_node_id";
static PyObject *__pyx_kp_get_node_id;
static char __pyx_k_read_hermes_format[] = "read_hermes_format";
static PyObject *__pyx_kp_read_hermes_format;
static char __pyx_k_math[] = "math";
static PyObject *__pyx_kp_math;
static char __pyx_k_61[] = "hermes2d";
static PyObject *__pyx_kp_61;
static char __pyx_k_MeshView[] = "MeshView";
static PyObject *__pyx_kp_MeshView;
static char __pyx_k_NotImplemented[] = "NotImplemented";
static PyObject *__pyx_kp_NotImplemented;
static char __pyx_k_numpy[] = "numpy";
static PyObject *__pyx_kp_numpy;
static char __pyx_k_array[] = "array";
static PyObject *__pyx_kp_array;
static char __pyx_k_dtype[] = "dtype";
static PyObject *__pyx_kp_dtype;
static char __pyx_k_62[] = "double";
static PyObject *__pyx_kp_62;
static char __pyx_k_ScalarView[] = "ScalarView";
static PyObject *__pyx_kp_ScalarView;
static char __pyx_k_NotImplementedError[] = "NotImplementedError";
static PyObject *__pyx_kp_NotImplementedError;
static char __pyx_k_63[] = "hermes";
static PyObject *__pyx_kp_63;
static char __pyx_k_64[] = "scipy";
static PyObject *__pyx_kp_64;
static char __pyx_k_warnings[] = "warnings";
static PyObject *__pyx_kp_warnings;
static char __pyx_k_65[] = "scipy.sparse.linalg";
static PyObject *__pyx_kp_65;
static char __pyx_k_cg[] = "cg";
static PyObject *__pyx_kp_cg;
static char __pyx_k_spsolve[] = "spsolve";
static PyObject *__pyx_kp_spsolve;
static char __pyx_k_catch_warnings[] = "catch_warnings";
static PyObject *__pyx_kp_catch_warnings;
static char __pyx_k___exit__[] = "__exit__";
static PyObject *__pyx_kp___exit__;
static char __pyx_k___enter__[] = "__enter__";
static PyObject *__pyx_kp___enter__;
static char __pyx_k_simplefilter[] = "simplefilter";
static PyObject *__pyx_kp_simplefilter;
static char __pyx_k_66[] = "ignore";
static PyObject *__pyx_kp_66;
static char __pyx_k_67[] = "double";
static PyObject *__pyx_kp_67;
static char __pyx_k_enumerate[] = "enumerate";
static PyObject *__pyx_kp_enumerate;
static char __pyx_k_69[] = "scipy.sparse";
static PyObject *__pyx_kp_69;
static char __pyx_k_csc_matrix[] = "csc_matrix";
static PyObject *__pyx_kp_csc_matrix;
static PyObject *__pyx_builtin_property;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_max;
static PyObject *__pyx_builtin_NotImplemented;
static PyObject *__pyx_builtin_NotImplementedError;
static PyObject *__pyx_builtin_enumerate;
static PyObject *__pyx_kp_47;
static char __pyx_k_47[] = "Node %d: coord=%r, used=%r";
static PyObject *__pyx_kp_48;
static char __pyx_k_48[] = "Element %d: nodes_id=%r, active=%r, marker=%d, used=%r";
static PyObject *__pyx_kp_49;
static char __pyx_k_49[] = "Mesh with %d elements: active=%d, base=%d, max_id=%d";
static PyObject *__pyx_kp_50;
static PyObject *__pyx_kp_51;
static PyObject *__pyx_kp_52;
static PyObject *__pyx_kp_53;
static PyObject *__pyx_kp_54;
static PyObject *__pyx_kp_55;
static PyObject *__pyx_kp_56;
static PyObject *__pyx_kp_57;
static PyObject *__pyx_kp_58;
static PyObject *__pyx_kp_59;
static PyObject *__pyx_kp_60;
static char __pyx_k_50[] = "1 0\n";
static char __pyx_k_51[] = "%d\n";
static char __pyx_k_52[] = "%f %f\n";
static char __pyx_k_53[] = "%d\n";
static char __pyx_k_54[] = "%d ";
static char __pyx_k_55[] = "\n";
static char __pyx_k_56[] = "%d\n";
static char __pyx_k_57[] = "%d %d %d\n";
static char __pyx_k_58[] = "%d\n";
static char __pyx_k_59[] = "%d %d\n0\n%f\n";
static char __pyx_k_60[] = "0\n";
static PyObject *__pyx_kp_68;
static char __pyx_k_68[] = "Unknown library";

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":25
 * 
 *     @property
 *     def degree(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.degree
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_degree(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_degree(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("degree");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":26
 *     @property
 *     def degree(self):
 *         return self.thisptr.degree             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->degree); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.degree");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":29
 * 
 *     @property
 *     def np(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.np
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_np(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_np(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("np");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":30
 *     @property
 *     def np(self):
 *         return self.thisptr.np             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.np");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":33
 * 
 *     @property
 *     def pt(self):             # <<<<<<<<<<<<<<
 *         cdef double3 *pt = self.thisptr.pt
 *         cdef int np = self.thisptr.np
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_pt(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_pt(PyObject *__pyx_v_self, PyObject *unused) {
  double3 *__pyx_v_pt;
  int __pyx_v_np;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("pt");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":34
 *     @property
 *     def pt(self):
 *         cdef double3 *pt = self.thisptr.pt             # <<<<<<<<<<<<<<
 *         cdef int np = self.thisptr.np
 *         cdef ndarray vec = c2numpy_double(<double *>pt, 3*np)
 */
  __pyx_v_pt = ((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->pt;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":35
 *     def pt(self):
 *         cdef double3 *pt = self.thisptr.pt
 *         cdef int np = self.thisptr.np             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_double(<double *>pt, 3*np)
 *         return vec.reshape((np, 3))
 */
  __pyx_v_np = ((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->np;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":36
 *         cdef double3 *pt = self.thisptr.pt
 *         cdef int np = self.thisptr.np
 *         cdef ndarray vec = c2numpy_double(<double *>pt, 3*np)             # <<<<<<<<<<<<<<
 *         return vec.reshape((np, 3))
 * 
 */
  __pyx_t_1 = c2numpy_double(((double *)__pyx_v_pt), (3 * __pyx_v_np)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":37
 *         cdef int np = self.thisptr.np
 *         cdef ndarray vec = c2numpy_double(<double *>pt, 3*np)
 *         return vec.reshape((np, 3))             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.pt");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":40
 * 
 *     @property
 *     def nk(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nk
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_nk(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_nk(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("nk");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":41
 *     @property
 *     def nk(self):
 *         return self.thisptr.nk             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->nk); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.nk");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":44
 * 
 *     @property
 *     def kv(self):             # <<<<<<<<<<<<<<
 *         cdef double *kv = self.thisptr.kv
 *         cdef int nk = self.thisptr.nk
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_kv(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_kv(PyObject *__pyx_v_self, PyObject *unused) {
  double *__pyx_v_kv;
  int __pyx_v_nk;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("kv");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":45
 *     @property
 *     def kv(self):
 *         cdef double *kv = self.thisptr.kv             # <<<<<<<<<<<<<<
 *         cdef int nk = self.thisptr.nk
 *         cdef ndarray vec = c2numpy_double(<double *>kv, nk)
 */
  __pyx_v_kv = ((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->kv;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":46
 *     def kv(self):
 *         cdef double *kv = self.thisptr.kv
 *         cdef int nk = self.thisptr.nk             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_double(<double *>kv, nk)
 *         return vec
 */
  __pyx_v_nk = ((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->nk;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":47
 *         cdef double *kv = self.thisptr.kv
 *         cdef int nk = self.thisptr.nk
 *         cdef ndarray vec = c2numpy_double(<double *>kv, nk)             # <<<<<<<<<<<<<<
 *         return vec
 *         #return vec.reshape((kv,))
 */
  __pyx_t_1 = c2numpy_double(((double *)__pyx_v_kv), __pyx_v_nk); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":48
 *         cdef int nk = self.thisptr.nk
 *         cdef ndarray vec = c2numpy_double(<double *>kv, nk)
 *         return vec             # <<<<<<<<<<<<<<
 *         #return vec.reshape((kv,))
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_vec));
  __pyx_r = ((PyObject *)__pyx_v_vec);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.kv");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":52
 * 
 *     @property
 *     def ref(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nk
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_ref(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_ref(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("ref");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":53
 *     @property
 *     def ref(self):
 *         return self.thisptr.nk             # <<<<<<<<<<<<<<
 * 
 * cdef class CurvMap:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_v_self)->thisptr->nk); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Nurbs.ref");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":59
 * 
 *     @property
 *     def order(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.order
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_order(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_order(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("order");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":60
 *     @property
 *     def order(self):
 *         return self.thisptr.order             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_v_self)->thisptr->order); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.CurvMap.order");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":63
 * 
 *     @property
 *     def toplevel(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.toplevel
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_toplevel(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_toplevel(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("toplevel");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":64
 *     @property
 *     def toplevel(self):
 *         return self.thisptr.toplevel             # <<<<<<<<<<<<<<
 * 
 *     def get_nurbs(self, int k):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_v_self)->thisptr->toplevel); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.CurvMap.toplevel");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":66
 *         return self.thisptr.toplevel
 * 
 *     def get_nurbs(self, int k):             # <<<<<<<<<<<<<<
 *         if self.thisptr.toplevel == 0:
 *             return None
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_get_nurbs(PyObject *__pyx_v_self, PyObject *__pyx_arg_k); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_get_nurbs(PyObject *__pyx_v_self, PyObject *__pyx_arg_k) {
  int __pyx_v_k;
  struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *__pyx_v_n = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("get_nurbs");
  assert(__pyx_arg_k); {
    __pyx_v_k = __Pyx_PyInt_AsInt(__pyx_arg_k); if (unlikely((__pyx_v_k == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.CurvMap.get_nurbs");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":67
 * 
 *     def get_nurbs(self, int k):
 *         if self.thisptr.toplevel == 0:             # <<<<<<<<<<<<<<
 *             return None
 *         if self.thisptr.nurbs[k] == NULL:
 */
  __pyx_t_1 = (((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_v_self)->thisptr->toplevel == 0);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":68
 *     def get_nurbs(self, int k):
 *         if self.thisptr.toplevel == 0:
 *             return None             # <<<<<<<<<<<<<<
 *         if self.thisptr.nurbs[k] == NULL:
 *             return None
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":69
 *         if self.thisptr.toplevel == 0:
 *             return None
 *         if self.thisptr.nurbs[k] == NULL:             # <<<<<<<<<<<<<<
 *             return None
 * 
 */
  __pyx_t_1 = ((((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_v_self)->thisptr->nurbs[__pyx_v_k]) == NULL);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":70
 *             return None
 *         if self.thisptr.nurbs[k] == NULL:
 *             return None             # <<<<<<<<<<<<<<
 * 
 *         cdef Nurbs n = Nurbs()
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":72
 *             return None
 * 
 *         cdef Nurbs n = Nurbs()             # <<<<<<<<<<<<<<
 *         n.thisptr = self.thisptr.nurbs[k]
 *         return n
 */
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (!(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8hermes2d_9_hermes2d_Nurbs))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":73
 * 
 *         cdef Nurbs n = Nurbs()
 *         n.thisptr = self.thisptr.nurbs[k]             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
  __pyx_v_n->thisptr = (((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_v_self)->thisptr->nurbs[__pyx_v_k]);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":74
 *         cdef Nurbs n = Nurbs()
 *         n.thisptr = self.thisptr.nurbs[k]
 *         return n             # <<<<<<<<<<<<<<
 * 
 * cdef class Node:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.CurvMap.get_nurbs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":80
 * 
 *     @property
 *     def id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.id
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_id(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_id(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("id");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":81
 *     @property
 *     def id(self):
 *         return self.thisptr.id             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.id");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":84
 * 
 *     @property
 *     def ref(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.ref
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_ref(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_ref(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("ref");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":85
 *     @property
 *     def ref(self):
 *         return self.thisptr.ref             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyLong_FromUnsignedLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->ref); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.ref");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":88
 * 
 *     @property
 *     def type(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.type
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_type(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_type(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("type");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":89
 *     @property
 *     def type(self):
 *         return self.thisptr.type             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyLong_FromUnsignedLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->type); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.type");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":92
 * 
 *     @property
 *     def bnd(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.bnd
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_bnd(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_bnd(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("bnd");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":93
 *     @property
 *     def bnd(self):
 *         return self.thisptr.bnd             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyLong_FromUnsignedLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->bnd); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.bnd");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":96
 * 
 *     @property
 *     def marker(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.marker
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_marker(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_marker(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("marker");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":97
 *     @property
 *     def marker(self):
 *         return self.thisptr.marker             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyLong_FromUnsignedLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->marker); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.marker");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":100
 * 
 *     @property
 *     def used(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.used == 1
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_used(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_used(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("used");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":101
 *     @property
 *     def used(self):
 *         return self.thisptr.used == 1             # <<<<<<<<<<<<<<
 * 
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong((((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->used == 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.used");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":103
 *         return self.thisptr.used == 1
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         return "Node %d: coord=%r, used=%r" % (self.id, self.coord, self.used)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node___str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node___str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_SetupRefcountContext("__str__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":104
 * 
 *     def __str__(self):
 *         return "Node %d: coord=%r, used=%r" % (self.id, self.coord, self.used)             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_coord); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_used); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Remainder(__pyx_kp_47, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.__str__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":107
 * 
 *     @property
 *     def coord(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.x, self.thisptr.y
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_coord(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Node_coord(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("coord");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":108
 *     @property
 *     def coord(self):
 *         return self.thisptr.x, self.thisptr.y             # <<<<<<<<<<<<<<
 * 
 * cdef class Element:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_v_self)->thisptr->y); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_r = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Node.coord");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":114
 * 
 *     @property
 *     def id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.id
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_id(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_id(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("id");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":115
 *     @property
 *     def id(self):
 *         return self.thisptr.id             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.id");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":118
 * 
 *     @property
 *     def nvert(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nvert
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nvert(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nvert(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("nvert");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":119
 *     @property
 *     def nvert(self):
 *         return self.thisptr.nvert             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyLong_FromUnsignedLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->nvert); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.nvert");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":122
 * 
 *     @property
 *     def active(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.active == 1
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_active(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_active(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("active");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":123
 *     @property
 *     def active(self):
 *         return self.thisptr.active == 1             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong((((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->active == 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.active");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":126
 * 
 *     @property
 *     def used(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.used == 1
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_used(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_used(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("used");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":127
 *     @property
 *     def used(self):
 *         return self.thisptr.used == 1             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong((((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->used == 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.used");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":130
 * 
 *     @property
 *     def marker(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.marker
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_marker(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_marker(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("marker");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":131
 *     @property
 *     def marker(self):
 *         return self.thisptr.marker             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->marker); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.marker");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":134
 * 
 *     @property
 *     def nodes_vertex(self):             # <<<<<<<<<<<<<<
 *         return [self.get_vertex_node(i) for i in range(self.nvert)]
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  __Pyx_SetupRefcountContext("nodes_vertex");
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":135
 *     @property
 *     def nodes_vertex(self):
 *         return [self.get_vertex_node(i) for i in range(self.nvert)]             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_nvert); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_vertex_node); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_6 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_7 = PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_6); if (unlikely(__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.nodes_vertex");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":138
 * 
 *     @property
 *     def nodes_vertex_id(self):             # <<<<<<<<<<<<<<
 *         return [node.id for node in self.nodes_vertex]
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex_id(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex_id(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_node;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  __Pyx_SetupRefcountContext("nodes_vertex_id");
  __pyx_v_node = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":139
 *     @property
 *     def nodes_vertex_id(self):
 *         return [node.id for node in self.nodes_vertex]             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_nodes_vertex); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_id); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_3); if (unlikely(__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.nodes_vertex_id");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_node);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":142
 * 
 *     @property
 *     def nodes_edge(self):             # <<<<<<<<<<<<<<
 *         return [self.get_edge_node(i) for i in range(self.nvert)]
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_edge(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_edge(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  __Pyx_SetupRefcountContext("nodes_edge");
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":143
 *     @property
 *     def nodes_edge(self):
 *         return [self.get_edge_node(i) for i in range(self.nvert)]             # <<<<<<<<<<<<<<
 * 
 *     def get_vertex_node(self, int id):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_nvert); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_edge_node); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_6 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_7 = PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_6); if (unlikely(__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.nodes_edge");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":145
 *         return [self.get_edge_node(i) for i in range(self.nvert)]
 * 
 *     def get_vertex_node(self, int id):             # <<<<<<<<<<<<<<
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.vn[id]
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_vertex_node(PyObject *__pyx_v_self, PyObject *__pyx_arg_id); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_vertex_node(PyObject *__pyx_v_self, PyObject *__pyx_arg_id) {
  int __pyx_v_id;
  struct __pyx_obj_8hermes2d_9_hermes2d_Node *__pyx_v_n = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_vertex_node");
  assert(__pyx_arg_id); {
    __pyx_v_id = __Pyx_PyInt_AsInt(__pyx_arg_id); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_vertex_node");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":146
 * 
 *     def get_vertex_node(self, int id):
 *         cdef Node n = Node()             # <<<<<<<<<<<<<<
 *         n.thisptr = self.thisptr.vn[id]
 *         return n
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Node)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_Node))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":147
 *     def get_vertex_node(self, int id):
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.vn[id]             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
  __pyx_v_n->thisptr = (((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->vn[__pyx_v_id]);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":148
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.vn[id]
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_vertex_node");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":151
 * 
 *     @property
 *     def curved_map(self):             # <<<<<<<<<<<<<<
 *         if self.thisptr.cm == NULL:
 *             return None
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_curved_map(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_curved_map(PyObject *__pyx_v_self, PyObject *unused) {
  struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *__pyx_v_cm = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("curved_map");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":152
 *     @property
 *     def curved_map(self):
 *         if self.thisptr.cm == NULL:             # <<<<<<<<<<<<<<
 *             return None
 * 
 */
  __pyx_t_1 = (((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->cm == NULL);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":153
 *     def curved_map(self):
 *         if self.thisptr.cm == NULL:
 *             return None             # <<<<<<<<<<<<<<
 * 
 *         cdef CurvMap cm = CurvMap()
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":155
 *             return None
 * 
 *         cdef CurvMap cm = CurvMap()             # <<<<<<<<<<<<<<
 *         cm.thisptr = self.thisptr.cm
 *         return cm
 */
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_CurvMap)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (!(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8hermes2d_9_hermes2d_CurvMap))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_cm = ((struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":156
 * 
 *         cdef CurvMap cm = CurvMap()
 *         cm.thisptr = self.thisptr.cm             # <<<<<<<<<<<<<<
 *         return cm
 * 
 */
  __pyx_v_cm->thisptr = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->cm;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":157
 *         cdef CurvMap cm = CurvMap()
 *         cm.thisptr = self.thisptr.cm
 *         return cm             # <<<<<<<<<<<<<<
 * 
 *     def get_edge_node(self, int id):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_cm));
  __pyx_r = ((PyObject *)__pyx_v_cm);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.curved_map");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_cm);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":159
 *         return cm
 * 
 *     def get_edge_node(self, int id):             # <<<<<<<<<<<<<<
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.en[id]
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_edge_node(PyObject *__pyx_v_self, PyObject *__pyx_arg_id); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_edge_node(PyObject *__pyx_v_self, PyObject *__pyx_arg_id) {
  int __pyx_v_id;
  struct __pyx_obj_8hermes2d_9_hermes2d_Node *__pyx_v_n = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_edge_node");
  assert(__pyx_arg_id); {
    __pyx_v_id = __Pyx_PyInt_AsInt(__pyx_arg_id); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_edge_node");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":160
 * 
 *     def get_edge_node(self, int id):
 *         cdef Node n = Node()             # <<<<<<<<<<<<<<
 *         n.thisptr = self.thisptr.en[id]
 *         return n
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Node)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_Node))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Node *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":161
 *     def get_edge_node(self, int id):
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.en[id]             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
  __pyx_v_n->thisptr = (((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->en[__pyx_v_id]);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":162
 *         cdef Node n = Node()
 *         n.thisptr = self.thisptr.en[id]
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def get_son_element(self, int id):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_edge_node");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":164
 *         return n
 * 
 *     def get_son_element(self, int id):             # <<<<<<<<<<<<<<
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.sons[id]
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_son_element(PyObject *__pyx_v_self, PyObject *__pyx_arg_id); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_son_element(PyObject *__pyx_v_self, PyObject *__pyx_arg_id) {
  int __pyx_v_id;
  struct __pyx_obj_8hermes2d_9_hermes2d_Element *__pyx_v_e = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_son_element");
  assert(__pyx_arg_id); {
    __pyx_v_id = __Pyx_PyInt_AsInt(__pyx_arg_id); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_son_element");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":165
 * 
 *     def get_son_element(self, int id):
 *         cdef Element e = Element()             # <<<<<<<<<<<<<<
 *         e.thisptr = self.thisptr.sons[id]
 *         return e
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Element)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_Element))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":166
 *     def get_son_element(self, int id):
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.sons[id]             # <<<<<<<<<<<<<<
 *         return e
 * 
 */
  __pyx_v_e->thisptr = (((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->sons[__pyx_v_id]);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":167
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.sons[id]
 *         return e             # <<<<<<<<<<<<<<
 * 
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_e));
  __pyx_r = ((PyObject *)__pyx_v_e);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_son_element");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_e);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":169
 *         return e
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         nodes_id = [node.id for node in self.nodes_vertex]
 *         return "Element %d: nodes_id=%r, active=%r, marker=%d, used=%r" % \
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element___str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element___str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_nodes_id;
  PyObject *__pyx_v_node;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_SetupRefcountContext("__str__");
  __pyx_v_nodes_id = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":170
 * 
 *     def __str__(self):
 *         nodes_id = [node.id for node in self.nodes_vertex]             # <<<<<<<<<<<<<<
 *         return "Element %d: nodes_id=%r, active=%r, marker=%d, used=%r" % \
 *                 (self.id, nodes_id, self.active, self.marker, self.used)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_nodes_vertex); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_id); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_3); if (unlikely(__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_nodes_id);
  __pyx_v_nodes_id = ((PyObject *)__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":171
 *     def __str__(self):
 *         nodes_id = [node.id for node in self.nodes_vertex]
 *         return "Element %d: nodes_id=%r, active=%r, marker=%d, used=%r" % \             # <<<<<<<<<<<<<<
 *                 (self.id, nodes_id, self.active, self.marker, self.used)
 * 
 */
  __Pyx_XDECREF(__pyx_r);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":172
 *         nodes_id = [node.id for node in self.nodes_vertex]
 *         return "Element %d: nodes_id=%r, active=%r, marker=%d, used=%r" % \
 *                 (self.id, nodes_id, self.active, self.marker, self.used)             # <<<<<<<<<<<<<<
 * 
 *     def get_diameter(self):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_active); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_marker); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_used); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = PyTuple_New(5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_7));
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_nodes_id);
  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_nodes_id);
  __Pyx_GIVEREF(__pyx_v_nodes_id);
  PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 4, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Remainder(__pyx_kp_48, ((PyObject *)__pyx_t_7)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.__str__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_nodes_id);
  __Pyx_DECREF(__pyx_v_node);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":174
 *                 (self.id, nodes_id, self.active, self.marker, self.used)
 * 
 *     def get_diameter(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_diameter()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_diameter(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_diameter(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_diameter");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":175
 * 
 *     def get_diameter(self):
 *         return self.thisptr.get_diameter()             # <<<<<<<<<<<<<<
 * 
 *     def get_area(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->get_diameter()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_diameter");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":177
 *         return self.thisptr.get_diameter()
 * 
 *     def get_area(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_area()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_area(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7Element_get_area(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_area");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":178
 * 
 *     def get_area(self):
 *         return self.thisptr.get_area()             # <<<<<<<<<<<<<<
 * 
 * def get_node_id(node):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_self)->thisptr->get_area()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Element.get_area");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":180
 *         return self.thisptr.get_area()
 * 
 * def get_node_id(node):             # <<<<<<<<<<<<<<
 *     # This function is used in nodes.sort() in the Mesh class.
 *     # Cython doesn't yet support lambda functions, nor closures.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_get_node_id(PyObject *__pyx_self, PyObject *__pyx_v_node); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_get_node_id(PyObject *__pyx_self, PyObject *__pyx_v_node) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_node_id");
  __pyx_self = __pyx_self;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":183
 *     # This function is used in nodes.sort() in the Mesh class.
 *     # Cython doesn't yet support lambda functions, nor closures.
 *     return node.id             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.get_node_id");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":188
 * cdef class Mesh:
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_Mesh()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_4Mesh___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_4Mesh___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":189
 * 
 *     def __cinit__(self):
 *         self.thisptr = new_Mesh()             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr = new Mesh();

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":191
 *         self.thisptr = new_Mesh()
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_4Mesh___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_4Mesh___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":192
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def copy(self, Mesh m):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":194
 *         delete(self.thisptr)
 * 
 *     def copy(self, Mesh m):             # <<<<<<<<<<<<<<
 *         self.thisptr.copy(m.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_copy(PyObject *__pyx_v_self, PyObject *__pyx_v_m); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_copy(PyObject *__pyx_v_self, PyObject *__pyx_v_m) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("copy");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_m), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "m", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":195
 * 
 *     def copy(self, Mesh m):
 *         self.thisptr.copy(m.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def load(self, char* filename):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->copy(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_m)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.copy");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":197
 *         self.thisptr.copy(m.thisptr)
 * 
 *     def load(self, char* filename):             # <<<<<<<<<<<<<<
 *         cdef c_H2DReader mloader
 *         mloader.load(filename, self.thisptr)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename) {
  char *__pyx_v_filename;
  struct H2DReader __pyx_v_mloader;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("load");
  assert(__pyx_arg_filename); {
    __pyx_v_filename = __Pyx_PyBytes_AsString(__pyx_arg_filename); if (unlikely((!__pyx_v_filename) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.load");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":199
 *     def load(self, char* filename):
 *         cdef c_H2DReader mloader
 *         mloader.load(filename, self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def load_str(self, char* mesh):
 */
  __pyx_v_mloader.load(__pyx_v_filename, ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":201
 *         mloader.load(filename, self.thisptr)
 * 
 *     def load_str(self, char* mesh):             # <<<<<<<<<<<<<<
 *         cdef c_H2DReader mloader
 *         mloader.load_str(mesh, self.thisptr)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_str(PyObject *__pyx_v_self, PyObject *__pyx_arg_mesh); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_str(PyObject *__pyx_v_self, PyObject *__pyx_arg_mesh) {
  char *__pyx_v_mesh;
  struct H2DReader __pyx_v_mloader;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("load_str");
  assert(__pyx_arg_mesh); {
    __pyx_v_mesh = __Pyx_PyBytes_AsString(__pyx_arg_mesh); if (unlikely((!__pyx_v_mesh) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.load_str");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":203
 *     def load_str(self, char* mesh):
 *         cdef c_H2DReader mloader
 *         mloader.load_str(mesh, self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __pyx_v_mloader.load_str(__pyx_v_mesh, ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":206
 * 
 *     @property
 *     def elements_markers(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the list of elements (as ids) made up by their corresponding vertices,
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements_markers(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_elements_markers[] = "\n        Returns the list of elements (as ids) made up by their corresponding vertices,\n        plus and extra number denoting the element (material) marker.\n\n        Element markers allow you to use different material parameters in areas \n        with different material identity.\n \n        Example:\n\n        >>> import hermes2d\n        >>> m = hermes2d.Mesh() \n        >>> m.create([\n        ...         [0, -1],\n        ...         [1, -1],\n        ...         [-1, 0],\n        ...         [0, 0],\n        ...         [1, 0],\n        ...         [-1, 1],\n        ...         [0, 1],\n        ...         [0.707106781, 0.707106781],\n        ...     ], [\n        ...         [0, 1, 4, 3, 0],\n        ...         [3, 4, 7, 0],\n        ...         [3, 7, 6, 0],\n        ...         [2, 3, 6, 5, 0],\n        ...     ], [\n        ...         [0, 1, 1],\n        ...         [1, 4, 2],\n        ...         [3, 0, 4],\n        ...         [4, 7, 2],\n        ...         [7, 6, 2],\n        ...         [2, 3, 4],\n        ...         [6, 5, 2],\n        ...         [5, 2, 3],\n        ...     ], [\n        ...         [4, 7, 45],\n        ...         [7, 6, 45],\n        ...     ])\n        >>> m.elements_markers\n        [[0, 1, 4, 3, 0], [3, 4, 7, 0], [3, 7, 6, 0], [2, 3, 6, 5, 0]] \n\n        If the domain is composed of only one material, as in the example above,\n        all elements may be assigned a zero marker.  In the example above\n        \"[0, 1, 4, 3, 0]\" is an element with \"0\" being the corresponding element\n        marker.\n    \n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements_markers(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_element_list;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  __Pyx_SetupRefcountContext("elements_markers");
  __pyx_v_element_list = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":254
 * 
 *         """
 *         element_list = []             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_element_list);
  __pyx_v_element_list = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":255
 *         """
 *         element_list = []
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             element_list.append(el.nodes_vertex_id + [el.marker])
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":256
 *         element_list = []
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             element_list.append(el.nodes_vertex_id + [el.marker])
 *         return element_list
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":257
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             element_list.append(el.nodes_vertex_id + [el.marker])             # <<<<<<<<<<<<<<
 *         return element_list
 * 
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_nodes_vertex_id); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_marker); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(__pyx_t_5, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Append(__pyx_v_element_list, __pyx_t_4); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":258
 *             el = self.get_element(i)
 *             element_list.append(el.nodes_vertex_id + [el.marker])
 *         return element_list             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_element_list);
  __pyx_r = __pyx_v_element_list;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.elements_markers");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_element_list);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":261
 * 
 *     @property
 *     def elements(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the list of elements (as ids) made up by their corresponding vertices.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_elements[] = "\n        Returns the list of elements (as ids) made up by their corresponding vertices.\n\n        Elements in a mesh are made up of zero based indices of their vertices in a \n        counterclockwise order.\n\n        Example:\n\n        >>> m.create([\n        ...         [0, -1],\n        ...         [1, -1],\n        ...         [-1, 0],\n        ...         [0, 0],\n        ...         [1, 0],\n        ...         [-1, 1],\n        ...         [0, 1],\n        ...         [0.707106781, 0.707106781],\n        ...     ], [\n        ...         [0, 1, 4, 3, 0],\n        ...         [3, 4, 7, 0],\n        ...         [3, 7, 6, 0],\n        ...         [2, 3, 6, 5, 0],\n        ...     ], [\n        ...         [0, 1, 1],\n        ...         [1, 4, 2],\n        ...         [3, 0, 4],\n        ...         [4, 7, 2],\n        ...         [7, 6, 2],\n        ...         [2, 3, 4],\n        ...         [6, 5, 2],\n        ...         [5, 2, 3],\n        ...     ], [\n        ...         [4, 7, 45],\n        ...         [7, 6, 45],\n        ...     ])\n        >>> m.elements\n        [[0, 1, 4, 3], [3, 4, 7], [3, 7, 6], [2, 3, 6, 5]] \n\n        In the example above \"[0, 1, 4, 3]\" is an element.\n\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_element_list;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("elements");
  __pyx_v_element_list = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":303
 * 
 *         """
 *         element_list = []             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_element_list);
  __pyx_v_element_list = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":304
 *         """
 *         element_list = []
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             if el.active:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":305
 *         element_list = []
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if el.active:
 *                 element_list.append(el.nodes_vertex_id)
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":306
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             if el.active:             # <<<<<<<<<<<<<<
 *                 element_list.append(el.nodes_vertex_id)
 *         return element_list
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":307
 *             el = self.get_element(i)
 *             if el.active:
 *                 element_list.append(el.nodes_vertex_id)             # <<<<<<<<<<<<<<
 *         return element_list
 * 
 */
      __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_nodes_vertex_id); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = __Pyx_PyObject_Append(__pyx_v_element_list, __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":308
 *             if el.active:
 *                 element_list.append(el.nodes_vertex_id)
 *         return element_list             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_element_list);
  __pyx_r = __pyx_v_element_list;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.elements");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_element_list);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":311
 * 
 *     @property
 *     def active_elements(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the list of active elements (as Element instances).
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_active_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_active_elements[] = "\n        Return the list of active elements (as Element instances).\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_active_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_element_list;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("active_elements");
  __pyx_v_element_list = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":315
 *         Return the list of active elements (as Element instances).
 *         """
 *         element_list = []             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_element_list);
  __pyx_v_element_list = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":316
 *         """
 *         element_list = []
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             if el.active:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":317
 *         element_list = []
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if el.active:
 *                 element_list.append(el)
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":318
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             if el.active:             # <<<<<<<<<<<<<<
 *                 element_list.append(el)
 *         return element_list
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":319
 *             el = self.get_element(i)
 *             if el.active:
 *                 element_list.append(el)             # <<<<<<<<<<<<<<
 *         return element_list
 * 
 */
      __pyx_t_5 = __Pyx_PyObject_Append(__pyx_v_element_list, __pyx_v_el); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":320
 *             if el.active:
 *                 element_list.append(el)
 *         return element_list             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_element_list);
  __pyx_r = __pyx_v_element_list;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.active_elements");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_element_list);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":323
 * 
 *     @property
 *     def nodes(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a list of nodes coordinates.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_nodes[] = "\n        Returns a list of nodes coordinates.\n\n        However, this is only usable if you don't refine.\n\n        Use nodes_dict for more usable implementation.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_nodes;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_v_node_dict;
  PyObject *__pyx_v_node;
  PyObject *__pyx_v_nodes_coord;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("nodes");
  __pyx_v_nodes = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node_dict = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_nodes_coord = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":334
 *         # done for now. Later on, we should get the list of nodes from C++
 *         # directly.
 *         nodes = []             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_nodes);
  __pyx_v_nodes = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":335
 *         # directly.
 *         nodes = []
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             nodes.extend(el.nodes_vertex)
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":336
 *         nodes = []
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             nodes.extend(el.nodes_vertex)
 *         node_dict = {}
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":337
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             nodes.extend(el.nodes_vertex)             # <<<<<<<<<<<<<<
 *         node_dict = {}
 *         for node in nodes:
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_nodes, __pyx_kp_extend); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_nodes_vertex); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":338
 *             el = self.get_element(i)
 *             nodes.extend(el.nodes_vertex)
 *         node_dict = {}             # <<<<<<<<<<<<<<
 *         for node in nodes:
 *             node_dict[node.id] = node
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __Pyx_DECREF(__pyx_v_node_dict);
  __pyx_v_node_dict = ((PyObject *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":339
 *             nodes.extend(el.nodes_vertex)
 *         node_dict = {}
 *         for node in nodes:             # <<<<<<<<<<<<<<
 *             node_dict[node.id] = node
 *         nodes = node_dict.values()
 */
  if (PyList_CheckExact(__pyx_v_nodes) || PyTuple_CheckExact(__pyx_v_nodes)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_v_nodes; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_nodes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else {
      __pyx_t_4 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_4) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":340
 *         node_dict = {}
 *         for node in nodes:
 *             node_dict[node.id] = node             # <<<<<<<<<<<<<<
 *         nodes = node_dict.values()
 *         nodes.sort(key=get_node_id)
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_id); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    if (PyObject_SetItem(__pyx_v_node_dict, __pyx_t_4, __pyx_v_node) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":341
 *         for node in nodes:
 *             node_dict[node.id] = node
 *         nodes = node_dict.values()             # <<<<<<<<<<<<<<
 *         nodes.sort(key=get_node_id)
 *         nodes_coord = [node.coord for node in nodes]
 */
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_node_dict, __pyx_kp_values); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_v_nodes);
  __pyx_v_nodes = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":342
 *             node_dict[node.id] = node
 *         nodes = node_dict.values()
 *         nodes.sort(key=get_node_id)             # <<<<<<<<<<<<<<
 *         nodes_coord = [node.coord for node in nodes]
 *         return nodes_coord
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_nodes, __pyx_kp_sort); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_kp_get_node_id); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  if (PyDict_SetItem(__pyx_1, __pyx_kp_key, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_t_3 = PyEval_CallObjectWithKeywords(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":343
 *         nodes = node_dict.values()
 *         nodes.sort(key=get_node_id)
 *         nodes_coord = [node.coord for node in nodes]             # <<<<<<<<<<<<<<
 *         return nodes_coord
 * 
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  if (PyList_CheckExact(__pyx_v_nodes) || PyTuple_CheckExact(__pyx_v_nodes)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_v_nodes; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_nodes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_coord); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = PyList_Append(__pyx_t_3, (PyObject*)__pyx_t_1); if (unlikely(__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_INCREF(((PyObject *)__pyx_t_3));
  __Pyx_DECREF(__pyx_v_nodes_coord);
  __pyx_v_nodes_coord = ((PyObject *)__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":344
 *         nodes.sort(key=get_node_id)
 *         nodes_coord = [node.coord for node in nodes]
 *         return nodes_coord             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_nodes_coord);
  __pyx_r = __pyx_v_nodes_coord;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.nodes");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_nodes);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_DECREF(__pyx_v_node_dict);
  __Pyx_DECREF(__pyx_v_node);
  __Pyx_DECREF(__pyx_v_nodes_coord);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":347
 * 
 *     @property
 *     def nodes_dict(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a dict of all active nodes coordinates.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes_dict(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_nodes_dict[] = "\n        Returns a dict of all active nodes coordinates.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes_dict(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_nodes;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_v_node_dict;
  PyObject *__pyx_v_node;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("nodes_dict");
  __pyx_v_nodes = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node_dict = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":351
 *         Returns a dict of all active nodes coordinates.
 *         """
 *         nodes = []             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(__pyx_v_nodes);
  __pyx_v_nodes = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":352
 *         """
 *         nodes = []
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             if el.active:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":353
 *         nodes = []
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if el.active:
 *                 nodes.extend(el.nodes_vertex)
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":354
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             if el.active:             # <<<<<<<<<<<<<<
 *                 nodes.extend(el.nodes_vertex)
 *         node_dict = {}
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":355
 *             el = self.get_element(i)
 *             if el.active:
 *                 nodes.extend(el.nodes_vertex)             # <<<<<<<<<<<<<<
 *         node_dict = {}
 *         for node in nodes:
 */
      __pyx_t_5 = PyObject_GetAttr(__pyx_v_nodes, __pyx_kp_extend); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_nodes_vertex); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_1));
      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":356
 *             if el.active:
 *                 nodes.extend(el.nodes_vertex)
 *         node_dict = {}             # <<<<<<<<<<<<<<
 *         for node in nodes:
 *             node_dict[node.id] = node.coord
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __Pyx_DECREF(__pyx_v_node_dict);
  __pyx_v_node_dict = ((PyObject *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":357
 *                 nodes.extend(el.nodes_vertex)
 *         node_dict = {}
 *         for node in nodes:             # <<<<<<<<<<<<<<
 *             node_dict[node.id] = node.coord
 *         return node_dict
 */
  if (PyList_CheckExact(__pyx_v_nodes) || PyTuple_CheckExact(__pyx_v_nodes)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_v_nodes; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_nodes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else {
      __pyx_t_4 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_4) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":358
 *         node_dict = {}
 *         for node in nodes:
 *             node_dict[node.id] = node.coord             # <<<<<<<<<<<<<<
 *         return node_dict
 * 
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_coord); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_node, __pyx_kp_id); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyObject_SetItem(__pyx_v_node_dict, __pyx_t_1, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":359
 *         for node in nodes:
 *             node_dict[node.id] = node.coord
 *         return node_dict             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_node_dict);
  __pyx_r = __pyx_v_node_dict;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.nodes_dict");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_nodes);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_DECREF(__pyx_v_node_dict);
  __Pyx_DECREF(__pyx_v_node);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":362
 * 
 *     @property
 *     def curves(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return curves
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_curves(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_curves[] = "\n        Return curves\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_curves(PyObject *__pyx_v_self, PyObject *unused) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Element *__pyx_v_e;
  double2 *__pyx_v_tp;
  PyArrayObject *__pyx_v_vec;
  PyObject *__pyx_v_crv;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_v_cm;
  PyObject *__pyx_v_j;
  PyObject *__pyx_v_n;
  PyObject *__pyx_v_sp;
  PyObject *__pyx_v_cp;
  PyObject *__pyx_v_ep;
  PyObject *__pyx_v_x;
  PyObject *__pyx_v_point;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_SetupRefcountContext("curves");
  __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_vec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_crv = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_cm = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_j = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_n = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_sp = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_cp = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_ep = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_x = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_point = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":370
 *         cdef ndarray vec
 * 
 *         crv = {}             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __Pyx_DECREF(__pyx_v_crv);
  __pyx_v_crv = ((PyObject *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":371
 * 
 *         crv = {}
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             if el.active:
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":372
 *         crv = {}
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if el.active:
 *                 cm = el.curved_map
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":373
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             if el.active:             # <<<<<<<<<<<<<<
 *                 cm = el.curved_map
 *                 if cm != None:
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":374
 *             el = self.get_element(i)
 *             if el.active:
 *                 cm = el.curved_map             # <<<<<<<<<<<<<<
 *                 if cm != None:
 *                     if cm.toplevel == True:
 */
      __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_curved_map); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_v_cm);
      __pyx_v_cm = __pyx_t_5;
      __pyx_t_5 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":375
 *             if el.active:
 *                 cm = el.curved_map
 *                 if cm != None:             # <<<<<<<<<<<<<<
 *                     if cm.toplevel == True:
 *                         for j in range(4):
 */
      __pyx_t_5 = PyObject_RichCompare(__pyx_v_cm, Py_None, Py_NE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_6) {

        /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":376
 *                 cm = el.curved_map
 *                 if cm != None:
 *                     if cm.toplevel == True:             # <<<<<<<<<<<<<<
 *                         for j in range(4):
 *                             n = cm.get_nurbs(j)
 */
        __pyx_t_5 = PyObject_GetAttr(__pyx_v_cm, __pyx_kp_toplevel); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_4 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_t_4, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_6) {

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":377
 *                 if cm != None:
 *                     if cm.toplevel == True:
 *                         for j in range(4):             # <<<<<<<<<<<<<<
 *                             n = cm.get_nurbs(j)
 *                             if n != None:
 */
          __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_2));
          __Pyx_INCREF(__pyx_int_4);
          PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_4);
          __Pyx_GIVEREF(__pyx_int_4);
          __pyx_t_4 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
          if (PyList_CheckExact(__pyx_t_4) || PyTuple_CheckExact(__pyx_t_4)) {
            __pyx_t_7 = 0; __pyx_t_2 = __pyx_t_4; __Pyx_INCREF(__pyx_t_2);
          } else {
            __pyx_t_7 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_2);
          }
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          for (;;) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_2)) break;
              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++;
            } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
              if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++;
            } else {
              __pyx_t_4 = PyIter_Next(__pyx_t_2);
              if (!__pyx_t_4) {
                if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
                break;
              }
              __Pyx_GOTREF(__pyx_t_4);
            }
            __Pyx_DECREF(__pyx_v_j);
            __pyx_v_j = __pyx_t_4;
            __pyx_t_4 = 0;

            /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":378
 *                     if cm.toplevel == True:
 *                         for j in range(4):
 *                             n = cm.get_nurbs(j)             # <<<<<<<<<<<<<<
 *                             if n != None:
 *                                 sp = (n.pt[0][0], n.pt[0][1])
 */
            __pyx_t_4 = PyObject_GetAttr(__pyx_v_cm, __pyx_kp_get_nurbs); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(((PyObject *)__pyx_t_5));
            __Pyx_INCREF(__pyx_v_j);
            PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_j);
            __Pyx_GIVEREF(__pyx_v_j);
            __pyx_t_8 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
            __Pyx_DECREF(__pyx_v_n);
            __pyx_v_n = __pyx_t_8;
            __pyx_t_8 = 0;

            /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":379
 *                         for j in range(4):
 *                             n = cm.get_nurbs(j)
 *                             if n != None:             # <<<<<<<<<<<<<<
 *                                 sp = (n.pt[0][0], n.pt[0][1])
 *                                 cp = (n.pt[1][0], n.pt[1][1])
 */
            __pyx_t_8 = PyObject_RichCompare(__pyx_v_n, Py_None, Py_NE); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_8);
            __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
            if (__pyx_t_6) {

              /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":380
 *                             n = cm.get_nurbs(j)
 *                             if n != None:
 *                                 sp = (n.pt[0][0], n.pt[0][1])             # <<<<<<<<<<<<<<
 *                                 cp = (n.pt[1][0], n.pt[1][1])
 *                                 ep = (n.pt[2][0], n.pt[2][1])
 */
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_1 = __Pyx_GetItemInt(__pyx_t_8, 0, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_2 = __Pyx_GetItemInt(__pyx_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_2);
              __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_1 = __Pyx_GetItemInt(__pyx_t_8, 0, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_3 = __Pyx_GetItemInt(__pyx_1, 1, sizeof(long), PyInt_FromLong); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_3);
              __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
              __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(((PyObject *)__pyx_t_8));
              PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_2);
              __Pyx_GIVEREF(__pyx_2);
              PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_3);
              __Pyx_GIVEREF(__pyx_3);
              __pyx_2 = 0;
              __pyx_3 = 0;
              __Pyx_DECREF(__pyx_v_sp);
              __pyx_v_sp = ((PyObject *)__pyx_t_8);
              __pyx_t_8 = 0;

              /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":381
 *                             if n != None:
 *                                 sp = (n.pt[0][0], n.pt[0][1])
 *                                 cp = (n.pt[1][0], n.pt[1][1])             # <<<<<<<<<<<<<<
 *                                 ep = (n.pt[2][0], n.pt[2][1])
 *                                 crv[i] = []
 */
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_1 = __Pyx_GetItemInt(__pyx_t_8, 1, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_2 = __Pyx_GetItemInt(__pyx_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_2);
              __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_3 = __Pyx_GetItemInt(__pyx_t_8, 1, sizeof(long), PyInt_FromLong); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_3);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_1 = __Pyx_GetItemInt(__pyx_3, 1, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __Pyx_DECREF(__pyx_3); __pyx_3 = 0;
              __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(((PyObject *)__pyx_t_8));
              PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_2);
              __Pyx_GIVEREF(__pyx_2);
              PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_1);
              __Pyx_GIVEREF(__pyx_1);
              __pyx_2 = 0;
              __pyx_1 = 0;
              __Pyx_DECREF(__pyx_v_cp);
              __pyx_v_cp = ((PyObject *)__pyx_t_8);
              __pyx_t_8 = 0;

              /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":382
 *                                 sp = (n.pt[0][0], n.pt[0][1])
 *                                 cp = (n.pt[1][0], n.pt[1][1])
 *                                 ep = (n.pt[2][0], n.pt[2][1])             # <<<<<<<<<<<<<<
 *                                 crv[i] = []
 *                                 crv[i].append([sp, cp, ep])
 */
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_3 = __Pyx_GetItemInt(__pyx_t_8, 2, sizeof(long), PyInt_FromLong); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_3);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_2 = __Pyx_GetItemInt(__pyx_3, 0, sizeof(long), PyInt_FromLong); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_2);
              __Pyx_DECREF(__pyx_3); __pyx_3 = 0;
              __pyx_t_8 = PyObject_GetAttr(__pyx_v_n, __pyx_kp_pt); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_8);
              __pyx_1 = __Pyx_GetItemInt(__pyx_t_8, 2, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_3 = __Pyx_GetItemInt(__pyx_1, 1, sizeof(long), PyInt_FromLong); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_3);
              __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
              __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(((PyObject *)__pyx_t_8));
              PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_2);
              __Pyx_GIVEREF(__pyx_2);
              PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_3);
              __Pyx_GIVEREF(__pyx_3);
              __pyx_2 = 0;
              __pyx_3 = 0;
              __Pyx_DECREF(__pyx_v_ep);
              __pyx_v_ep = ((PyObject *)__pyx_t_8);
              __pyx_t_8 = 0;

              /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":383
 *                                 cp = (n.pt[1][0], n.pt[1][1])
 *                                 ep = (n.pt[2][0], n.pt[2][1])
 *                                 crv[i] = []             # <<<<<<<<<<<<<<
 *                                 crv[i].append([sp, cp, ep])
 *                     else:
 */
              __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(((PyObject *)__pyx_t_8));
              if (PyObject_SetItem(__pyx_v_crv, __pyx_v_i, ((PyObject *)__pyx_t_8)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;

              /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":384
 *                                 ep = (n.pt[2][0], n.pt[2][1])
 *                                 crv[i] = []
 *                                 crv[i].append([sp, cp, ep])             # <<<<<<<<<<<<<<
 *                     else:
 *                         e = el
 */
              __pyx_1 = PyObject_GetItem(__pyx_v_crv, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_1);
              __pyx_t_8 = PyList_New(3); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(((PyObject *)__pyx_t_8));
              __Pyx_INCREF(__pyx_v_sp);
              PyList_SET_ITEM(__pyx_t_8, 0, __pyx_v_sp);
              __Pyx_GIVEREF(__pyx_v_sp);
              __Pyx_INCREF(__pyx_v_cp);
              PyList_SET_ITEM(__pyx_t_8, 1, __pyx_v_cp);
              __Pyx_GIVEREF(__pyx_v_cp);
              __Pyx_INCREF(__pyx_v_ep);
              PyList_SET_ITEM(__pyx_t_8, 2, __pyx_v_ep);
              __Pyx_GIVEREF(__pyx_v_ep);
              __pyx_t_5 = __Pyx_PyObject_Append(__pyx_1, ((PyObject *)__pyx_t_8)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
              __Pyx_GOTREF(__pyx_t_5);
              __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
              __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
              __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
              goto __pyx_L12;
            }
            __pyx_L12:;
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L9;
        }
        /*else*/ {

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":386
 *                                 crv[i].append([sp, cp, ep])
 *                     else:
 *                         e = el             # <<<<<<<<<<<<<<
 *                         tp = transform(e.thisptr)
 *                         vec = c2numpy_double(<double *>tp, 2*5)
 */
          if (!(__Pyx_TypeTest(__pyx_v_el, __pyx_ptype_8hermes2d_9_hermes2d_Element))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_INCREF(__pyx_v_el);
          __Pyx_DECREF(((PyObject *)__pyx_v_e));
          __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_v_el);

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":387
 *                     else:
 *                         e = el
 *                         tp = transform(e.thisptr)             # <<<<<<<<<<<<<<
 *                         vec = c2numpy_double(<double *>tp, 2*5)
 *                         crv[i] = []
 */
          __pyx_v_tp = transform(__pyx_v_e->thisptr);

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":388
 *                         e = el
 *                         tp = transform(e.thisptr)
 *                         vec = c2numpy_double(<double *>tp, 2*5)             # <<<<<<<<<<<<<<
 *                         crv[i] = []
 *                         x = []
 */
          __pyx_t_2 = c2numpy_double(((double *)__pyx_v_tp), 10); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_2);
          if (!(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(((PyObject *)__pyx_v_vec));
          __pyx_v_vec = ((PyArrayObject *)__pyx_t_2);
          __pyx_t_2 = 0;

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":389
 *                         tp = transform(e.thisptr)
 *                         vec = c2numpy_double(<double *>tp, 2*5)
 *                         crv[i] = []             # <<<<<<<<<<<<<<
 *                         x = []
 *                         for point in vec.reshape((5, 2)):
 */
          __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_2));
          if (PyObject_SetItem(__pyx_v_crv, __pyx_v_i, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":390
 *                         vec = c2numpy_double(<double *>tp, 2*5)
 *                         crv[i] = []
 *                         x = []             # <<<<<<<<<<<<<<
 *                         for point in vec.reshape((5, 2)):
 *                             x.append((point[0], point[1]))
 */
          __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_2));
          __Pyx_DECREF(__pyx_v_x);
          __pyx_v_x = ((PyObject *)__pyx_t_2);
          __pyx_t_2 = 0;

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":391
 *                         crv[i] = []
 *                         x = []
 *                         for point in vec.reshape((5, 2)):             # <<<<<<<<<<<<<<
 *                             x.append((point[0], point[1]))
 *                         crv[i].append(x)
 */
          __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_5));
          __Pyx_INCREF(__pyx_int_5);
          PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_int_5);
          __Pyx_GIVEREF(__pyx_int_5);
          __Pyx_INCREF(__pyx_int_2);
          PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_2);
          __Pyx_GIVEREF(__pyx_int_2);
          __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_8));
          PyTuple_SET_ITEM(__pyx_t_8, 0, ((PyObject *)__pyx_t_5));
          __Pyx_GIVEREF(((PyObject *)__pyx_t_5));
          __pyx_t_5 = 0;
          __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
          if (PyList_CheckExact(__pyx_t_5) || PyTuple_CheckExact(__pyx_t_5)) {
            __pyx_t_7 = 0; __pyx_t_8 = __pyx_t_5; __Pyx_INCREF(__pyx_t_8);
          } else {
            __pyx_t_7 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          for (;;) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_8)) break;
              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++;
            } else if (likely(PyTuple_CheckExact(__pyx_t_8))) {
              if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++;
            } else {
              __pyx_t_5 = PyIter_Next(__pyx_t_8);
              if (!__pyx_t_5) {
                if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
                break;
              }
              __Pyx_GOTREF(__pyx_t_5);
            }
            __Pyx_DECREF(__pyx_v_point);
            __pyx_v_point = __pyx_t_5;
            __pyx_t_5 = 0;

            /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":392
 *                         x = []
 *                         for point in vec.reshape((5, 2)):
 *                             x.append((point[0], point[1]))             # <<<<<<<<<<<<<<
 *                         crv[i].append(x)
 *         print crv
 */
            __pyx_2 = __Pyx_GetItemInt(__pyx_v_point, 0, sizeof(long), PyInt_FromLong); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_2);
            __pyx_3 = __Pyx_GetItemInt(__pyx_v_point, 1, sizeof(long), PyInt_FromLong); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_3);
            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(((PyObject *)__pyx_t_5));
            PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_2);
            __Pyx_GIVEREF(__pyx_2);
            PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_3);
            __Pyx_GIVEREF(__pyx_3);
            __pyx_2 = 0;
            __pyx_3 = 0;
            __pyx_t_2 = __Pyx_PyObject_Append(__pyx_v_x, ((PyObject *)__pyx_t_5)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          }
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":393
 *                         for point in vec.reshape((5, 2)):
 *                             x.append((point[0], point[1]))
 *                         crv[i].append(x)             # <<<<<<<<<<<<<<
 *         print crv
 *         return crv
 */
          __pyx_1 = PyObject_GetItem(__pyx_v_crv, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_1);
          __pyx_t_8 = __Pyx_PyObject_Append(__pyx_1, __pyx_v_x); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_L9:;
        goto __pyx_L8;
      }
      __pyx_L8:;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":394
 *                             x.append((point[0], point[1]))
 *                         crv[i].append(x)
 *         print crv             # <<<<<<<<<<<<<<
 *         return crv
 * 
 */
  if (__Pyx_PrintOne(__pyx_v_crv) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":395
 *                         crv[i].append(x)
 *         print crv
 *         return crv             # <<<<<<<<<<<<<<
 * 
 *     def get_polygonal_boundary(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_crv);
  __pyx_r = __pyx_v_crv;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.curves");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_e);
  __Pyx_DECREF((PyObject *)__pyx_v_vec);
  __Pyx_DECREF(__pyx_v_crv);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_DECREF(__pyx_v_cm);
  __Pyx_DECREF(__pyx_v_j);
  __Pyx_DECREF(__pyx_v_n);
  __Pyx_DECREF(__pyx_v_sp);
  __Pyx_DECREF(__pyx_v_cp);
  __Pyx_DECREF(__pyx_v_ep);
  __Pyx_DECREF(__pyx_v_x);
  __Pyx_DECREF(__pyx_v_point);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":397
 *         return crv
 * 
 *     def get_polygonal_boundary(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the polygonal approximation of boundaries of all elements.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_polygonal_boundary(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_get_polygonal_boundary[] = "\n        Return the polygonal approximation of boundaries of all elements.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_polygonal_boundary(PyObject *__pyx_v_self, PyObject *unused) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Element *__pyx_v_e;
  double2 *__pyx_v_tp;
  int __pyx_v_npoints;
  PyArrayObject *__pyx_v_vec;
  PyObject *__pyx_v_crv;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("get_polygonal_boundary");
  __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_vec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_crv = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":406
 *         cdef ndarray vec
 * 
 *         crv = {}             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             e = self.get_element(i)
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __Pyx_DECREF(__pyx_v_crv);
  __pyx_v_crv = ((PyObject *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":407
 * 
 *         crv = {}
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             e = self.get_element(i)
 *             if e.active:
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":408
 *         crv = {}
 *         for i in range(self.num_elements):
 *             e = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if e.active:
 *                 element_polygonal_boundary(e.thisptr, &tp, &npoints)
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    if (!(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_8hermes2d_9_hermes2d_Element))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_v_e));
    __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_t_5);
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":409
 *         for i in range(self.num_elements):
 *             e = self.get_element(i)
 *             if e.active:             # <<<<<<<<<<<<<<
 *                 element_polygonal_boundary(e.thisptr, &tp, &npoints)
 *                 vec = c2numpy_double(<double *>tp, 2*npoints)
 */
    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_e), __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":410
 *             e = self.get_element(i)
 *             if e.active:
 *                 element_polygonal_boundary(e.thisptr, &tp, &npoints)             # <<<<<<<<<<<<<<
 *                 vec = c2numpy_double(<double *>tp, 2*npoints)
 *                 crv[e.id] = vec.reshape((npoints, 2))
 */
      element_polygonal_boundary(__pyx_v_e->thisptr, (&__pyx_v_tp), (&__pyx_v_npoints));

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":411
 *             if e.active:
 *                 element_polygonal_boundary(e.thisptr, &tp, &npoints)
 *                 vec = c2numpy_double(<double *>tp, 2*npoints)             # <<<<<<<<<<<<<<
 *                 crv[e.id] = vec.reshape((npoints, 2))
 *         return crv
 */
      __pyx_t_5 = c2numpy_double(((double *)__pyx_v_tp), (2 * __pyx_v_npoints)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      if (!(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_vec));
      __pyx_v_vec = ((PyArrayObject *)__pyx_t_5);
      __pyx_t_5 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":412
 *                 element_polygonal_boundary(e.thisptr, &tp, &npoints)
 *                 vec = c2numpy_double(<double *>tp, 2*npoints)
 *                 crv[e.id] = vec.reshape((npoints, 2))             # <<<<<<<<<<<<<<
 *         return crv
 * 
 */
      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyInt_FromLong(__pyx_v_npoints); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_2));
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_int_2);
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_2);
      __Pyx_GIVEREF(__pyx_int_2);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_t_2));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
      __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_e), __pyx_kp_id); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      if (PyObject_SetItem(__pyx_v_crv, __pyx_t_4, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":413
 *                 vec = c2numpy_double(<double *>tp, 2*npoints)
 *                 crv[e.id] = vec.reshape((npoints, 2))
 *         return crv             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_crv);
  __pyx_r = __pyx_v_crv;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.get_polygonal_boundary");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_e);
  __Pyx_DECREF((PyObject *)__pyx_v_vec);
  __Pyx_DECREF(__pyx_v_crv);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":416
 * 
 *     @property
 *     def num_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_elements()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("num_elements");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":417
 *     @property
 *     def num_elements(self):
 *         return self.thisptr.get_num_elements()             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->get_num_elements()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.num_elements");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":420
 * 
 *     @property
 *     def num_base_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_base_elements()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_base_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_base_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("num_base_elements");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":421
 *     @property
 *     def num_base_elements(self):
 *         return self.thisptr.get_num_base_elements()             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->get_num_base_elements()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.num_base_elements");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":424
 * 
 *     @property
 *     def num_active_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_active_elements()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_active_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_active_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("num_active_elements");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":425
 *     @property
 *     def num_active_elements(self):
 *         return self.thisptr.get_num_active_elements()             # <<<<<<<<<<<<<<
 * 
 *     @property
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->get_num_active_elements()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.num_active_elements");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":428
 * 
 *     @property
 *     def max_element_id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_max_element_id()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_max_element_id(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_max_element_id(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("max_element_id");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":429
 *     @property
 *     def max_element_id(self):
 *         return self.thisptr.get_max_element_id()             # <<<<<<<<<<<<<<
 * 
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->get_max_element_id()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.max_element_id");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":431
 *         return self.thisptr.get_max_element_id()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         return "Mesh with %d elements: active=%d, base=%d, max_id=%d" % \
 *                 (self.num_elements, self.num_active_elements,
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh___str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh___str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  __Pyx_SetupRefcountContext("__str__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":432
 * 
 *     def __str__(self):
 *         return "Mesh with %d elements: active=%d, base=%d, max_id=%d" % \             # <<<<<<<<<<<<<<
 *                 (self.num_elements, self.num_active_elements,
 *                         self.num_base_elements, self.max_element_id)
 */
  __Pyx_XDECREF(__pyx_r);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":433
 *     def __str__(self):
 *         return "Mesh with %d elements: active=%d, base=%d, max_id=%d" % \
 *                 (self.num_elements, self.num_active_elements,             # <<<<<<<<<<<<<<
 *                         self.num_base_elements, self.max_element_id)
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_active_elements); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":434
 *         return "Mesh with %d elements: active=%d, base=%d, max_id=%d" % \
 *                 (self.num_elements, self.num_active_elements,
 *                         self.num_base_elements, self.max_element_id)             # <<<<<<<<<<<<<<
 * 
 *     def load_hermes(self, char* filename):
 */
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_base_elements); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_max_element_id); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Remainder(__pyx_kp_49, ((PyObject *)__pyx_t_5)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.__str__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":436
 *                         self.num_base_elements, self.max_element_id)
 * 
 *     def load_hermes(self, char* filename):             # <<<<<<<<<<<<<<
 *         """
 *         Loads a mesh (in the hermes format) from a file.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_hermes(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_load_hermes[] = "\n        Loads a mesh (in the hermes format) from a file.\n\n        This uses a pure Python reader. If you want to use the C++ flex reader,\n        use load().\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_hermes(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename) {
  char *__pyx_v_filename;
  PyObject *__pyx_v_read_hermes_format;
  PyObject *__pyx_v_nodes;
  PyObject *__pyx_v_elements;
  PyObject *__pyx_v_boundary;
  PyObject *__pyx_v_nurbs;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("load_hermes");
  assert(__pyx_arg_filename); {
    __pyx_v_filename = __Pyx_PyBytes_AsString(__pyx_arg_filename); if (unlikely((!__pyx_v_filename) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.load_hermes");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_read_hermes_format = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_nodes = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_elements = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_boundary = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_nurbs = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":443
 *         use load().
 *         """
 *         from mesh import read_hermes_format             # <<<<<<<<<<<<<<
 *         nodes, elements, boundary, nurbs = \
 *                 read_hermes_format(filename)
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_kp_read_hermes_format);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_read_hermes_format);
  __Pyx_GIVEREF(__pyx_kp_read_hermes_format);
  __pyx_1 = __Pyx_Import(__pyx_kp_mesh, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_read_hermes_format); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __Pyx_DECREF(__pyx_v_read_hermes_format);
  __pyx_v_read_hermes_format = __pyx_2;
  __pyx_2 = 0;
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":445
 *         from mesh import read_hermes_format
 *         nodes, elements, boundary, nurbs = \
 *                 read_hermes_format(filename)             # <<<<<<<<<<<<<<
 *         self.create(nodes, elements, boundary, nurbs)
 * 
 */
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_filename); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_v_read_hermes_format, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyTuple_CheckExact(__pyx_t_1) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 4)) {
    PyObject* tuple = __pyx_t_1;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
    __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
    __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
    __pyx_5 = PyTuple_GET_ITEM(tuple, 3); __Pyx_INCREF(__pyx_5);

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":444
 *         """
 *         from mesh import read_hermes_format
 *         nodes, elements, boundary, nurbs = \             # <<<<<<<<<<<<<<
 *                 read_hermes_format(filename)
 *         self.create(nodes, elements, boundary, nurbs)
 */
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_v_nodes);
    __pyx_v_nodes = __pyx_2;
    __pyx_2 = 0;
    __Pyx_DECREF(__pyx_v_elements);
    __pyx_v_elements = __pyx_3;
    __pyx_3 = 0;
    __Pyx_DECREF(__pyx_v_boundary);
    __pyx_v_boundary = __pyx_4;
    __pyx_4 = 0;
    __Pyx_DECREF(__pyx_v_nurbs);
    __pyx_v_nurbs = __pyx_5;
    __pyx_5 = 0;
  } else {
    __pyx_1 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_2);
    __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_3);
    __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_4);
    __pyx_5 = __Pyx_UnpackItem(__pyx_1, 3); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_5);
    if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_DECREF(__pyx_v_nodes);
    __pyx_v_nodes = __pyx_2;
    __pyx_2 = 0;
    __Pyx_DECREF(__pyx_v_elements);
    __pyx_v_elements = __pyx_3;
    __pyx_3 = 0;
    __Pyx_DECREF(__pyx_v_boundary);
    __pyx_v_boundary = __pyx_4;
    __pyx_4 = 0;
    __Pyx_DECREF(__pyx_v_nurbs);
    __pyx_v_nurbs = __pyx_5;
    __pyx_5 = 0;
  }

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":446
 *         nodes, elements, boundary, nurbs = \
 *                 read_hermes_format(filename)
 *         self.create(nodes, elements, boundary, nurbs)             # <<<<<<<<<<<<<<
 * 
 *     def get_elements_order(self, space):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_create); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_nodes);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_nodes);
  __Pyx_GIVEREF(__pyx_v_nodes);
  __Pyx_INCREF(__pyx_v_elements);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_elements);
  __Pyx_GIVEREF(__pyx_v_elements);
  __Pyx_INCREF(__pyx_v_boundary);
  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_boundary);
  __Pyx_GIVEREF(__pyx_v_boundary);
  __Pyx_INCREF(__pyx_v_nurbs);
  PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_nurbs);
  __Pyx_GIVEREF(__pyx_v_nurbs);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_4);
  __Pyx_XDECREF(__pyx_5);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.load_hermes");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_read_hermes_format);
  __Pyx_DECREF(__pyx_v_nodes);
  __Pyx_DECREF(__pyx_v_elements);
  __Pyx_DECREF(__pyx_v_boundary);
  __Pyx_DECREF(__pyx_v_nurbs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":448
 *         self.create(nodes, elements, boundary, nurbs)
 * 
 *     def get_elements_order(self, space):             # <<<<<<<<<<<<<<
 *         """
 *         Returns list of orders
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_elements_order(PyObject *__pyx_v_self, PyObject *__pyx_v_space); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_get_elements_order[] = "\n        Returns list of orders\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_elements_order(PyObject *__pyx_v_self, PyObject *__pyx_v_space) {
  PyObject *__pyx_v_orders_list;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_el;
  PyObject *__pyx_v_order;
  PyObject *__pyx_v_h;
  PyObject *__pyx_v_v;
  PyObject *__pyx_v_math;
  PyObject *__pyx_v_ord;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  __Pyx_SetupRefcountContext("get_elements_order");
  __pyx_v_orders_list = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_order = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_h = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_v = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_math = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_ord = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":452
 *         Returns list of orders
 *         """
 *         orders_list = {}             # <<<<<<<<<<<<<<
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __Pyx_DECREF(__pyx_v_orders_list);
  __pyx_v_orders_list = ((PyObject *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":453
 *         """
 *         orders_list = {}
 *         for i in range(self.num_elements):             # <<<<<<<<<<<<<<
 *             el = self.get_element(i)
 *             if el.active:
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_num_elements); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":454
 *         orders_list = {}
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)             # <<<<<<<<<<<<<<
 *             if el.active:
 *                 order = space.get_element_order(i)
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_element); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":455
 *         for i in range(self.num_elements):
 *             el = self.get_element(i)
 *             if el.active:             # <<<<<<<<<<<<<<
 *                 order = space.get_element_order(i)
 *                 h = order & ((1 << 5) - 1)
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_active); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":456
 *             el = self.get_element(i)
 *             if el.active:
 *                 order = space.get_element_order(i)             # <<<<<<<<<<<<<<
 *                 h = order & ((1 << 5) - 1)
 *                 v = order >> 5
 */
      __pyx_t_5 = PyObject_GetAttr(__pyx_v_space, __pyx_kp_get_element_order); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_INCREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      __pyx_t_2 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_order);
      __pyx_v_order = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":457
 *             if el.active:
 *                 order = space.get_element_order(i)
 *                 h = order & ((1 << 5) - 1)             # <<<<<<<<<<<<<<
 *                 v = order >> 5
 * 
 */
      __pyx_t_2 = PyInt_FromLong(31); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyNumber_And(__pyx_v_order, __pyx_t_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_v_h);
      __pyx_v_h = __pyx_t_4;
      __pyx_t_4 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":458
 *                 order = space.get_element_order(i)
 *                 h = order & ((1 << 5) - 1)
 *                 v = order >> 5             # <<<<<<<<<<<<<<
 * 
 *                 import math
 */
      __pyx_t_4 = PyNumber_Rshift(__pyx_v_order, __pyx_int_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_v_v);
      __pyx_v_v = __pyx_t_4;
      __pyx_t_4 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":460
 *                 v = order >> 5
 * 
 *                 import math             # <<<<<<<<<<<<<<
 *                 # This uses the maximum of "h", "v", as we can't yet plot
 *                 # anisotropic polynomial degrees
 */
      __pyx_1 = __Pyx_Import(__pyx_kp_math, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __Pyx_DECREF(__pyx_v_math);
      __pyx_v_math = __pyx_1;
      __pyx_1 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":463
 *                 # This uses the maximum of "h", "v", as we can't yet plot
 *                 # anisotropic polynomial degrees
 *                 ord = max(h, v)             # <<<<<<<<<<<<<<
 *                 #ord = int(((h+v)/2.0))
 *                 if ord == 0:
 */
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_INCREF(__pyx_v_h);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_h);
      __Pyx_GIVEREF(__pyx_v_h);
      __Pyx_INCREF(__pyx_v_v);
      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_v);
      __Pyx_GIVEREF(__pyx_v_v);
      __pyx_t_2 = PyObject_Call(__pyx_builtin_max, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_ord);
      __pyx_v_ord = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":465
 *                 ord = max(h, v)
 *                 #ord = int(((h+v)/2.0))
 *                 if ord == 0:             # <<<<<<<<<<<<<<
 *                     ord = 1
 * 
 */
      __pyx_t_2 = PyObject_RichCompare(__pyx_v_ord, __pyx_int_0, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_6) {

        /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":466
 *                 #ord = int(((h+v)/2.0))
 *                 if ord == 0:
 *                     ord = 1             # <<<<<<<<<<<<<<
 * 
 *                 #orders_list.append(int(((h+v)/2.0)))
 */
        __Pyx_INCREF(__pyx_int_1);
        __Pyx_DECREF(__pyx_v_ord);
        __pyx_v_ord = __pyx_int_1;
        goto __pyx_L8;
      }
      __pyx_L8:;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":469
 * 
 *                 #orders_list.append(int(((h+v)/2.0)))
 *                 orders_list[el.id] = ord             # <<<<<<<<<<<<<<
 * 
 *         return orders_list
 */
      __pyx_t_2 = PyObject_GetAttr(__pyx_v_el, __pyx_kp_id); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      if (PyObject_SetItem(__pyx_v_orders_list, __pyx_t_2, __pyx_v_ord) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":471
 *                 orders_list[el.id] = ord
 * 
 *         return orders_list             # <<<<<<<<<<<<<<
 * 
 *     def create(self, nodes, elements, boundary, nurbs):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_orders_list);
  __pyx_r = __pyx_v_orders_list;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.get_elements_order");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_orders_list);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_DECREF(__pyx_v_order);
  __Pyx_DECREF(__pyx_v_h);
  __Pyx_DECREF(__pyx_v_v);
  __Pyx_DECREF(__pyx_v_math);
  __Pyx_DECREF(__pyx_v_ord);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":473
 *         return orders_list
 * 
 *     def create(self, nodes, elements, boundary, nurbs):             # <<<<<<<<<<<<<<
 *         """
 *         Creates a mesh from a list of nodes, elements, boundaries and nurbs.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_create(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_create[] = "\n        Creates a mesh from a list of nodes, elements, boundaries and nurbs.\n\n        Example:\n\n        >>> import hermes2d\n        >>> m = hermes2d.Mesh()\n        >>> m.create([\n        ...         [0, -1],\n        ...         [1, -1],\n        ...         [-1, 0],\n        ...         [0, 0],\n        ...         [1, 0],\n        ...         [-1, 1],\n        ...         [0, 1],\n        ...         [0.707106781, 0.707106781],\n        ...     ], [\n        ...         [0, 1, 4, 3, 0],\n        ...         [3, 4, 7, 0],\n        ...         [3, 7, 6, 0],\n        ...         [2, 3, 6, 5, 0],\n        ...     ], [\n        ...         [0, 1, 1],\n        ...         [1, 4, 2],\n        ...         [3, 0, 4],\n        ...         [4, 7, 2],\n        ...         [7, 6, 2],\n        ...         [2, 3, 4],\n        ...         [6, 5, 2],\n        ...         [5, 2, 3],\n        ...     ], [\n        ...         [4, 7, 45],\n        ...         [7, 6, 45],\n        ...     ])\n\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_create(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_nodes = 0;
  PyObject *__pyx_v_elements = 0;
  PyObject *__pyx_v_boundary = 0;
  PyObject *__pyx_v_nurbs = 0;
  PyObject *__pyx_v_m;
  PyObject *__pyx_v_node;
  PyObject *__pyx_v_el;
  PyObject *__pyx_v_b;
  PyObject *__pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_nodes,&__pyx_kp_elements,&__pyx_kp_boundary,&__pyx_kp_nurbs,0};
  __Pyx_SetupRefcountContext("create");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_nodes);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_elements);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("create", 1, 4, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_boundary);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("create", 1, 4, 4, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_nurbs);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("create", 1, 4, 4, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "create") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_nodes = values[0];
    __pyx_v_elements = values[1];
    __pyx_v_boundary = values[2];
    __pyx_v_nurbs = values[3];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_nodes = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_elements = PyTuple_GET_ITEM(__pyx_args, 1);
    __pyx_v_boundary = PyTuple_GET_ITEM(__pyx_args, 2);
    __pyx_v_nurbs = PyTuple_GET_ITEM(__pyx_args, 3);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.create");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF(__pyx_v_boundary);
  __Pyx_INCREF(__pyx_v_nurbs);
  __pyx_v_m = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_node = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_el = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_b = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_n = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":510
 * 
 *         """
 *         if boundary is None:             # <<<<<<<<<<<<<<
 *             boundary = []
 *         if nurbs is None:
 */
  __pyx_t_1 = (__pyx_v_boundary == Py_None);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":511
 *         """
 *         if boundary is None:
 *             boundary = []             # <<<<<<<<<<<<<<
 *         if nurbs is None:
 *             nurbs = []
 */
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_DECREF(__pyx_v_boundary);
    __pyx_v_boundary = ((PyObject *)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":512
 *         if boundary is None:
 *             boundary = []
 *         if nurbs is None:             # <<<<<<<<<<<<<<
 *             nurbs = []
 *         m = "1 0\n"
 */
  __pyx_t_1 = (__pyx_v_nurbs == Py_None);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":513
 *             boundary = []
 *         if nurbs is None:
 *             nurbs = []             # <<<<<<<<<<<<<<
 *         m = "1 0\n"
 *         m += "%d\n" % len(nodes)
 */
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_DECREF(__pyx_v_nurbs);
    __pyx_v_nurbs = ((PyObject *)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":514
 *         if nurbs is None:
 *             nurbs = []
 *         m = "1 0\n"             # <<<<<<<<<<<<<<
 *         m += "%d\n" % len(nodes)
 *         for node in nodes:
 */
  __Pyx_INCREF(__pyx_kp_50);
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_kp_50;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":515
 *             nurbs = []
 *         m = "1 0\n"
 *         m += "%d\n" % len(nodes)             # <<<<<<<<<<<<<<
 *         for node in nodes:
 *             m += "%f %f\n" % tuple(node)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_nodes); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyNumber_Remainder(__pyx_kp_51, __pyx_t_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":516
 *         m = "1 0\n"
 *         m += "%d\n" % len(nodes)
 *         for node in nodes:             # <<<<<<<<<<<<<<
 *             m += "%f %f\n" % tuple(node)
 *         m += "%d\n" % len(elements)
 */
  if (PyList_CheckExact(__pyx_v_nodes) || PyTuple_CheckExact(__pyx_v_nodes)) {
    __pyx_t_3 = 0; __pyx_t_4 = __pyx_v_nodes; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_3 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_nodes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_v_node);
    __pyx_v_node = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":517
 *         m += "%d\n" % len(nodes)
 *         for node in nodes:
 *             m += "%f %f\n" % tuple(node)             # <<<<<<<<<<<<<<
 *         m += "%d\n" % len(elements)
 *         for el in elements:
 */
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_v_node);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_node);
    __Pyx_GIVEREF(__pyx_v_node);
    __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)&PyTuple_Type)), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Remainder(__pyx_kp_52, __pyx_t_5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_m);
    __pyx_v_m = __pyx_1;
    __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":518
 *         for node in nodes:
 *             m += "%f %f\n" % tuple(node)
 *         m += "%d\n" % len(elements)             # <<<<<<<<<<<<<<
 *         for el in elements:
 *             m += ("%d "*len(el)) % tuple(el)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_elements); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyNumber_Remainder(__pyx_kp_53, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":519
 *             m += "%f %f\n" % tuple(node)
 *         m += "%d\n" % len(elements)
 *         for el in elements:             # <<<<<<<<<<<<<<
 *             m += ("%d "*len(el)) % tuple(el)
 *             m += "\n"
 */
  if (PyList_CheckExact(__pyx_v_elements) || PyTuple_CheckExact(__pyx_v_elements)) {
    __pyx_t_3 = 0; __pyx_t_2 = __pyx_v_elements; __Pyx_INCREF(__pyx_t_2);
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_elements); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++;
    } else {
      __pyx_t_4 = PyIter_Next(__pyx_t_2);
      if (!__pyx_t_4) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_v_el);
    __pyx_v_el = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":520
 *         m += "%d\n" % len(elements)
 *         for el in elements:
 *             m += ("%d "*len(el)) % tuple(el)             # <<<<<<<<<<<<<<
 *             m += "\n"
 *         m += "%d\n" % len(boundary)
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_el); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyNumber_Multiply(__pyx_kp_54, __pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_el);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_el);
    __Pyx_GIVEREF(__pyx_v_el);
    __pyx_t_7 = PyObject_Call(((PyObject *)((PyObject*)&PyTuple_Type)), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Remainder(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_m);
    __pyx_v_m = __pyx_1;
    __pyx_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":521
 *         for el in elements:
 *             m += ("%d "*len(el)) % tuple(el)
 *             m += "\n"             # <<<<<<<<<<<<<<
 *         m += "%d\n" % len(boundary)
 *         for b in boundary:
 */
    __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_kp_55); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_v_m);
    __pyx_v_m = __pyx_1;
    __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":522
 *             m += ("%d "*len(el)) % tuple(el)
 *             m += "\n"
 *         m += "%d\n" % len(boundary)             # <<<<<<<<<<<<<<
 *         for b in boundary:
 *             m += "%d %d %d\n" % tuple(b)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_boundary); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyNumber_Remainder(__pyx_kp_56, __pyx_t_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":523
 *             m += "\n"
 *         m += "%d\n" % len(boundary)
 *         for b in boundary:             # <<<<<<<<<<<<<<
 *             m += "%d %d %d\n" % tuple(b)
 *         m += "%d\n" % len(nurbs)
 */
  if (PyList_CheckExact(__pyx_v_boundary) || PyTuple_CheckExact(__pyx_v_boundary)) {
    __pyx_t_3 = 0; __pyx_t_4 = __pyx_v_boundary; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_3 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_boundary); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_v_b);
    __pyx_v_b = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":524
 *         m += "%d\n" % len(boundary)
 *         for b in boundary:
 *             m += "%d %d %d\n" % tuple(b)             # <<<<<<<<<<<<<<
 *         m += "%d\n" % len(nurbs)
 *         for n in nurbs:
 */
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_v_b);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_b);
    __Pyx_GIVEREF(__pyx_v_b);
    __pyx_t_7 = PyObject_Call(((PyObject *)((PyObject*)&PyTuple_Type)), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Remainder(__pyx_kp_57, __pyx_t_7); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_m);
    __pyx_v_m = __pyx_1;
    __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":525
 *         for b in boundary:
 *             m += "%d %d %d\n" % tuple(b)
 *         m += "%d\n" % len(nurbs)             # <<<<<<<<<<<<<<
 *         for n in nurbs:
 *             m += "%d %d\n0\n%f\n" % tuple(n)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_nurbs); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyNumber_Remainder(__pyx_kp_58, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":526
 *             m += "%d %d %d\n" % tuple(b)
 *         m += "%d\n" % len(nurbs)
 *         for n in nurbs:             # <<<<<<<<<<<<<<
 *             m += "%d %d\n0\n%f\n" % tuple(n)
 *         m += "0\n"
 */
  if (PyList_CheckExact(__pyx_v_nurbs) || PyTuple_CheckExact(__pyx_v_nurbs)) {
    __pyx_t_3 = 0; __pyx_t_2 = __pyx_v_nurbs; __Pyx_INCREF(__pyx_t_2);
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_nurbs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++;
    } else {
      __pyx_t_4 = PyIter_Next(__pyx_t_2);
      if (!__pyx_t_4) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_v_n);
    __pyx_v_n = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":527
 *         m += "%d\n" % len(nurbs)
 *         for n in nurbs:
 *             m += "%d %d\n0\n%f\n" % tuple(n)             # <<<<<<<<<<<<<<
 *         m += "0\n"
 *         self.load_str(m)
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_n);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_n);
    __Pyx_GIVEREF(__pyx_v_n);
    __pyx_t_7 = PyObject_Call(((PyObject *)((PyObject*)&PyTuple_Type)), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Remainder(__pyx_kp_59, __pyx_t_7); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_m);
    __pyx_v_m = __pyx_1;
    __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":528
 *         for n in nurbs:
 *             m += "%d %d\n0\n%f\n" % tuple(n)
 *         m += "0\n"             # <<<<<<<<<<<<<<
 *         self.load_str(m)
 * 
 */
  __pyx_1 = PyNumber_InPlaceAdd(__pyx_v_m, __pyx_kp_60); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":529
 *             m += "%d %d\n0\n%f\n" % tuple(n)
 *         m += "0\n"
 *         self.load_str(m)             # <<<<<<<<<<<<<<
 * 
 *     def save(self, char* filename):
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_load_str); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  __Pyx_INCREF(__pyx_v_m);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_m);
  __Pyx_GIVEREF(__pyx_v_m);
  __pyx_t_7 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.create");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_m);
  __Pyx_DECREF(__pyx_v_node);
  __Pyx_DECREF(__pyx_v_el);
  __Pyx_DECREF(__pyx_v_b);
  __Pyx_DECREF(__pyx_v_n);
  __Pyx_DECREF(__pyx_v_boundary);
  __Pyx_DECREF(__pyx_v_nurbs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":531
 *         self.load_str(m)
 * 
 *     def save(self, char* filename):             # <<<<<<<<<<<<<<
 *         self.thisptr.save(filename)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_save(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_save(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename) {
  char *__pyx_v_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("save");
  assert(__pyx_arg_filename); {
    __pyx_v_filename = __Pyx_PyBytes_AsString(__pyx_arg_filename); if (unlikely((!__pyx_v_filename) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.save");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":532
 * 
 *     def save(self, char* filename):
 *         self.thisptr.save(filename)             # <<<<<<<<<<<<<<
 * 
 *     def refine_element(self, int id, int refinement=0):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->save(__pyx_v_filename);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":534
 *         self.thisptr.save(filename)
 * 
 *     def refine_element(self, int id, int refinement=0):             # <<<<<<<<<<<<<<
 *         self.thisptr.refine_element(id, refinement)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_element(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_element(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_id;
  int __pyx_v_refinement;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_id,&__pyx_kp_refinement,0};
  __Pyx_SetupRefcountContext("refine_element");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_id);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_refinement);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "refine_element") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_id = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[1]) {
      __pyx_v_refinement = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_refinement == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_refinement = 0;
    }
  } else {
    __pyx_v_refinement = 0;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_refinement = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_refinement == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_id = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("refine_element", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.refine_element");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":535
 * 
 *     def refine_element(self, int id, int refinement=0):
 *         self.thisptr.refine_element(id, refinement)             # <<<<<<<<<<<<<<
 * 
 *     def refine_all_elements(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->refine_element(__pyx_v_id, __pyx_v_refinement);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":537
 *         self.thisptr.refine_element(id, refinement)
 * 
 *     def refine_all_elements(self):             # <<<<<<<<<<<<<<
 *         self.thisptr.refine_all_elements()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_all_elements(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_all_elements(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("refine_all_elements");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":538
 * 
 *     def refine_all_elements(self):
 *         self.thisptr.refine_all_elements()             # <<<<<<<<<<<<<<
 * 
 *     def refine_towards_boundary(self, int marker, int depth):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->refine_all_elements();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":540
 *         self.thisptr.refine_all_elements()
 * 
 *     def refine_towards_boundary(self, int marker, int depth):             # <<<<<<<<<<<<<<
 *         self.thisptr.refine_towards_boundary(marker, depth)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_boundary(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_boundary(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_marker;
  int __pyx_v_depth;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_marker,&__pyx_kp_depth,0};
  __Pyx_SetupRefcountContext("refine_towards_boundary");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_marker);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_depth);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("refine_towards_boundary", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "refine_towards_boundary") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_marker = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_marker == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_depth = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_depth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_marker = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_marker == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_depth = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_depth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("refine_towards_boundary", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.refine_towards_boundary");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":541
 * 
 *     def refine_towards_boundary(self, int marker, int depth):
 *         self.thisptr.refine_towards_boundary(marker, depth)             # <<<<<<<<<<<<<<
 * 
 *     def refine_towards_vertex(self, int marker, int depth):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->refine_towards_boundary(__pyx_v_marker, __pyx_v_depth);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":543
 *         self.thisptr.refine_towards_boundary(marker, depth)
 * 
 *     def refine_towards_vertex(self, int marker, int depth):             # <<<<<<<<<<<<<<
 *         self.thisptr.refine_towards_vertex(marker, depth)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_vertex(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_vertex(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_marker;
  int __pyx_v_depth;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_marker,&__pyx_kp_depth,0};
  __Pyx_SetupRefcountContext("refine_towards_vertex");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_marker);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_depth);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("refine_towards_vertex", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "refine_towards_vertex") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_marker = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_marker == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_depth = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_depth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_marker = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_marker == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_depth = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_depth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("refine_towards_vertex", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.refine_towards_vertex");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":544
 * 
 *     def refine_towards_vertex(self, int marker, int depth):
 *         self.thisptr.refine_towards_vertex(marker, depth)             # <<<<<<<<<<<<<<
 * 
 *     def get_element(self, int id):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->refine_towards_vertex(__pyx_v_marker, __pyx_v_depth);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":546
 *         self.thisptr.refine_towards_vertex(marker, depth)
 * 
 *     def get_element(self, int id):             # <<<<<<<<<<<<<<
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.get_element(id)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_element(PyObject *__pyx_v_self, PyObject *__pyx_arg_id); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_element(PyObject *__pyx_v_self, PyObject *__pyx_arg_id) {
  int __pyx_v_id;
  struct __pyx_obj_8hermes2d_9_hermes2d_Element *__pyx_v_e = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_element");
  assert(__pyx_arg_id); {
    __pyx_v_id = __Pyx_PyInt_AsInt(__pyx_arg_id); if (unlikely((__pyx_v_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.get_element");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":547
 * 
 *     def get_element(self, int id):
 *         cdef Element e = Element()             # <<<<<<<<<<<<<<
 *         e.thisptr = self.thisptr.get_element(id)
 *         return e
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Element)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_Element))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_e = ((struct __pyx_obj_8hermes2d_9_hermes2d_Element *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":548
 *     def get_element(self, int id):
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.get_element(id)             # <<<<<<<<<<<<<<
 *         return e
 * 
 */
  __pyx_v_e->thisptr = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->get_element(__pyx_v_id);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":549
 *         cdef Element e = Element()
 *         e.thisptr = self.thisptr.get_element(id)
 *         return e             # <<<<<<<<<<<<<<
 * 
 *     def plot(self, *args, **kwargs):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_e));
  __pyx_r = ((PyObject *)__pyx_v_e);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.get_element");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_e);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":551
 *         return e
 * 
 *     def plot(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         """
 *         Plots the mesh and shows it to the user.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_plot[] = "\n        Plots the mesh and shows it to the user.\n\n        It passes all arguments to the MeshView.show() function, so read its\n        documentation for the meaning.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_v_MeshView;
  PyObject *__pyx_v_m;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("plot");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "plot", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_v_MeshView = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_m = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":558
 *         documentation for the meaning.
 *         """
 *         from hermes2d import MeshView             # <<<<<<<<<<<<<<
 *         m = MeshView()
 *         m.show(self, *args, **kwargs)
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_kp_MeshView);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_MeshView);
  __Pyx_GIVEREF(__pyx_kp_MeshView);
  __pyx_1 = __Pyx_Import(__pyx_kp_61, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_MeshView); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __Pyx_DECREF(__pyx_v_MeshView);
  __pyx_v_MeshView = __pyx_2;
  __pyx_2 = 0;
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":559
 *         """
 *         from hermes2d import MeshView
 *         m = MeshView()             # <<<<<<<<<<<<<<
 *         m.show(self, *args, **kwargs)
 * 
 */
  __pyx_t_1 = PyObject_Call(__pyx_v_MeshView, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":560
 *         from hermes2d import MeshView
 *         m = MeshView()
 *         m.show(self, *args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     def show(self, *args, **kwargs):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_m, __pyx_kp_show); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  __pyx_1 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_t_2), ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.plot");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_DECREF(__pyx_v_MeshView);
  __Pyx_DECREF(__pyx_v_m);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":562
 *         m.show(self, *args, **kwargs)
 * 
 *     def show(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         """
 *         Plots the mesh and shows it to the user.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_4Mesh_show[] = "\n        Plots the mesh and shows it to the user.\n\n        It passes all arguments to the MeshView.show() function, so read its\n        documentation for the meaning.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("show");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "show", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":569
 *         documentation for the meaning.
 *         """
 *         self.plot(*args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     def convert_triangles_to_quads(self):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_plot); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_1 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_1), __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":571
 *         self.plot(*args, **kwargs)
 * 
 *     def convert_triangles_to_quads(self):             # <<<<<<<<<<<<<<
 *         self.thisptr.convert_triangles_to_quads()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_triangles_to_quads(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_triangles_to_quads(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("convert_triangles_to_quads");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":572
 * 
 *     def convert_triangles_to_quads(self):
 *         self.thisptr.convert_triangles_to_quads()             # <<<<<<<<<<<<<<
 * 
 *     def convert_quads_to_triangles(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->convert_triangles_to_quads();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":574
 *         self.thisptr.convert_triangles_to_quads()
 * 
 *     def convert_quads_to_triangles(self):             # <<<<<<<<<<<<<<
 *         self.thisptr.convert_quads_to_triangles()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_quads_to_triangles(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_quads_to_triangles(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("convert_quads_to_triangles");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":575
 * 
 *     def convert_quads_to_triangles(self):
 *         self.thisptr.convert_quads_to_triangles()             # <<<<<<<<<<<<<<
 * 
 * cdef class H1Shapeset:
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_self)->thisptr->convert_quads_to_triangles();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":580
 *     cdef c_H1Shapeset *thisptr
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_H1Shapeset()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":581
 * 
 *     def __cinit__(self):
 *         self.thisptr = new_H1Shapeset()             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)__pyx_v_self)->thisptr = new H1Shapeset();

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":583
 *         self.thisptr = new_H1Shapeset()
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":584
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class L2Shapeset:
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":593
 *     cdef c_L2Shapeset *thisptr
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_L2Shapeset()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":594
 * 
 *     def __cinit__(self):
 *         self.thisptr = new_L2Shapeset()             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)__pyx_v_self)->thisptr = new L2Shapeset();

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":596
 *         self.thisptr = new_L2Shapeset()
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":597
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class PrecalcShapeset:
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":602
 *     cdef c_PrecalcShapeset *thisptr
 * 
 *     def __cinit__(self, H1Shapeset h):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_PrecalcShapeset(h.thisptr)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *__pyx_v_h = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_h,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_h);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_h = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)values[0]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_h = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)PyTuple_GET_ITEM(__pyx_args, 0));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.PrecalcShapeset.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h), __pyx_ptype_8hermes2d_9_hermes2d_H1Shapeset, 1, "h", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":603
 * 
 *     def __cinit__(self, H1Shapeset h):
 *         self.thisptr = new_PrecalcShapeset(h.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_v_self)->thisptr = new PrecalcShapeset(__pyx_v_h->thisptr);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.PrecalcShapeset.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":605
 *         self.thisptr = new_PrecalcShapeset(h.thisptr)
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":606
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class H1Space:
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":610
 * cdef class H1Space:
 * 
 *     def __init__(self, Mesh m):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_H1Space(m.thisptr)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_7H1Space___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_7H1Space___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *__pyx_v_m = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_m,0};
  __Pyx_SetupRefcountContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_m);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)values[0]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)PyTuple_GET_ITEM(__pyx_args, 0));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_m), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "m", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":611
 * 
 *     def __init__(self, Mesh m):
 *         self.thisptr = new_H1Space(m.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr = new H1Space(__pyx_v_m->thisptr);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":613
 *         self.thisptr = new_H1Space(m.thisptr)
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_7H1Space___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_7H1Space___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":614
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def set_uniform_order(self, int tri_order):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":616
 *         delete(self.thisptr)
 * 
 *     def set_uniform_order(self, int tri_order):             # <<<<<<<<<<<<<<
 *         self.thisptr.set_uniform_order(tri_order)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_set_uniform_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_tri_order); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_set_uniform_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_tri_order) {
  int __pyx_v_tri_order;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("set_uniform_order");
  assert(__pyx_arg_tri_order); {
    __pyx_v_tri_order = __Pyx_PyInt_AsInt(__pyx_arg_tri_order); if (unlikely((__pyx_v_tri_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.set_uniform_order");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":617
 * 
 *     def set_uniform_order(self, int tri_order):
 *         self.thisptr.set_uniform_order(tri_order)             # <<<<<<<<<<<<<<
 * 
 *     def assign_dofs(self, first_dof=0, stride=1):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr->set_uniform_order(__pyx_v_tri_order);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":619
 *         self.thisptr.set_uniform_order(tri_order)
 * 
 *     def assign_dofs(self, first_dof=0, stride=1):             # <<<<<<<<<<<<<<
 *         return self.thisptr.assign_dofs(first_dof, stride)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_assign_dofs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_assign_dofs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_first_dof = 0;
  PyObject *__pyx_v_stride = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_first_dof,&__pyx_kp_stride,0};
  __Pyx_SetupRefcountContext("assign_dofs");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[0] = __pyx_int_0;
    values[1] = __pyx_int_1;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_first_dof);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_stride);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "assign_dofs") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_first_dof = values[0];
    __pyx_v_stride = values[1];
  } else {
    __pyx_v_first_dof = __pyx_int_0;
    __pyx_v_stride = __pyx_int_1;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_stride = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_first_dof = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("assign_dofs", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.assign_dofs");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":620
 * 
 *     def assign_dofs(self, first_dof=0, stride=1):
 *         return self.thisptr.assign_dofs(first_dof, stride)             # <<<<<<<<<<<<<<
 * 
 *     def copy_orders(self, H1Space s, int inc=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_first_dof); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyInt_AsInt(__pyx_v_stride); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr->assign_dofs(__pyx_t_1, __pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.assign_dofs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":622
 *         return self.thisptr.assign_dofs(first_dof, stride)
 * 
 *     def copy_orders(self, H1Space s, int inc=0):             # <<<<<<<<<<<<<<
 *         self.thisptr.copy_orders(s.thisptr, inc)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_copy_orders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_copy_orders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_s = 0;
  int __pyx_v_inc;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_s,&__pyx_kp_inc,0};
  __Pyx_SetupRefcountContext("copy_orders");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_s);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_inc);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "copy_orders") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)values[0]);
    if (values[1]) {
      __pyx_v_inc = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_inc == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_inc = 0;
    }
  } else {
    __pyx_v_inc = 0;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_inc = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_inc == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("copy_orders", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.copy_orders");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_H1Space, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":623
 * 
 *     def copy_orders(self, H1Space s, int inc=0):
 *         self.thisptr.copy_orders(s.thisptr, inc)             # <<<<<<<<<<<<<<
 * 
 *     def get_element_order(self, int el_id):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr->copy_orders(__pyx_v_s->thisptr, __pyx_v_inc);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.copy_orders");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":625
 *         self.thisptr.copy_orders(s.thisptr, inc)
 * 
 *     def get_element_order(self, int el_id):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_element_order(el_id)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_element_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_el_id); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_element_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_el_id) {
  int __pyx_v_el_id;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_element_order");
  assert(__pyx_arg_el_id); {
    __pyx_v_el_id = __Pyx_PyInt_AsInt(__pyx_arg_el_id); if (unlikely((__pyx_v_el_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.get_element_order");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":626
 * 
 *     def get_element_order(self, int el_id):
 *         return self.thisptr.get_element_order(el_id)             # <<<<<<<<<<<<<<
 * 
 *     def get_num_dofs(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr->get_element_order(__pyx_v_el_id)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.get_element_order");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":628
 *         return self.thisptr.get_element_order(el_id)
 * 
 *     def get_num_dofs(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_dofs()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_num_dofs(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_num_dofs(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_num_dofs");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":629
 * 
 *     def get_num_dofs(self):
 *         return self.thisptr.get_num_dofs()             # <<<<<<<<<<<<<<
 * 
 * cdef class L2Space:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_self)->thisptr->get_num_dofs()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space.get_num_dofs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":636
 *         Suggested Use: ```l2_space = L2Space(mesh, l2_shapeset)```
 *     """
 *     def __init__(self, Mesh m, L2Shapeset s):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_L2Space(m.thisptr, s.thisptr)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_7L2Space___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_7L2Space___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *__pyx_v_m = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *__pyx_v_s = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_m,&__pyx_kp_s,0};
  __Pyx_SetupRefcountContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_m);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_s);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)values[0]);
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)values[1]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)PyTuple_GET_ITEM(__pyx_args, 1));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_m), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "m", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_L2Shapeset, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":637
 *     """
 *     def __init__(self, Mesh m, L2Shapeset s):
 *         self.thisptr = new_L2Space(m.thisptr, s.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr = new L2Space(__pyx_v_m->thisptr, __pyx_v_s->thisptr);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":639
 *         self.thisptr = new_L2Space(m.thisptr, s.thisptr)
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_7L2Space___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_7L2Space___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":640
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def set_uniform_order(self, int tri_order):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":642
 *         delete(self.thisptr)
 * 
 *     def set_uniform_order(self, int tri_order):             # <<<<<<<<<<<<<<
 *         """ Sets an order of all elements. In a case of quads, this supplied
 * 	    order is set to both the horizontal and the vertical direction
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_set_uniform_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_tri_order); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_7L2Space_set_uniform_order[] = " Sets an order of all elements. In a case of quads, this supplied\n\t    order is set to both the horizontal and the vertical direction\n\n\t    Suggested Use: ```l2_space.set_uniform_order(3)```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_set_uniform_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_tri_order) {
  int __pyx_v_tri_order;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("set_uniform_order");
  assert(__pyx_arg_tri_order); {
    __pyx_v_tri_order = __Pyx_PyInt_AsInt(__pyx_arg_tri_order); if (unlikely((__pyx_v_tri_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.set_uniform_order");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":648
 * 	    Suggested Use: ```l2_space.set_uniform_order(3)```
 * 	"""
 *         self.thisptr.set_uniform_order(tri_order)             # <<<<<<<<<<<<<<
 * 
 *     def assign_dofs(self, first_dof=0, stride=1):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr->set_uniform_order(__pyx_v_tri_order);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":650
 *         self.thisptr.set_uniform_order(tri_order)
 * 
 *     def assign_dofs(self, first_dof=0, stride=1):             # <<<<<<<<<<<<<<
 *         """ Assign DOFs. Updates internal structures after orders has been changed
 * 	    Returns a number of DOFs.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_assign_dofs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_7L2Space_assign_dofs[] = " Assign DOFs. Updates internal structures after orders has been changed\n\t    Returns a number of DOFs.\n\n\t    Suggested Use: ```l2_space.assign_dofs()```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_assign_dofs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_first_dof = 0;
  PyObject *__pyx_v_stride = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_first_dof,&__pyx_kp_stride,0};
  __Pyx_SetupRefcountContext("assign_dofs");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[0] = __pyx_int_0;
    values[1] = __pyx_int_1;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_first_dof);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_stride);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "assign_dofs") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_first_dof = values[0];
    __pyx_v_stride = values[1];
  } else {
    __pyx_v_first_dof = __pyx_int_0;
    __pyx_v_stride = __pyx_int_1;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_stride = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_first_dof = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("assign_dofs", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.assign_dofs");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":656
 * 	    Suggested Use: ```l2_space.assign_dofs()```
 * 	"""
 *         return self.thisptr.assign_dofs(first_dof, stride)             # <<<<<<<<<<<<<<
 * 
 *     def copy_orders(self, L2Space s, int inc=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_first_dof); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyInt_AsInt(__pyx_v_stride); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr->assign_dofs(__pyx_t_1, __pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.assign_dofs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":658
 *         return self.thisptr.assign_dofs(first_dof, stride)
 * 
 *     def copy_orders(self, L2Space s, int inc=0):             # <<<<<<<<<<<<<<
 *         """ Copies order from a supplied L2 space.
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_copy_orders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_7L2Space_copy_orders[] = " Copies order from a supplied L2 space.\n\n\t    Suggested Use: ```l2_space.copy_orders(another_l2_space)```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_copy_orders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *__pyx_v_s = 0;
  int __pyx_v_inc;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_s,&__pyx_kp_inc,0};
  __Pyx_SetupRefcountContext("copy_orders");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_s);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_inc);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "copy_orders") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)values[0]);
    if (values[1]) {
      __pyx_v_inc = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_inc == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_inc = 0;
    }
  } else {
    __pyx_v_inc = 0;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_inc = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_inc == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("copy_orders", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.copy_orders");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_L2Space, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":663
 * 	    Suggested Use: ```l2_space.copy_orders(another_l2_space)```
 * 	"""
 *         self.thisptr.copy_orders(s.thisptr, inc)             # <<<<<<<<<<<<<<
 * 
 *     def get_element_order(self, int el_id):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr->copy_orders(__pyx_v_s->thisptr, __pyx_v_inc);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.copy_orders");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":665
 *         self.thisptr.copy_orders(s.thisptr, inc)
 * 
 *     def get_element_order(self, int el_id):             # <<<<<<<<<<<<<<
 *         """ Returns order of element. In case of quadrilaterals, the order
 * 	    is in an encoded form.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_element_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_el_id); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_7L2Space_get_element_order[] = " Returns order of element. In case of quadrilaterals, the order\n\t    is in an encoded form.\n\n\t    Suggested Use: ```order = l2_space.get_element_order(element_id)```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_element_order(PyObject *__pyx_v_self, PyObject *__pyx_arg_el_id) {
  int __pyx_v_el_id;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_element_order");
  assert(__pyx_arg_el_id); {
    __pyx_v_el_id = __Pyx_PyInt_AsInt(__pyx_arg_el_id); if (unlikely((__pyx_v_el_id == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.get_element_order");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":671
 * 	    Suggested Use: ```order = l2_space.get_element_order(element_id)```
 * 	"""
 *         return self.thisptr.get_element_order(el_id)             # <<<<<<<<<<<<<<
 * 
 *     def get_num_dofs(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr->get_element_order(__pyx_v_el_id)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.get_element_order");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":673
 *         return self.thisptr.get_element_order(el_id)
 * 
 *     def get_num_dofs(self):             # <<<<<<<<<<<<<<
 *         """ Returns a number of DOFs.
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_num_dofs(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_7L2Space_get_num_dofs[] = " Returns a number of DOFs.\n\n\t    Suggested Use: ```num_dofs = l2_space.get_num_dofs()```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_num_dofs(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_num_dofs");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":678
 * 	    Suggested Use: ```num_dofs = l2_space.get_num_dofs()```
 * 	"""
 *         return self.thisptr.get_num_dofs()             # <<<<<<<<<<<<<<
 * 
 * cdef api object H1Space_from_C(c_H1Space *h):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_v_self)->thisptr->get_num_dofs()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Space.get_num_dofs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":680
 *         return self.thisptr.get_num_dofs()
 * 
 * cdef api object H1Space_from_C(c_H1Space *h):             # <<<<<<<<<<<<<<
 *     cdef H1Space n
 *     n = <H1Space>PY_NEW(H1Space)
 */

static  PyObject *H1Space_from_C(struct H1Space *__pyx_v_h) {
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("H1Space_from_C");
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":682
 * cdef api object H1Space_from_C(c_H1Space *h):
 *     cdef H1Space n
 *     n = <H1Space>PY_NEW(H1Space)             # <<<<<<<<<<<<<<
 *     n.thisptr = h
 *     return n
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_H1Space))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_t_1)));
  __Pyx_DECREF(((PyObject *)__pyx_v_n));
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":683
 *     cdef H1Space n
 *     n = <H1Space>PY_NEW(H1Space)
 *     n.thisptr = h             # <<<<<<<<<<<<<<
 *     return n
 * 
 */
  __pyx_v_n->thisptr = __pyx_v_h;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":684
 *     n = <H1Space>PY_NEW(H1Space)
 *     n.thisptr = h
 *     return n             # <<<<<<<<<<<<<<
 * 
 * cdef api object Mesh_from_C(c_Mesh *h):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Space_from_C");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":686
 *     return n
 * 
 * cdef api object Mesh_from_C(c_Mesh *h):             # <<<<<<<<<<<<<<
 *     cdef Mesh n
 *     n = <Mesh>PY_NEW(Mesh)
 */

static  PyObject *Mesh_from_C(struct Mesh *__pyx_v_h) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *__pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("Mesh_from_C");
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":688
 * cdef api object Mesh_from_C(c_Mesh *h):
 *     cdef Mesh n
 *     n = <Mesh>PY_NEW(Mesh)             # <<<<<<<<<<<<<<
 *     n.thisptr = h
 *     return n
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Mesh))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_t_1)));
  __Pyx_DECREF(((PyObject *)__pyx_v_n));
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":689
 *     cdef Mesh n
 *     n = <Mesh>PY_NEW(Mesh)
 *     n.thisptr = h             # <<<<<<<<<<<<<<
 *     return n
 * 
 */
  __pyx_v_n->thisptr = __pyx_v_h;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":690
 *     n = <Mesh>PY_NEW(Mesh)
 *     n.thisptr = h
 *     return n             # <<<<<<<<<<<<<<
 * 
 * cdef api object LinSystem_from_C(c_LinSystem *h):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Mesh_from_C");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":692
 *     return n
 * 
 * cdef api object LinSystem_from_C(c_LinSystem *h):             # <<<<<<<<<<<<<<
 *     cdef LinSystem n
 *     n = <LinSystem>PY_NEW(LinSystem)
 */

static  PyObject *LinSystem_from_C(struct LinSystem *__pyx_v_h) {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *__pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("LinSystem_from_C");
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":694
 * cdef api object LinSystem_from_C(c_LinSystem *h):
 *     cdef LinSystem n
 *     n = <LinSystem>PY_NEW(LinSystem)             # <<<<<<<<<<<<<<
 *     n.thisptr = h
 *     return n
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_LinSystem))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_t_1)));
  __Pyx_DECREF(((PyObject *)__pyx_v_n));
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":695
 *     cdef LinSystem n
 *     n = <LinSystem>PY_NEW(LinSystem)
 *     n.thisptr = h             # <<<<<<<<<<<<<<
 *     return n
 * 
 */
  __pyx_v_n->thisptr = __pyx_v_h;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":696
 *     n = <LinSystem>PY_NEW(LinSystem)
 *     n.thisptr = h
 *     return n             # <<<<<<<<<<<<<<
 * 
 * cdef class Transformable:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem_from_C");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":709
 * cdef class MeshFunction(ScalarFunction):
 * 
 *     def __add__(x, y):             # <<<<<<<<<<<<<<
 *         return SumFilter(x, y)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___add__(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___add__(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("__add__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":710
 * 
 *     def __add__(x, y):
 *         return SumFilter(x, y)             # <<<<<<<<<<<<<<
 * 
 *     def __sub__(x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_x);
  __Pyx_GIVEREF(__pyx_v_x);
  __Pyx_INCREF(__pyx_v_y);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_y);
  __Pyx_GIVEREF(__pyx_v_y);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_SumFilter)), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.__add__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":712
 *         return SumFilter(x, y)
 * 
 *     def __sub__(x, y):             # <<<<<<<<<<<<<<
 *         return DiffFilter(x, y)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___sub__(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___sub__(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("__sub__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":713
 * 
 *     def __sub__(x, y):
 *         return DiffFilter(x, y)             # <<<<<<<<<<<<<<
 * 
 *     def __pow__(x, y, z):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_x);
  __Pyx_GIVEREF(__pyx_v_x);
  __Pyx_INCREF(__pyx_v_y);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_y);
  __Pyx_GIVEREF(__pyx_v_y);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_DiffFilter)), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.__sub__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":715
 *         return DiffFilter(x, y)
 * 
 *     def __pow__(x, y, z):             # <<<<<<<<<<<<<<
 *         if y == 2:
 *             return SquareFilter(x)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___pow__(PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_z); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___pow__(PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_z) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("__pow__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":716
 * 
 *     def __pow__(x, y, z):
 *         if y == 2:             # <<<<<<<<<<<<<<
 *             return SquareFilter(x)
 *         return NotImplemented
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_y, __pyx_int_2, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":717
 *     def __pow__(x, y, z):
 *         if y == 2:
 *             return SquareFilter(x)             # <<<<<<<<<<<<<<
 *         return NotImplemented
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __Pyx_INCREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_SquareFilter)), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":718
 *         if y == 2:
 *             return SquareFilter(x)
 *         return NotImplemented             # <<<<<<<<<<<<<<
 * 
 *     def __neg__(x):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_builtin_NotImplemented);
  __pyx_r = __pyx_builtin_NotImplemented;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.__pow__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":720
 *         return NotImplemented
 * 
 *     def __neg__(x):             # <<<<<<<<<<<<<<
 *         return x-x-x
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___neg__(PyObject *__pyx_v_x); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___neg__(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("__neg__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":721
 * 
 *     def __neg__(x):
 *         return x-x-x             # <<<<<<<<<<<<<<
 * 
 *     #def integrate(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyNumber_Subtract(__pyx_v_x, __pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_v_x); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.__neg__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":727
 *     #    return integrate(m)
 * 
 *     def l2_norm(self):             # <<<<<<<<<<<<<<
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return l2_norm(m)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_l2_norm(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_l2_norm(PyObject *__pyx_v_self, PyObject *unused) {
  struct MeshFunction *__pyx_v_m;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("l2_norm");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":728
 * 
 *     def l2_norm(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         return l2_norm(m)
 * 
 */
  __pyx_v_m = ((struct MeshFunction *)((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)__pyx_v_self)->__pyx_base.__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":729
 *     def l2_norm(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return l2_norm(m)             # <<<<<<<<<<<<<<
 * 
 *     def h1_norm(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(l2_norm(__pyx_v_m)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.l2_norm");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":731
 *         return l2_norm(m)
 * 
 *     def h1_norm(self):             # <<<<<<<<<<<<<<
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return h1_norm(m)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_h1_norm(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_h1_norm(PyObject *__pyx_v_self, PyObject *unused) {
  struct MeshFunction *__pyx_v_m;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("h1_norm");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":732
 * 
 *     def h1_norm(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         return h1_norm(m)
 * 
 */
  __pyx_v_m = ((struct MeshFunction *)((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)__pyx_v_self)->__pyx_base.__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":733
 *     def h1_norm(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return h1_norm(m)             # <<<<<<<<<<<<<<
 * 
 *     def get_pt_value(self, x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(h1_norm(__pyx_v_m)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.h1_norm");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":735
 *         return h1_norm(m)
 * 
 *     def get_pt_value(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return m.get_pt_value(x, y)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_pt_value(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_pt_value(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  struct MeshFunction *__pyx_v_m;
  PyObject *__pyx_r = NULL;
  double __pyx_t_1;
  double __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_x,&__pyx_kp_y,0};
  __Pyx_SetupRefcountContext("get_pt_value");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("get_pt_value", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "get_pt_value") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_x = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("get_pt_value", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.get_pt_value");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":736
 * 
 *     def get_pt_value(self, x, y):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         return m.get_pt_value(x, y)
 * 
 */
  __pyx_v_m = ((struct MeshFunction *)((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)__pyx_v_self)->__pyx_base.__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":737
 *     def get_pt_value(self, x, y):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return m.get_pt_value(x, y)             # <<<<<<<<<<<<<<
 * 
 *     def get_mesh(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_y); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_m->get_pt_value(__pyx_t_1, __pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.get_pt_value");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":739
 *         return m.get_pt_value(x, y)
 * 
 *     def get_mesh(self):             # <<<<<<<<<<<<<<
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return Mesh_from_C(m.get_mesh())
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_mesh(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_mesh(PyObject *__pyx_v_self, PyObject *unused) {
  struct MeshFunction *__pyx_v_m;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_mesh");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":740
 * 
 *     def get_mesh(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         return Mesh_from_C(m.get_mesh())
 * 
 */
  __pyx_v_m = ((struct MeshFunction *)((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)__pyx_v_self)->__pyx_base.__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":741
 *     def get_mesh(self):
 *         cdef c_MeshFunction *m = <c_MeshFunction *>(self.thisptr)
 *         return Mesh_from_C(m.get_mesh())             # <<<<<<<<<<<<<<
 * 
 * cdef api object Solution_from_C(c_Solution *s):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = Mesh_from_C(__pyx_v_m->get_mesh()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshFunction.get_mesh");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":743
 *         return Mesh_from_C(m.get_mesh())
 * 
 * cdef api object Solution_from_C(c_Solution *s):             # <<<<<<<<<<<<<<
 *     cdef Solution n
 *     n = <Solution>PY_NEW(Solution)
 */

static  PyObject *Solution_from_C(struct Solution *__pyx_v_s) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Solution *__pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("Solution_from_C");
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":745
 * cdef api object Solution_from_C(c_Solution *s):
 *     cdef Solution n
 *     n = <Solution>PY_NEW(Solution)             # <<<<<<<<<<<<<<
 *     n.thisptr = <c_Function *>s
 *     return n
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_8hermes2d_9_hermes2d_Solution))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_t_1)));
  __Pyx_DECREF(((PyObject *)__pyx_v_n));
  __pyx_v_n = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":746
 *     cdef Solution n
 *     n = <Solution>PY_NEW(Solution)
 *     n.thisptr = <c_Function *>s             # <<<<<<<<<<<<<<
 *     return n
 * 
 */
  __pyx_v_n->__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)__pyx_v_s);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":747
 *     n = <Solution>PY_NEW(Solution)
 *     n.thisptr = <c_Function *>s
 *     return n             # <<<<<<<<<<<<<<
 * 
 * cdef class Solution(MeshFunction):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_n));
  __pyx_r = ((PyObject *)__pyx_v_n);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution_from_C");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":751
 * cdef class Solution(MeshFunction):
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_Solution()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_8Solution___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_8Solution___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":752
 * 
 *     def __cinit__(self):
 *         self.thisptr = <c_Function *>new_Solution()             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new Solution());

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":757
 *     #    delete(self.thisptr)
 * 
 *     def copy(self, Solution s):             # <<<<<<<<<<<<<<
 *         (<c_Solution *>(self.thisptr)).copy((<c_Solution *>(s.thisptr)))
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("copy");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_Solution, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":758
 * 
 *     def copy(self, Solution s):
 *         (<c_Solution *>(self.thisptr)).copy((<c_Solution *>(s.thisptr)))             # <<<<<<<<<<<<<<
 * 
 *     def copy_by_reference(self, Solution s):
 */
  ((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr)->copy(((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_s)->__pyx_base.__pyx_base.__pyx_base.thisptr));

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.copy");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":760
 *         (<c_Solution *>(self.thisptr)).copy((<c_Solution *>(s.thisptr)))
 * 
 *     def copy_by_reference(self, Solution s):             # <<<<<<<<<<<<<<
 *         self.thisptr = s.thisptr
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy_by_reference(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy_by_reference(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("copy_by_reference");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_Solution, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":761
 * 
 *     def copy_by_reference(self, Solution s):
 *         self.thisptr = s.thisptr             # <<<<<<<<<<<<<<
 * 
 *     def set_zero(self, Mesh m):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_s)->__pyx_base.__pyx_base.__pyx_base.thisptr;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.copy_by_reference");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":763
 *         self.thisptr = s.thisptr
 * 
 *     def set_zero(self, Mesh m):             # <<<<<<<<<<<<<<
 *         (<c_Solution *>(self.thisptr)).set_zero(m.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_zero(PyObject *__pyx_v_self, PyObject *__pyx_v_m); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_zero(PyObject *__pyx_v_self, PyObject *__pyx_v_m) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("set_zero");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_m), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "m", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":764
 * 
 *     def set_zero(self, Mesh m):
 *         (<c_Solution *>(self.thisptr)).set_zero(m.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def set_const(self, Mesh m, scalar):
 */
  ((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr)->set_zero(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_m)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.set_zero");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":766
 *         (<c_Solution *>(self.thisptr)).set_zero(m.thisptr)
 * 
 *     def set_const(self, Mesh m, scalar):             # <<<<<<<<<<<<<<
 *         (<c_Solution *>(self.thisptr)).set_const(m.thisptr, scalar)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_const(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_const(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *__pyx_v_m = 0;
  PyObject *__pyx_v_scalar = 0;
  PyObject *__pyx_r = NULL;
  scalar __pyx_t_1;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_m,&__pyx_kp_scalar,0};
  __Pyx_SetupRefcountContext("set_const");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_m);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_scalar);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_const", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_const") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)values[0]);
    __pyx_v_scalar = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_m = ((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_scalar = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_const", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.set_const");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_m), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "m", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":767
 * 
 *     def set_const(self, Mesh m, scalar):
 *         (<c_Solution *>(self.thisptr)).set_const(m.thisptr, scalar)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_scalar); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr)->set_const(__pyx_v_m->thisptr, __pyx_t_1);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.set_const");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":770
 * 
 * 
 *     def set_fe_solution(self, H1Space s, PrecalcShapeset pss, ndarray v):             # <<<<<<<<<<<<<<
 *         """
 *         Sets the solution using the coefficient vector Y.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_fe_solution(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_8Solution_set_fe_solution[] = "\n        Sets the solution using the coefficient vector Y.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_fe_solution(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_s = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *__pyx_v_pss = 0;
  PyArrayObject *__pyx_v_v = 0;
  int __pyx_v_n;
  PyObject *__pyx_v_array;
  PyArrayObject *__pyx_v_vec = 0;
  scalar *__pyx_v_pvec;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_s,&__pyx_kp_pss,&__pyx_kp_v,0};
  __Pyx_SetupRefcountContext("set_fe_solution");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_s);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_pss);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_fe_solution", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_v);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_fe_solution", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_fe_solution") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)values[0]);
    __pyx_v_pss = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)values[1]);
    __pyx_v_v = ((PyArrayObject *)values[2]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_pss = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)PyTuple_GET_ITEM(__pyx_args, 1));
    __pyx_v_v = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 2));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_fe_solution", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.set_fe_solution");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_array = Py_None; __Pyx_INCREF(Py_None);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_H1Space, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_pss), __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset, 1, "pss", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_8hermes2d_9_hermes2d_ndarray, 1, "v", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":774
 *         Sets the solution using the coefficient vector Y.
 *         """
 *         cdef int n = len(v)             # <<<<<<<<<<<<<<
 *         cdef int i
 *         from numpy import array
 */
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_v)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = __pyx_t_1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":776
 *         cdef int n = len(v)
 *         cdef int i
 *         from numpy import array             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = array(v, dtype="double")
 *         cdef scalar *pvec = <scalar *>vec.data
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_kp_array);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_array);
  __Pyx_GIVEREF(__pyx_kp_array);
  __pyx_1 = __Pyx_Import(__pyx_kp_numpy, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_array); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __Pyx_DECREF(__pyx_v_array);
  __pyx_v_array = __pyx_2;
  __pyx_2 = 0;
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":777
 *         cdef int i
 *         from numpy import array
 *         cdef ndarray vec = array(v, dtype="double")             # <<<<<<<<<<<<<<
 *         cdef scalar *pvec = <scalar *>vec.data
 *         (<c_Solution *>(self.thisptr)).set_fe_solution(s.thisptr, pss.thisptr,
 */
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(((PyObject *)__pyx_v_v));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_v));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_v));
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  if (PyDict_SetItem(__pyx_1, __pyx_kp_dtype, __pyx_kp_62) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyEval_CallObjectWithKeywords(__pyx_v_array, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  if (!(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":778
 *         from numpy import array
 *         cdef ndarray vec = array(v, dtype="double")
 *         cdef scalar *pvec = <scalar *>vec.data             # <<<<<<<<<<<<<<
 *         (<c_Solution *>(self.thisptr)).set_fe_solution(s.thisptr, pss.thisptr,
 *                 pvec)
 */
  __pyx_v_pvec = ((scalar *)__pyx_v_vec->data);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":780
 *         cdef scalar *pvec = <scalar *>vec.data
 *         (<c_Solution *>(self.thisptr)).set_fe_solution(s.thisptr, pss.thisptr,
 *                 pvec)             # <<<<<<<<<<<<<<
 * 
 *     def plot(self, *args, **kwargs):
 */
  ((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.thisptr)->set_fe_solution(__pyx_v_s->thisptr, __pyx_v_pss->thisptr, __pyx_v_pvec);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.set_fe_solution");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_array);
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":782
 *                 pvec)
 * 
 *     def plot(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         """
 *         Plots the solution and shows it to the user.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_8Solution_plot[] = "\n        Plots the solution and shows it to the user.\n\n        It passes all arguments to the ScalarView.show() function, so read its\n        documentation for the meaning.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_v_ScalarView;
  PyObject *__pyx_v_sview;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("plot");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "plot", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_v_ScalarView = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_sview = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":789
 *         documentation for the meaning.
 *         """
 *         from hermes2d import ScalarView             # <<<<<<<<<<<<<<
 *         sview = ScalarView()
 *         sview.show(self, *args, **kwargs)
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 789; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_kp_ScalarView);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_ScalarView);
  __Pyx_GIVEREF(__pyx_kp_ScalarView);
  __pyx_1 = __Pyx_Import(__pyx_kp_61, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 789; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_ScalarView); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 789; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __Pyx_DECREF(__pyx_v_ScalarView);
  __pyx_v_ScalarView = __pyx_2;
  __pyx_2 = 0;
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":790
 *         """
 *         from hermes2d import ScalarView
 *         sview = ScalarView()             # <<<<<<<<<<<<<<
 *         sview.show(self, *args, **kwargs)
 * 
 */
  __pyx_t_1 = PyObject_Call(__pyx_v_ScalarView, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_sview);
  __pyx_v_sview = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":791
 *         from hermes2d import ScalarView
 *         sview = ScalarView()
 *         sview.show(self, *args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     def show(self, *args, **kwargs):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_sview, __pyx_kp_show); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  __pyx_1 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_t_2), ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.plot");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_DECREF(__pyx_v_ScalarView);
  __Pyx_DECREF(__pyx_v_sview);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":793
 *         sview.show(self, *args, **kwargs)
 * 
 *     def show(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         """
 *         Plots the solution and shows it to the user.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_8Solution_show[] = "\n        Plots the solution and shows it to the user.\n\n        It passes all arguments to the ScalarView.show() function, so read its\n        documentation for the meaning.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8Solution_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("show");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "show", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":800
 *         documentation for the meaning.
 *         """
 *         self.plot(*args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     # the get_fe_solution() method is is not yet implemented in the C++ hermes:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_plot); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_1 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_1));
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_1), __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.Solution.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":826
 * cdef class VonMisesFilter(Filter):
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, double l, double m):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_VonMisesFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, l, m)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_14VonMisesFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_14VonMisesFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln1 = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln2 = 0;
  double __pyx_v_l;
  double __pyx_v_m;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_9,&__pyx_kp_10,&__pyx_kp_l,&__pyx_kp_m,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_9);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_10);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_l);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_m);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    __pyx_v_l = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_m = __pyx_PyFloat_AsDouble(values[3]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
    __pyx_v_l = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_m = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VonMisesFilter.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln1), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln1", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln2), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":827
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, double l, double m):
 *         self.thisptr = <c_Function *>new_VonMisesFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, l, m)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_VonMisesFilter *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new VonMisesFilter(((struct MeshFunction *)__pyx_v_sln1->__pyx_base.__pyx_base.thisptr), ((struct MeshFunction *)__pyx_v_sln2->__pyx_base.__pyx_base.thisptr), __pyx_v_l, __pyx_v_m));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VonMisesFilter.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":834
 * cdef class MagFilter(SimpleFilter):
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, int item1, int item2):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_MagFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_9MagFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_9MagFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln1 = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln2 = 0;
  int __pyx_v_item1;
  int __pyx_v_item2;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_9,&__pyx_kp_10,&__pyx_kp_11,&__pyx_kp_12,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_9);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_10);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_11);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_12);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    __pyx_v_item1 = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_item2 = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
    __pyx_v_item1 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_item2 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.MagFilter.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln1), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln1", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln2), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":835
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2, int item1, int item2):
 *         self.thisptr = <c_Function *>new_MagFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_MagFilter *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new MagFilter(((struct MeshFunction *)__pyx_v_sln1->__pyx_base.__pyx_base.thisptr), ((struct MeshFunction *)__pyx_v_sln2->__pyx_base.__pyx_base.thisptr), __pyx_v_item1, __pyx_v_item2));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.MagFilter.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":842
 * cdef class DiffFilter(SimpleFilter):
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,             # <<<<<<<<<<<<<<
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):
 *         self.thisptr = <c_Function *>new_DiffFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10DiffFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10DiffFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln1 = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln2 = 0;
  int __pyx_v_item1;
  int __pyx_v_item2;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_9,&__pyx_kp_10,&__pyx_kp_11,&__pyx_kp_12,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_9);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_10);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_11);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_12);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    if (values[2]) {
      __pyx_v_item1 = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_item1 = __pyx_k_29;
    }
    if (values[3]) {
      __pyx_v_item2 = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_item2 = __pyx_k_30;
    }
  } else {
    __pyx_v_item1 = __pyx_k_29;
    __pyx_v_item2 = __pyx_k_30;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4:
      __pyx_v_item2 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3:
      __pyx_v_item1 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2:
      __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
      __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.DiffFilter.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln1), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln1", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln2), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":844
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):
 *         self.thisptr = <c_Function *>new_DiffFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_DiffFilter *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new DiffFilter(((struct MeshFunction *)__pyx_v_sln1->__pyx_base.__pyx_base.thisptr), ((struct MeshFunction *)__pyx_v_sln2->__pyx_base.__pyx_base.thisptr), __pyx_v_item1, __pyx_v_item2));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.DiffFilter.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":851
 * cdef class SumFilter(SimpleFilter):
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,             # <<<<<<<<<<<<<<
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):
 *         self.thisptr = <c_Function *>new_SumFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_9SumFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_9SumFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln1 = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln2 = 0;
  int __pyx_v_item1;
  int __pyx_v_item2;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_9,&__pyx_kp_10,&__pyx_kp_11,&__pyx_kp_12,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_9);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_10);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_11);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_12);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    if (values[2]) {
      __pyx_v_item1 = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_item1 = __pyx_k_31;
    }
    if (values[3]) {
      __pyx_v_item2 = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_item2 = __pyx_k_32;
    }
  } else {
    __pyx_v_item1 = __pyx_k_31;
    __pyx_v_item2 = __pyx_k_32;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4:
      __pyx_v_item2 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_item2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3:
      __pyx_v_item1 = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_item1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2:
      __pyx_v_sln2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
      __pyx_v_sln1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.SumFilter.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln1), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln1", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln2), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":853
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):
 *         self.thisptr = <c_Function *>new_SumFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_SumFilter *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new SumFilter(((struct MeshFunction *)__pyx_v_sln1->__pyx_base.__pyx_base.thisptr), ((struct MeshFunction *)__pyx_v_sln2->__pyx_base.__pyx_base.thisptr), __pyx_v_item1, __pyx_v_item2));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.SumFilter.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":860
 * cdef class SquareFilter(SimpleFilter):
 * 
 *     def __cinit__(self, MeshFunction sln, int item=H2D_FN_VAL):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_SquareFilter(<c_MeshFunction *>sln.thisptr, item)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_12SquareFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_12SquareFilter___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln = 0;
  int __pyx_v_item;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_sln,&__pyx_kp_item,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_sln);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_item);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    if (values[1]) {
      __pyx_v_item = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_item == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_item = __pyx_k_33;
    }
  } else {
    __pyx_v_item = __pyx_k_33;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_item = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_item == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_sln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.SquareFilter.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":861
 * 
 *     def __cinit__(self, MeshFunction sln, int item=H2D_FN_VAL):
 *         self.thisptr = <c_Function *>new_SquareFilter(<c_MeshFunction *>sln.thisptr, item)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_SquareFilter *)__pyx_v_self)->__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_base.thisptr = ((struct MeshFunction *)new SquareFilter(((struct MeshFunction *)__pyx_v_sln->__pyx_base.__pyx_base.thisptr), __pyx_v_item));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.SquareFilter.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":868
 * cdef class WeakForm:
 * 
 *     def __cinit__(self, int neq=1):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_WeakForm(neq)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_8WeakForm___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_8WeakForm___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_neq;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_neq,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_neq);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_neq = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_neq == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_neq = 1;
    }
  } else {
    __pyx_v_neq = 1;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_neq = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_neq == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.WeakForm.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":869
 * 
 *     def __cinit__(self, int neq=1):
 *         self.thisptr = new_WeakForm(neq)             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm *)__pyx_v_self)->thisptr = new WeakForm(__pyx_v_neq);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":871
 *         self.thisptr = new_WeakForm(neq)
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_8WeakForm___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_8WeakForm___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":872
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class DummySolver(Solver):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":876
 * cdef class DummySolver(Solver):
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Solver *>(new_DummySolver())
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_11DummySolver___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_11DummySolver___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":877
 * 
 *     def __cinit__(self):
 *         self.thisptr = <c_Solver *>(new_DummySolver())             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_DummySolver *)__pyx_v_self)->__pyx_base.thisptr = ((struct Solver *)new DummySolver());

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":879
 *         self.thisptr = <c_Solver *>(new_DummySolver())
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_11DummySolver___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_11DummySolver___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":880
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class LinSystem:
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_DummySolver *)__pyx_v_self)->__pyx_base.thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":884
 * cdef class LinSystem:
 * 
 *     def __init__(self, WeakForm wf, Solver solver):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_LinSystem(wf.thisptr, solver.thisptr)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_9LinSystem___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_9LinSystem___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm *__pyx_v_wf = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_Solver *__pyx_v_solver = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_wf,&__pyx_kp_solver,0};
  __Pyx_SetupRefcountContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_wf);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_solver);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 884; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 884; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_wf = ((struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm *)values[0]);
    __pyx_v_solver = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solver *)values[1]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_wf = ((struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_solver = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solver *)PyTuple_GET_ITEM(__pyx_args, 1));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 884; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_wf), __pyx_ptype_8hermes2d_9_hermes2d_WeakForm, 1, "wf", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_solver), __pyx_ptype_8hermes2d_9_hermes2d_Solver, 1, "solver", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":885
 * 
 *     def __init__(self, WeakForm wf, Solver solver):
 *         self.thisptr = new_LinSystem(wf.thisptr, solver.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr = new LinSystem(__pyx_v_wf->thisptr, __pyx_v_solver->thisptr);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":890
 *     #    delete(self.thisptr)
 * 
 *     def set_spaces(self, *args):             # <<<<<<<<<<<<<<
 *         self._spaces = args
 *         cdef int n = len(args)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_spaces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_spaces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  int __pyx_v_n;
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_a;
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_b;
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_c;
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *__pyx_v_d;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("set_spaces");
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "set_spaces", 0))) return NULL;
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_c = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_d = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":891
 * 
 *     def set_spaces(self, *args):
 *         self._spaces = args             # <<<<<<<<<<<<<<
 *         cdef int n = len(args)
 *         cdef H1Space a, b, c, d
 */
  __Pyx_INCREF(__pyx_v_args);
  __Pyx_GIVEREF(__pyx_v_args);
  __Pyx_GOTREF(((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_spaces);
  __Pyx_DECREF(((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_spaces);
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_spaces = __pyx_v_args;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":892
 *     def set_spaces(self, *args):
 *         self._spaces = args
 *         cdef int n = len(args)             # <<<<<<<<<<<<<<
 *         cdef H1Space a, b, c, d
 *         if n == 1:
 */
  __pyx_t_1 = PyObject_Length(__pyx_v_args); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 892; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = __pyx_t_1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":894
 *         cdef int n = len(args)
 *         cdef H1Space a, b, c, d
 *         if n == 1:             # <<<<<<<<<<<<<<
 *             a = args[0]
 *             self.thisptr.set_spaces(n, a.thisptr)
 */
  switch (__pyx_v_n) {
    case 1:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":895
 *         cdef H1Space a, b, c, d
 *         if n == 1:
 *             a = args[0]             # <<<<<<<<<<<<<<
 *             self.thisptr.set_spaces(n, a.thisptr)
 *         elif n == 2:
 */
    __pyx_1 = __Pyx_GetItemInt(__pyx_v_args, 0, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_v_a));
    __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_1);
    __pyx_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":896
 *         if n == 1:
 *             a = args[0]
 *             self.thisptr.set_spaces(n, a.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 2:
 *             a, b = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_spaces(__pyx_v_n, __pyx_v_a->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":897
 *             a = args[0]
 *             self.thisptr.set_spaces(n, a.thisptr)
 *         elif n == 2:             # <<<<<<<<<<<<<<
 *             a, b = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr)
 */
    case 2:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":898
 *             self.thisptr.set_spaces(n, a.thisptr)
 *         elif n == 2:
 *             a, b = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr)
 *         elif n == 3:
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 2)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":899
 *         elif n == 2:
 *             a, b = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 3:
 *             a, b, c = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_spaces(__pyx_v_n, __pyx_v_a->thisptr, __pyx_v_b->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":900
 *             a, b = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr)
 *         elif n == 3:             # <<<<<<<<<<<<<<
 *             a, b, c = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr)
 */
    case 3:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":901
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr)
 *         elif n == 3:
 *             a, b, c = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr)
 *         elif n == 4:
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 3)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_c));
      __pyx_v_c = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_4);
      __pyx_4 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_c));
      __pyx_v_c = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_4);
      __pyx_4 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":902
 *         elif n == 3:
 *             a, b, c = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 4:
 *             a, b, c, d = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_spaces(__pyx_v_n, __pyx_v_a->thisptr, __pyx_v_b->thisptr, __pyx_v_c->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":903
 *             a, b, c = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr)
 *         elif n == 4:             # <<<<<<<<<<<<<<
 *             a, b, c, d = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr,
 */
    case 4:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":904
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr)
 *         elif n == 4:
 *             a, b, c, d = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr,
 *                     d.thisptr)
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 4)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_5 = PyTuple_GET_ITEM(tuple, 3); __Pyx_INCREF(__pyx_5);
      if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_c));
      __pyx_v_c = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_4);
      __pyx_4 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_d));
      __pyx_v_d = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_5);
      __pyx_5 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_5 = __Pyx_UnpackItem(__pyx_1, 3); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_5);
      if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_H1Space))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_a));
      __pyx_v_a = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_b));
      __pyx_v_b = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_c));
      __pyx_v_c = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_4);
      __pyx_4 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_d));
      __pyx_v_d = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_5);
      __pyx_5 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":906
 *             a, b, c, d = args
 *             self.thisptr.set_spaces(n, a.thisptr, b.thisptr, c.thisptr,
 *                     d.thisptr)             # <<<<<<<<<<<<<<
 *         else:
 *             raise NotImplementedError()
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_spaces(__pyx_v_n, __pyx_v_a->thisptr, __pyx_v_b->thisptr, __pyx_v_c->thisptr, __pyx_v_d->thisptr);
    break;
    default:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":908
 *                     d.thisptr)
 *         else:
 *             raise NotImplementedError()             # <<<<<<<<<<<<<<
 * 
 *     def set_pss(self, *args):
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    break;
  }

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_4);
  __Pyx_XDECREF(__pyx_5);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.set_spaces");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF((PyObject *)__pyx_v_a);
  __Pyx_DECREF((PyObject *)__pyx_v_b);
  __Pyx_DECREF((PyObject *)__pyx_v_c);
  __Pyx_DECREF((PyObject *)__pyx_v_d);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":910
 *             raise NotImplementedError()
 * 
 *     def set_pss(self, *args):             # <<<<<<<<<<<<<<
 *         self._pss = args
 *         cdef int n = len(args)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_pss(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_pss(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  int __pyx_v_n;
  struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *__pyx_v_s1;
  struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *__pyx_v_s2;
  struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *__pyx_v_s3;
  struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *__pyx_v_s4;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("set_pss");
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "set_pss", 0))) return NULL;
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s4 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)Py_None); __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":911
 * 
 *     def set_pss(self, *args):
 *         self._pss = args             # <<<<<<<<<<<<<<
 *         cdef int n = len(args)
 *         cdef PrecalcShapeset s1, s2, s3, s4
 */
  __Pyx_INCREF(__pyx_v_args);
  __Pyx_GIVEREF(__pyx_v_args);
  __Pyx_GOTREF(((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_pss);
  __Pyx_DECREF(((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_pss);
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->_pss = __pyx_v_args;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":912
 *     def set_pss(self, *args):
 *         self._pss = args
 *         cdef int n = len(args)             # <<<<<<<<<<<<<<
 *         cdef PrecalcShapeset s1, s2, s3, s4
 *         if n == 1:
 */
  __pyx_t_1 = PyObject_Length(__pyx_v_args); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 912; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = __pyx_t_1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":914
 *         cdef int n = len(args)
 *         cdef PrecalcShapeset s1, s2, s3, s4
 *         if n == 1:             # <<<<<<<<<<<<<<
 *             s1, = args
 *             self.thisptr.set_pss(n, s1.thisptr)
 */
  switch (__pyx_v_n) {
    case 1:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":915
 *         cdef PrecalcShapeset s1, s2, s3, s4
 *         if n == 1:
 *             s1, = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_pss(n, s1.thisptr)
 *         elif n == 2:
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 1)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":916
 *         if n == 1:
 *             s1, = args
 *             self.thisptr.set_pss(n, s1.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 2:
 *             s1, s2 = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_pss(__pyx_v_n, __pyx_v_s1->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":917
 *             s1, = args
 *             self.thisptr.set_pss(n, s1.thisptr)
 *         elif n == 2:             # <<<<<<<<<<<<<<
 *             s1, s2 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr)
 */
    case 2:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":918
 *             self.thisptr.set_pss(n, s1.thisptr)
 *         elif n == 2:
 *             s1, s2 = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr)
 *         elif n == 3:
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 2)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":919
 *         elif n == 2:
 *             s1, s2 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 3:
 *             s1, s2, s3 = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_pss(__pyx_v_n, __pyx_v_s1->thisptr, __pyx_v_s2->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":920
 *             s1, s2 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr)
 *         elif n == 3:             # <<<<<<<<<<<<<<
 *             s1, s2, s3 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr)
 */
    case 3:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":921
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr)
 *         elif n == 3:
 *             s1, s2, s3 = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr)
 *         elif n == 4:
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 3)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s3));
      __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_4);
      __pyx_4 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s3));
      __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_4);
      __pyx_4 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":922
 *         elif n == 3:
 *             s1, s2, s3 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr)             # <<<<<<<<<<<<<<
 *         elif n == 4:
 *             s1, s2, s3, s4 = args
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_pss(__pyx_v_n, __pyx_v_s1->thisptr, __pyx_v_s2->thisptr, __pyx_v_s3->thisptr);
    break;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":923
 *             s1, s2, s3 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr)
 *         elif n == 4:             # <<<<<<<<<<<<<<
 *             s1, s2, s3, s4 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr,
 */
    case 4:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":924
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr)
 *         elif n == 4:
 *             s1, s2, s3, s4 = args             # <<<<<<<<<<<<<<
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr,
 *                     s4.thisptr)
 */
    if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 4)) {
      PyObject* tuple = __pyx_v_args;
      __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_5 = PyTuple_GET_ITEM(tuple, 3); __Pyx_INCREF(__pyx_5);
      if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s3));
      __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_4);
      __pyx_4 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s4));
      __pyx_v_s4 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_5);
      __pyx_5 = 0;
    } else {
      __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_2);
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_3);
      if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_4);
      if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_5 = __Pyx_UnpackItem(__pyx_1, 3); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_5);
      if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_2);
      __pyx_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s2));
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_3);
      __pyx_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s3));
      __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_4);
      __pyx_4 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_v_s4));
      __pyx_v_s4 = ((struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset *)__pyx_5);
      __pyx_5 = 0;
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":926
 *             s1, s2, s3, s4 = args
 *             self.thisptr.set_pss(n, s1.thisptr, s2.thisptr, s3.thisptr,
 *                     s4.thisptr)             # <<<<<<<<<<<<<<
 *         else:
 *             raise NotImplementedError()
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->set_pss(__pyx_v_n, __pyx_v_s1->thisptr, __pyx_v_s2->thisptr, __pyx_v_s3->thisptr, __pyx_v_s4->thisptr);
    break;
    default:

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":928
 *                     s4.thisptr)
 *         else:
 *             raise NotImplementedError()             # <<<<<<<<<<<<<<
 * 
 *     def solve_system(self, *args, lib="scipy"):
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    break;
  }

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_4);
  __Pyx_XDECREF(__pyx_5);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.set_pss");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF((PyObject *)__pyx_v_s1);
  __Pyx_DECREF((PyObject *)__pyx_v_s2);
  __Pyx_DECREF((PyObject *)__pyx_v_s3);
  __Pyx_DECREF((PyObject *)__pyx_v_s4);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":930
 *             raise NotImplementedError()
 * 
 *     def solve_system(self, *args, lib="scipy"):             # <<<<<<<<<<<<<<
 *         """
 *         Solves the linear system using scipy.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_solve_system(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_9LinSystem_solve_system[] = "\n        Solves the linear system using scipy.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_solve_system(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_lib = 0;
  PyObject *__pyx_v_args = 0;
  int __pyx_v_n;
  struct __pyx_obj_8hermes2d_9_hermes2d_Solution *__pyx_v_s0;
  struct __pyx_obj_8hermes2d_9_hermes2d_Solution *__pyx_v_s1;
  struct __pyx_obj_8hermes2d_9_hermes2d_Solution *__pyx_v_s2;
  struct __pyx_obj_8hermes2d_9_hermes2d_Solution *__pyx_v_s3;
  PyArrayObject *__pyx_v_vec;
  scalar *__pyx_v_pvec;
  PyObject *__pyx_v_warnings;
  PyObject *__pyx_v_cg;
  PyObject *__pyx_v_spsolve;
  PyObject *__pyx_v_array;
  PyObject *__pyx_v_A;
  PyObject *__pyx_v_rhs;
  PyObject *__pyx_v___tmpvar_2;
  PyObject *__pyx_v___tmpvar_4;
  PyObject *__pyx_v___tmpvar_3;
  PyObject *__pyx_v___tmpvar_1;
  PyObject *__pyx_v_x;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_sln;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_lib,0};
  __Pyx_SetupRefcountContext("solve_system");
  if (PyTuple_GET_SIZE(__pyx_args) > 0) {
    __pyx_v_args = PyTuple_GetSlice(__pyx_args, 0, PyTuple_GET_SIZE(__pyx_args)); __Pyx_GOTREF(__pyx_v_args);
    if (unlikely(!__pyx_v_args)) return NULL;
  } else {
    __pyx_v_args = __pyx_empty_tuple; __Pyx_INCREF(__pyx_empty_tuple);
  }
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = __pyx_kp_34;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      default:
      case  0: break;
    }
    while (kw_args > 0) {
      PyObject* value;
      value = PyDict_GetItem(__pyx_kwds, __pyx_kp_lib);
      if (value) { values[0] = value; if (!(--kw_args)) break; }
      break;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, 0, "solve_system") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_lib = values[0];
  } else if (PyTuple_GET_SIZE(__pyx_args) < 0) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_lib = __pyx_kp_34;
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("solve_system", 0, 0, 0, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.solve_system");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_vec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
  __pyx_v_warnings = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_cg = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_spsolve = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_array = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_A = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_rhs = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v___tmpvar_2 = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v___tmpvar_4 = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v___tmpvar_3 = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v___tmpvar_1 = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_x = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_sln = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":934
 *         Solves the linear system using scipy.
 *         """
 *         cdef int n = len(args)             # <<<<<<<<<<<<<<
 * 
 *         cdef Solution s0, s1, s2, s3
 */
  __pyx_t_1 = PyObject_Length(__pyx_v_args); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_n = __pyx_t_1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":940
 *         cdef scalar *pvec
 * 
 *         if lib == "hermes":             # <<<<<<<<<<<<<<
 *             if n == 1:
 *                 s0 = args[0]
 */
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_lib, __pyx_kp_63, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":941
 * 
 *         if lib == "hermes":
 *             if n == 1:             # <<<<<<<<<<<<<<
 *                 s0 = args[0]
 *                 self.thisptr.solve(n, s0.thisptr)
 */
    switch (__pyx_v_n) {
      case 1:

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":942
 *         if lib == "hermes":
 *             if n == 1:
 *                 s0 = args[0]             # <<<<<<<<<<<<<<
 *                 self.thisptr.solve(n, s0.thisptr)
 *             elif n == 2:
 */
      __pyx_1 = __Pyx_GetItemInt(__pyx_v_args, 0, sizeof(long), PyInt_FromLong); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 942; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_1);
      if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 942; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_s0));
      __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_1);
      __pyx_1 = 0;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":943
 *             if n == 1:
 *                 s0 = args[0]
 *                 self.thisptr.solve(n, s0.thisptr)             # <<<<<<<<<<<<<<
 *             elif n == 2:
 *                 s0, s1 = args
 */
      ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->solve(__pyx_v_n, __pyx_v_s0->__pyx_base.__pyx_base.__pyx_base.thisptr);
      break;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":944
 *                 s0 = args[0]
 *                 self.thisptr.solve(n, s0.thisptr)
 *             elif n == 2:             # <<<<<<<<<<<<<<
 *                 s0, s1 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr)
 */
      case 2:

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":945
 *                 self.thisptr.solve(n, s0.thisptr)
 *             elif n == 2:
 *                 s0, s1 = args             # <<<<<<<<<<<<<<
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr)
 *             elif n == 3:
 */
      if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 2)) {
        PyObject* tuple = __pyx_v_args;
        __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
      } else {
        __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_1);
        __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
      }

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":946
 *             elif n == 2:
 *                 s0, s1 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr)             # <<<<<<<<<<<<<<
 *             elif n == 3:
 *                 s0, s1, s2 = args
 */
      ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->solve(__pyx_v_n, __pyx_v_s0->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s1->__pyx_base.__pyx_base.__pyx_base.thisptr);
      break;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":947
 *                 s0, s1 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr)
 *             elif n == 3:             # <<<<<<<<<<<<<<
 *                 s0, s1, s2 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr)
 */
      case 3:

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":948
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr)
 *             elif n == 3:
 *                 s0, s1, s2 = args             # <<<<<<<<<<<<<<
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr)
 *             elif n == 4:
 */
      if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 3)) {
        PyObject* tuple = __pyx_v_args;
        __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
        if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s2));
        __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_4);
        __pyx_4 = 0;
      } else {
        __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_1);
        __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_4);
        if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s2));
        __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_4);
        __pyx_4 = 0;
      }

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":949
 *             elif n == 3:
 *                 s0, s1, s2 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr)             # <<<<<<<<<<<<<<
 *             elif n == 4:
 *                 s0, s1, s2, s3 = args
 */
      ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->solve(__pyx_v_n, __pyx_v_s0->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s1->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s2->__pyx_base.__pyx_base.__pyx_base.thisptr);
      break;

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":950
 *                 s0, s1, s2 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr)
 *             elif n == 4:             # <<<<<<<<<<<<<<
 *                 s0, s1, s2, s3 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr,
 */
      case 4:

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":951
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr)
 *             elif n == 4:
 *                 s0, s1, s2, s3 = args             # <<<<<<<<<<<<<<
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr,
 *                         s3.thisptr)
 */
      if (PyTuple_CheckExact(__pyx_v_args) && likely(PyTuple_GET_SIZE(__pyx_v_args) == 4)) {
        PyObject* tuple = __pyx_v_args;
        __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
        if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_5 = PyTuple_GET_ITEM(tuple, 3); __Pyx_INCREF(__pyx_5);
        if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s2));
        __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_4);
        __pyx_4 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s3));
        __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_5);
        __pyx_5 = 0;
      } else {
        __pyx_1 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_1);
        __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_2);
        if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_3);
        if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_4);
        if (!(__Pyx_TypeTest(__pyx_4, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_5 = __Pyx_UnpackItem(__pyx_1, 3); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_5);
        if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_8hermes2d_9_hermes2d_Solution))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s0));
        __pyx_v_s0 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_2);
        __pyx_2 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s1));
        __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_3);
        __pyx_3 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s2));
        __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_4);
        __pyx_4 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_v_s3));
        __pyx_v_s3 = ((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_5);
        __pyx_5 = 0;
      }

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":953
 *                 s0, s1, s2, s3 = args
 *                 self.thisptr.solve(n, s0.thisptr, s1.thisptr, s2.thisptr,
 *                         s3.thisptr)             # <<<<<<<<<<<<<<
 *             else:
 *                 raise NotImplementedError()
 */
      ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->solve(__pyx_v_n, __pyx_v_s0->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s1->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s2->__pyx_base.__pyx_base.__pyx_base.thisptr, __pyx_v_s3->__pyx_base.__pyx_base.__pyx_base.thisptr);
      break;
      default:

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":955
 *                         s3.thisptr)
 *             else:
 *                 raise NotImplementedError()             # <<<<<<<<<<<<<<
 * 
 *         elif lib == "scipy":
 */
      __pyx_t_2 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_Raise(__pyx_t_2, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      break;
    }
    goto __pyx_L6;
  }

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":957
 *                 raise NotImplementedError()
 * 
 *         elif lib == "scipy":             # <<<<<<<<<<<<<<
 *             import warnings
 *             from scipy.sparse.linalg import cg
 */
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_lib, __pyx_kp_64, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":958
 * 
 *         elif lib == "scipy":
 *             import warnings             # <<<<<<<<<<<<<<
 *             from scipy.sparse.linalg import cg
 *             from scipy.sparse.linalg import spsolve
 */
    __pyx_1 = __Pyx_Import(__pyx_kp_warnings, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_v_warnings);
    __pyx_v_warnings = __pyx_1;
    __pyx_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":959
 *         elif lib == "scipy":
 *             import warnings
 *             from scipy.sparse.linalg import cg             # <<<<<<<<<<<<<<
 *             from scipy.sparse.linalg import spsolve
 *             from numpy import array
 */
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_kp_cg);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_cg);
    __Pyx_GIVEREF(__pyx_kp_cg);
    __pyx_2 = __Pyx_Import(__pyx_kp_65, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_kp_cg); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_3);
    __Pyx_DECREF(__pyx_v_cg);
    __pyx_v_cg = __pyx_3;
    __pyx_3 = 0;
    __Pyx_DECREF(__pyx_2); __pyx_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":960
 *             import warnings
 *             from scipy.sparse.linalg import cg
 *             from scipy.sparse.linalg import spsolve             # <<<<<<<<<<<<<<
 *             from numpy import array
 *             A = self.get_matrix()
 */
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_kp_spsolve);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_spsolve);
    __Pyx_GIVEREF(__pyx_kp_spsolve);
    __pyx_4 = __Pyx_Import(__pyx_kp_65, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_5 = PyObject_GetAttr(__pyx_4, __pyx_kp_spsolve); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_5);
    __Pyx_DECREF(__pyx_v_spsolve);
    __pyx_v_spsolve = __pyx_5;
    __pyx_5 = 0;
    __Pyx_DECREF(__pyx_4); __pyx_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":961
 *             from scipy.sparse.linalg import cg
 *             from scipy.sparse.linalg import spsolve
 *             from numpy import array             # <<<<<<<<<<<<<<
 *             A = self.get_matrix()
 *             rhs = self.get_rhs()
 */
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_kp_array);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_array);
    __Pyx_GIVEREF(__pyx_kp_array);
    __pyx_1 = __Pyx_Import(__pyx_kp_numpy, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_array); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_2);
    __Pyx_DECREF(__pyx_v_array);
    __pyx_v_array = __pyx_2;
    __pyx_2 = 0;
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":962
 *             from scipy.sparse.linalg import spsolve
 *             from numpy import array
 *             A = self.get_matrix()             # <<<<<<<<<<<<<<
 *             rhs = self.get_rhs()
 *             #x, res = cg(A, rhs)
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_matrix); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_A);
    __pyx_v_A = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":963
 *             from numpy import array
 *             A = self.get_matrix()
 *             rhs = self.get_rhs()             # <<<<<<<<<<<<<<
 *             #x, res = cg(A, rhs)
 *             # Ignore the warning in scipy:
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_rhs); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_rhs);
    __pyx_v_rhs = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":966
 *             #x, res = cg(A, rhs)
 *             # Ignore the warning in scipy:
 *             with warnings.catch_warnings():             # <<<<<<<<<<<<<<
 *                 warnings.simplefilter('ignore')
 *                 x = spsolve(A, rhs)
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_warnings, __pyx_kp_catch_warnings); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v___tmpvar_2);
    __pyx_v___tmpvar_2 = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "(tree fragment)":2
 * MGR = EXPR
 * EXIT = MGR.__exit__             # <<<<<<<<<<<<<<
 * MGR.__enter__()
 * EXC = True
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v___tmpvar_2, __pyx_kp___exit__); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_v___tmpvar_4);
    __pyx_v___tmpvar_4 = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "(tree fragment)":3
 * MGR = EXPR
 * EXIT = MGR.__exit__
 * MGR.__enter__()             # <<<<<<<<<<<<<<
 * EXC = True
 * try:
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v___tmpvar_2, __pyx_kp___enter__); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":966
 *             #x, res = cg(A, rhs)
 *             # Ignore the warning in scipy:
 *             with warnings.catch_warnings():             # <<<<<<<<<<<<<<
 *                 warnings.simplefilter('ignore')
 *                 x = spsolve(A, rhs)
 */
    __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_v___tmpvar_3);
    __pyx_v___tmpvar_3 = __pyx_t_2;
    __pyx_t_2 = 0;
    /*try:*/ {
      {
        PyObject *__pyx_save_exc_type, *__pyx_save_exc_value, *__pyx_save_exc_tb;
        __Pyx_ExceptionSave(&__pyx_save_exc_type, &__pyx_save_exc_value, &__pyx_save_exc_tb);
        __Pyx_XGOTREF(__pyx_save_exc_type);
        __Pyx_XGOTREF(__pyx_save_exc_value);
        __Pyx_XGOTREF(__pyx_save_exc_tb);
        /*try:*/ {
          __Pyx_INCREF(Py_None);
          __Pyx_DECREF(__pyx_v___tmpvar_1);
          __pyx_v___tmpvar_1 = Py_None;
          __pyx_t_2 = PyObject_GetAttr(__pyx_v_warnings, __pyx_kp_simplefilter); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L10_error;}
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L10_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_4));
          __Pyx_INCREF(__pyx_kp_66);
          PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_66);
          __Pyx_GIVEREF(__pyx_kp_66);
          __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L10_error;}
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L10_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_5));
          __Pyx_INCREF(__pyx_v_A);
          PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_A);
          __Pyx_GIVEREF(__pyx_v_A);
          __Pyx_INCREF(__pyx_v_rhs);
          PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_rhs);
          __Pyx_GIVEREF(__pyx_v_rhs);
          __pyx_t_4 = PyObject_Call(__pyx_v_spsolve, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L10_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_v_x);
          __pyx_v_x = __pyx_t_4;
          __pyx_t_4 = 0;
        }
        __Pyx_XDECREF(__pyx_save_exc_type); __pyx_save_exc_type = 0;
        __Pyx_XDECREF(__pyx_save_exc_value); __pyx_save_exc_value = 0;
        __Pyx_XDECREF(__pyx_save_exc_tb); __pyx_save_exc_tb = 0;
        goto __pyx_L17_try_end;
        __pyx_L10_error:;
        __Pyx_XDECREF(__pyx_3); __pyx_3 = 0;
        __Pyx_XDECREF(__pyx_4); __pyx_4 = 0;
        __Pyx_XDECREF(__pyx_5); __pyx_5 = 0;
        __Pyx_XDECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_XDECREF(__pyx_2); __pyx_2 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        /*except:*/ {
          __Pyx_AddTraceback("hermes2d._hermes2d.solve_system");
          if (__Pyx_GetException(&__pyx_3, &__pyx_4, &__pyx_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_GOTREF(__pyx_3);
          __Pyx_GOTREF(__pyx_4);
          __Pyx_GOTREF(__pyx_5);
          __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_t_4));
          __Pyx_INCREF(__pyx_3);
          PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_3);
          __Pyx_GIVEREF(__pyx_3);
          __Pyx_INCREF(__pyx_4);
          PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_4);
          __Pyx_GIVEREF(__pyx_4);
          __Pyx_INCREF(__pyx_5);
          PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_5);
          __Pyx_GIVEREF(__pyx_5);
          __Pyx_DECREF(__pyx_v___tmpvar_1);
          __pyx_v___tmpvar_1 = ((PyObject *)__pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_v___tmpvar_3);
          __pyx_v___tmpvar_3 = __pyx_t_4;
          __pyx_t_4 = 0;

          /* "(tree fragment)":11
 *     except:
 *         EXC = False
 *         if not EXIT(*EXCINFO):             # <<<<<<<<<<<<<<
 *             raise
 * finally:
 */
          __pyx_1 = PySequence_Tuple(__pyx_v___tmpvar_1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_GOTREF(((PyObject *)__pyx_1));
          __pyx_t_4 = PyObject_Call(__pyx_v___tmpvar_4, ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
          __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_6 = (!__pyx_t_3);
          if (__pyx_t_6) {

            /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":966
 *             #x, res = cg(A, rhs)
 *             # Ignore the warning in scipy:
 *             with warnings.catch_warnings():             # <<<<<<<<<<<<<<
 *                 warnings.simplefilter('ignore')
 *                 x = spsolve(A, rhs)
 */
            __Pyx_Raise(__pyx_3, __pyx_4, __pyx_5);
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}
            goto __pyx_L20;
          }
          __pyx_L20:;
          __Pyx_DECREF(__pyx_3); __pyx_3 = 0;
          __Pyx_DECREF(__pyx_4); __pyx_4 = 0;
          __Pyx_DECREF(__pyx_5); __pyx_5 = 0;
          goto __pyx_L11_exception_handled;
        }
        __pyx_L12_except_error:;
        __Pyx_XDECREF(__pyx_save_exc_type);
        __Pyx_XDECREF(__pyx_save_exc_value);
        __Pyx_XDECREF(__pyx_save_exc_tb);
        goto __pyx_L8;
        __pyx_L11_exception_handled:;
        __Pyx_XGIVEREF(__pyx_save_exc_type);
        __Pyx_XGIVEREF(__pyx_save_exc_value);
        __Pyx_XGIVEREF(__pyx_save_exc_tb);
        __Pyx_ExceptionReset(__pyx_save_exc_type, __pyx_save_exc_value, __pyx_save_exc_tb);
        __pyx_L17_try_end:;
      }
    }
    /*finally:*/ {
      int __pyx_why;
      PyObject *__pyx_exc_type, *__pyx_exc_value, *__pyx_exc_tb;
      int __pyx_exc_lineno;
      __pyx_exc_type = 0; __pyx_exc_value = 0; __pyx_exc_tb = 0; __pyx_exc_lineno = 0;
      __pyx_why = 0; goto __pyx_L9;
      __pyx_L8: {
        __pyx_why = 4;
        __Pyx_XDECREF(__pyx_2); __pyx_2 = 0;
        __Pyx_XDECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_XDECREF(__pyx_3); __pyx_3 = 0;
        __Pyx_XDECREF(__pyx_4); __pyx_4 = 0;
        __Pyx_XDECREF(__pyx_5); __pyx_5 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_ErrFetch(&__pyx_exc_type, &__pyx_exc_value, &__pyx_exc_tb);
        __pyx_exc_lineno = __pyx_lineno;
        goto __pyx_L9;
      }
      __pyx_L9:;

      /* "(tree fragment)":14
 *             raise
 * finally:
 *     if EXC:             # <<<<<<<<<<<<<<
 *         EXIT(None, None, None)
 */
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v___tmpvar_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L21_error;}
      if (__pyx_t_6) {

        /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":966
 *             #x, res = cg(A, rhs)
 *             # Ignore the warning in scipy:
 *             with warnings.catch_warnings():             # <<<<<<<<<<<<<<
 *                 warnings.simplefilter('ignore')
 *                 x = spsolve(A, rhs)
 */
        __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L21_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_4));
        __Pyx_INCREF(Py_None);
        PyTuple_SET_ITEM(__pyx_t_4, 0, Py_None);
        __Pyx_GIVEREF(Py_None);
        __Pyx_INCREF(Py_None);
        PyTuple_SET_ITEM(__pyx_t_4, 1, Py_None);
        __Pyx_GIVEREF(Py_None);
        __Pyx_INCREF(Py_None);
        PyTuple_SET_ITEM(__pyx_t_4, 2, Py_None);
        __Pyx_GIVEREF(Py_None);
        __pyx_t_5 = PyObject_Call(__pyx_v___tmpvar_4, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L21_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        goto __pyx_L22;
      }
      __pyx_L22:;
      goto __pyx_L23;
      __pyx_L21_error:;
      if (__pyx_why == 4) {
        Py_XDECREF(__pyx_exc_type);
        Py_XDECREF(__pyx_exc_value);
        Py_XDECREF(__pyx_exc_tb);
      }
      goto __pyx_L1_error;
      __pyx_L23:;
      switch (__pyx_why) {
        case 4: {
          __Pyx_ErrRestore(__pyx_exc_type, __pyx_exc_value, __pyx_exc_tb);
          __pyx_lineno = __pyx_exc_lineno;
          __pyx_exc_type = 0;
          __pyx_exc_value = 0;
          __pyx_exc_tb = 0;
          goto __pyx_L1_error;
        }
      }
    }

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":969
 *                 warnings.simplefilter('ignore')
 *                 x = spsolve(A, rhs)
 *             vec = array(x, dtype="double")             # <<<<<<<<<<<<<<
 *             pvec = <scalar *>vec.data
 * 
 */
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_INCREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    __pyx_2 = PyDict_New(); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_2));
    if (PyDict_SetItem(__pyx_2, __pyx_kp_dtype, __pyx_kp_67) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_v_array, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
    if (!(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_v_vec));
    __pyx_v_vec = ((PyArrayObject *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":970
 *                 x = spsolve(A, rhs)
 *             vec = array(x, dtype="double")
 *             pvec = <scalar *>vec.data             # <<<<<<<<<<<<<<
 * 
 *             for i, sln in enumerate(args):
 */
    __pyx_v_pvec = ((scalar *)__pyx_v_vec->data);

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":972
 *             pvec = <scalar *>vec.data
 * 
 *             for i, sln in enumerate(args):             # <<<<<<<<<<<<<<
 *                 (<c_Solution *>((<Solution>sln).thisptr)).set_fe_solution(
 *                         self.thisptr.get_space(i),
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_args);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    __pyx_t_5 = PyObject_Call(__pyx_builtin_enumerate, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    if (PyList_CheckExact(__pyx_t_5) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_1 = 0; __pyx_t_4 = __pyx_t_5; __Pyx_INCREF(__pyx_t_4);
    } else {
      __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4)) break;
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++;
      } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
        if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++;
      } else {
        __pyx_t_5 = PyIter_Next(__pyx_t_4);
        if (!__pyx_t_5) {
          if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      if (PyTuple_CheckExact(__pyx_t_5) && likely(PyTuple_GET_SIZE(__pyx_t_5) == 2)) {
        PyObject* tuple = __pyx_t_5;
        __pyx_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_3);
        __pyx_4 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_4);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_v_i);
        __pyx_v_i = __pyx_3;
        __pyx_3 = 0;
        __Pyx_DECREF(__pyx_v_sln);
        __pyx_v_sln = __pyx_4;
        __pyx_4 = 0;
      } else {
        __pyx_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_1);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_3 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_3);
        __pyx_4 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_4);
        if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
        __Pyx_DECREF(__pyx_v_i);
        __pyx_v_i = __pyx_3;
        __pyx_3 = 0;
        __Pyx_DECREF(__pyx_v_sln);
        __pyx_v_sln = __pyx_4;
        __pyx_4 = 0;
      }

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":974
 *             for i, sln in enumerate(args):
 *                 (<c_Solution *>((<Solution>sln).thisptr)).set_fe_solution(
 *                         self.thisptr.get_space(i),             # <<<<<<<<<<<<<<
 *                         self.thisptr.get_pss(i),
 *                         pvec)
 */
      __pyx_t_7 = __Pyx_PyInt_AsInt(__pyx_v_i); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":975
 *                 (<c_Solution *>((<Solution>sln).thisptr)).set_fe_solution(
 *                         self.thisptr.get_space(i),
 *                         self.thisptr.get_pss(i),             # <<<<<<<<<<<<<<
 *                         pvec)
 *         else:
 */
      __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_i); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":976
 *                         self.thisptr.get_space(i),
 *                         self.thisptr.get_pss(i),
 *                         pvec)             # <<<<<<<<<<<<<<
 *         else:
 *             raise NotImplementedError("Unknown library")
 */
      ((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_v_sln)->__pyx_base.__pyx_base.__pyx_base.thisptr)->set_fe_solution(((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->get_space(__pyx_t_7), ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->get_pss(__pyx_t_8), __pyx_v_pvec);
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":978
 *                         pvec)
 *         else:
 *             raise NotImplementedError("Unknown library")             # <<<<<<<<<<<<<<
 * 
 *     def assemble(self):
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 978; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_kp_68);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_68);
    __Pyx_GIVEREF(__pyx_kp_68);
    __pyx_t_5 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 978; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_5, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 978; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_4);
  __Pyx_XDECREF(__pyx_5);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.solve_system");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF((PyObject *)__pyx_v_s0);
  __Pyx_DECREF((PyObject *)__pyx_v_s1);
  __Pyx_DECREF((PyObject *)__pyx_v_s2);
  __Pyx_DECREF((PyObject *)__pyx_v_s3);
  __Pyx_DECREF((PyObject *)__pyx_v_vec);
  __Pyx_DECREF(__pyx_v_warnings);
  __Pyx_DECREF(__pyx_v_cg);
  __Pyx_DECREF(__pyx_v_spsolve);
  __Pyx_DECREF(__pyx_v_array);
  __Pyx_DECREF(__pyx_v_A);
  __Pyx_DECREF(__pyx_v_rhs);
  __Pyx_DECREF(__pyx_v___tmpvar_2);
  __Pyx_DECREF(__pyx_v___tmpvar_4);
  __Pyx_DECREF(__pyx_v___tmpvar_3);
  __Pyx_DECREF(__pyx_v___tmpvar_1);
  __Pyx_DECREF(__pyx_v_x);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_sln);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":980
 *             raise NotImplementedError("Unknown library")
 * 
 *     def assemble(self):             # <<<<<<<<<<<<<<
 *         self.thisptr.assemble()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_assemble(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_assemble(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("assemble");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":981
 * 
 *     def assemble(self):
 *         self.thisptr.assemble()             # <<<<<<<<<<<<<<
 * 
 *     def get_matrix_csc(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->assemble();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":983
 *         self.thisptr.assemble()
 * 
 *     def get_matrix_csc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the matrix A as a (Ap, Ai, Ax) tuple.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix_csc(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_matrix_csc[] = "\n        Returns the matrix A as a (Ap, Ai, Ax) tuple.\n\n        See also DiscreteProblem.get_matrix() to get a SciPy matrix.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix_csc(PyObject *__pyx_v_self, PyObject *unused) {
  int *__pyx_v_Ap;
  int *__pyx_v_Ai;
  int __pyx_v_n;
  int __pyx_v_nnz;
  scalar *__pyx_v_Ax;
  PyObject *__pyx_v_aAp;
  PyObject *__pyx_v_aAi;
  PyObject *__pyx_v_aAx;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_matrix_csc");
  __pyx_v_aAp = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_aAi = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_aAx = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":991
 *         cdef int *Ap, *Ai, n, nnz
 *         cdef scalar *Ax
 *         self.thisptr.get_matrix(Ap, Ai, Ax, n)             # <<<<<<<<<<<<<<
 *         nnz = Ap[n]
 *         aAp = c2numpy_int(Ap, n+1)
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->get_matrix(__pyx_v_Ap, __pyx_v_Ai, __pyx_v_Ax, __pyx_v_n);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":992
 *         cdef scalar *Ax
 *         self.thisptr.get_matrix(Ap, Ai, Ax, n)
 *         nnz = Ap[n]             # <<<<<<<<<<<<<<
 *         aAp = c2numpy_int(Ap, n+1)
 *         aAi = c2numpy_int(Ai, nnz)
 */
  __pyx_v_nnz = (__pyx_v_Ap[__pyx_v_n]);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":993
 *         self.thisptr.get_matrix(Ap, Ai, Ax, n)
 *         nnz = Ap[n]
 *         aAp = c2numpy_int(Ap, n+1)             # <<<<<<<<<<<<<<
 *         aAi = c2numpy_int(Ai, nnz)
 *         aAx = c2numpy_double(Ax, nnz)
 */
  __pyx_t_1 = c2numpy_int(__pyx_v_Ap, (__pyx_v_n + 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_aAp);
  __pyx_v_aAp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":994
 *         nnz = Ap[n]
 *         aAp = c2numpy_int(Ap, n+1)
 *         aAi = c2numpy_int(Ai, nnz)             # <<<<<<<<<<<<<<
 *         aAx = c2numpy_double(Ax, nnz)
 *         return aAp, aAi, aAx
 */
  __pyx_t_1 = c2numpy_int(__pyx_v_Ai, __pyx_v_nnz); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_aAi);
  __pyx_v_aAi = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":995
 *         aAp = c2numpy_int(Ap, n+1)
 *         aAi = c2numpy_int(Ai, nnz)
 *         aAx = c2numpy_double(Ax, nnz)             # <<<<<<<<<<<<<<
 *         return aAp, aAi, aAx
 * 
 */
  __pyx_t_1 = c2numpy_double(__pyx_v_Ax, __pyx_v_nnz); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 995; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_aAx);
  __pyx_v_aAx = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":996
 *         aAi = c2numpy_int(Ai, nnz)
 *         aAx = c2numpy_double(Ax, nnz)
 *         return aAp, aAi, aAx             # <<<<<<<<<<<<<<
 * 
 *     def get_matrix(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 996; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_aAp);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_aAp);
  __Pyx_GIVEREF(__pyx_v_aAp);
  __Pyx_INCREF(__pyx_v_aAi);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_aAi);
  __Pyx_GIVEREF(__pyx_v_aAi);
  __Pyx_INCREF(__pyx_v_aAx);
  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_aAx);
  __Pyx_GIVEREF(__pyx_v_aAx);
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.get_matrix_csc");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_aAp);
  __Pyx_DECREF(__pyx_v_aAi);
  __Pyx_DECREF(__pyx_v_aAx);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":998
 *         return aAp, aAi, aAx
 * 
 *     def get_matrix(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the global matrix A as a SciPy matrix.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_matrix[] = "\n        Returns the global matrix A as a SciPy matrix.\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_v_csc_matrix;
  PyObject *__pyx_v_Ap;
  PyObject *__pyx_v_Ai;
  PyObject *__pyx_v_Ax;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_SetupRefcountContext("get_matrix");
  __pyx_v_csc_matrix = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_Ap = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_Ai = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_Ax = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1002
 *         Returns the global matrix A as a SciPy matrix.
 *         """
 *         from scipy.sparse import csc_matrix             # <<<<<<<<<<<<<<
 *         Ap, Ai, Ax = self.get_matrix_csc()
 *         return csc_matrix((Ax, Ai, Ap))
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_kp_csc_matrix);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_csc_matrix);
  __Pyx_GIVEREF(__pyx_kp_csc_matrix);
  __pyx_1 = __Pyx_Import(__pyx_kp_69, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_csc_matrix); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __Pyx_DECREF(__pyx_v_csc_matrix);
  __pyx_v_csc_matrix = __pyx_2;
  __pyx_2 = 0;
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1003
 *         """
 *         from scipy.sparse import csc_matrix
 *         Ap, Ai, Ax = self.get_matrix_csc()             # <<<<<<<<<<<<<<
 *         return csc_matrix((Ax, Ai, Ap))
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp_get_matrix_csc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyTuple_CheckExact(__pyx_t_2) && likely(PyTuple_GET_SIZE(__pyx_t_2) == 3)) {
    PyObject* tuple = __pyx_t_2;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_2);
    __pyx_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_3);
    __pyx_4 = PyTuple_GET_ITEM(tuple, 2); __Pyx_INCREF(__pyx_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_Ap);
    __pyx_v_Ap = __pyx_2;
    __pyx_2 = 0;
    __Pyx_DECREF(__pyx_v_Ai);
    __pyx_v_Ai = __pyx_3;
    __pyx_3 = 0;
    __Pyx_DECREF(__pyx_v_Ax);
    __pyx_v_Ax = __pyx_4;
    __pyx_4 = 0;
  } else {
    __pyx_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_2);
    __pyx_3 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_3);
    __pyx_4 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_4);
    if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_DECREF(__pyx_v_Ap);
    __pyx_v_Ap = __pyx_2;
    __pyx_2 = 0;
    __Pyx_DECREF(__pyx_v_Ai);
    __pyx_v_Ai = __pyx_3;
    __pyx_3 = 0;
    __Pyx_DECREF(__pyx_v_Ax);
    __pyx_v_Ax = __pyx_4;
    __pyx_4 = 0;
  }

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1004
 *         from scipy.sparse import csc_matrix
 *         Ap, Ai, Ax = self.get_matrix_csc()
 *         return csc_matrix((Ax, Ai, Ap))             # <<<<<<<<<<<<<<
 * 
 *     def get_rhs(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_Ax);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_Ax);
  __Pyx_GIVEREF(__pyx_v_Ax);
  __Pyx_INCREF(__pyx_v_Ai);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_Ai);
  __Pyx_GIVEREF(__pyx_v_Ai);
  __Pyx_INCREF(__pyx_v_Ap);
  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_Ap);
  __Pyx_GIVEREF(__pyx_v_Ap);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_t_2));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_v_csc_matrix, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_3);
  __Pyx_XDECREF(__pyx_4);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.get_matrix");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_csc_matrix);
  __Pyx_DECREF(__pyx_v_Ap);
  __Pyx_DECREF(__pyx_v_Ai);
  __Pyx_DECREF(__pyx_v_Ax);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1006
 *         return csc_matrix((Ax, Ai, Ap))
 * 
 *     def get_rhs(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the RHS as a numpy array
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_rhs(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_rhs[] = "\n        Return the RHS as a numpy array\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_rhs(PyObject *__pyx_v_self, PyObject *unused) {
  scalar *__pyx_v_rhs;
  int __pyx_v_n;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_rhs");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1012
 *         cdef scalar *rhs
 *         cdef int n
 *         self.thisptr.get_rhs(rhs, n)             # <<<<<<<<<<<<<<
 *         return c2numpy_double(rhs, n)
 * 
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)__pyx_v_self)->thisptr->get_rhs(__pyx_v_rhs, __pyx_v_n);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1013
 *         cdef int n
 *         self.thisptr.get_rhs(rhs, n)
 *         return c2numpy_double(rhs, n)             # <<<<<<<<<<<<<<
 * 
 * cdef class RefSystem(LinSystem):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = c2numpy_double(__pyx_v_rhs, __pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1013; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.LinSystem.get_rhs");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1017
 * cdef class RefSystem(LinSystem):
 * 
 *     def __init__(self, LinSystem ls):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_LinSystem *>new_RefSystem(ls.thisptr)
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_9RefSystem___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_9RefSystem___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *__pyx_v_ls = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_ls,0};
  __Pyx_SetupRefcountContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_ls);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1017; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_ls = ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)values[0]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_ls = ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)PyTuple_GET_ITEM(__pyx_args, 0));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1017; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.RefSystem.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_ls), __pyx_ptype_8hermes2d_9_hermes2d_LinSystem, 1, "ls", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1017; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1018
 * 
 *     def __init__(self, LinSystem ls):
 *         self.thisptr = <c_LinSystem *>new_RefSystem(ls.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def assemble(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_RefSystem *)__pyx_v_self)->__pyx_base.thisptr = ((struct LinSystem *)new RefSystem(__pyx_v_ls->thisptr));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.RefSystem.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1020
 *         self.thisptr = <c_LinSystem *>new_RefSystem(ls.thisptr)
 * 
 *     def assemble(self):             # <<<<<<<<<<<<<<
 *         (<c_RefSystem *>(self.thisptr)).assemble()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9RefSystem_assemble(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9RefSystem_assemble(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("assemble");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1021
 * 
 *     def assemble(self):
 *         (<c_RefSystem *>(self.thisptr)).assemble()             # <<<<<<<<<<<<<<
 * 
 *     # this is commented out, because get_ref_space() is not yet implemented in
 */
  ((struct RefSystem *)((struct __pyx_obj_8hermes2d_9_hermes2d_RefSystem *)__pyx_v_self)->__pyx_base.thisptr)->assemble();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1199
 * 	use derived classes H1ProjBasedSelector and L2ProjBasedSelector instead.
 *     """
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1202
 *         pass
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1203
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def set_error_weights(self, double weight_h, double weight_p, double weight_aniso):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1205
 *         delete(self.thisptr)
 * 
 *     def set_error_weights(self, double weight_h, double weight_p, double weight_aniso):             # <<<<<<<<<<<<<<
 *         """ Sets error weights.
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_error_weights(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_17ProjBasedSelector_set_error_weights[] = " Sets error weights.\n        \n\t    An error weight is a multiplicative coefficient that modifies an error of candidate.\n\t    Default wieghts are:\n\n\t    - H-candidate weight: 2.0\n\t    - P-candidate weight: 1.0\n\t    - ANISO-candidate weight: 1.4142\n\n\t    Suggested Use:\n\n\t    - settings the default weights: ```selector.set_error_weights(2.0, 1.0, 1.4142)```\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_error_weights(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_weight_h;
  double __pyx_v_weight_p;
  double __pyx_v_weight_aniso;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_weight_h,&__pyx_kp_weight_p,&__pyx_kp_weight_aniso,0};
  __Pyx_SetupRefcountContext("set_error_weights");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_weight_h);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_weight_p);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_error_weights", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_weight_aniso);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_error_weights", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_error_weights") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_weight_h = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_weight_p = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_weight_aniso = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_weight_h = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_weight_p = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_weight_aniso = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_error_weights", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ProjBasedSelector.set_error_weights");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1219
 * 	    - settings the default weights: ```selector.set_error_weights(2.0, 1.0, 1.4142)```
 *         """
 *         self.thisptr.set_error_weights(weight_h, weight_p, weight_aniso)             # <<<<<<<<<<<<<<
 * 
 *     def set_option(self, int option, int enable):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *)__pyx_v_self)->thisptr->set_error_weights(__pyx_v_weight_h, __pyx_v_weight_p, __pyx_v_weight_aniso);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1221
 *         self.thisptr.set_error_weights(weight_h, weight_p, weight_aniso)
 * 
 *     def set_option(self, int option, int enable):             # <<<<<<<<<<<<<<
 *         """ Enables or disables an option.
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_option(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_17ProjBasedSelector_set_option[] = " Enables or disables an option.\n\n\t    Suggested Use:\n\n\t    - enabling an option ``PREFER_SYMMETRIC_MESH``: ``selector.set_option(SelOption.PREFER_SYMMETRIC_MESH, true)``\n\t    - disabling an option ``APPLY_CONV_EXP_DOF``: ``selector.set_optin(SelOption.APPLY_CONV_EXP_DOF, false)``\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_option(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_option;
  int __pyx_v_enable;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_option,&__pyx_kp_enable,0};
  __Pyx_SetupRefcountContext("set_option");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_option);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_enable);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_option", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_option") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_option = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_option == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_enable = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_enable == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_option = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_option == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_enable = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_enable == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_option", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ProjBasedSelector.set_option");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1229
 * 	    - disabling an option ``APPLY_CONV_EXP_DOF``: ``selector.set_optin(SelOption.APPLY_CONV_EXP_DOF, false)``
 * 	"""
 *         self.thisptr.set_option(<c_SelOption>option, enable)             # <<<<<<<<<<<<<<
 * 
 * cdef class H1ProjBasedSelector(ProjBasedSelector):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *)__pyx_v_self)->thisptr->set_option(((RefinementSelectors::SelOption)__pyx_v_option), __pyx_v_enable);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1246
 * 	- ```h1_shapeset``` expects an instance of the class H1Shapeset.
 *     """
 *     def __cinit__(self, int cand_list, double conv_exp, int max_order, H1Shapeset shapeset):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_ProjBasedSelector*>(new_H1ProjBasedSelector(<c_CandList>cand_list, conv_exp, max_order, shapeset.thisptr))
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_19H1ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_19H1ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_cand_list;
  double __pyx_v_conv_exp;
  int __pyx_v_max_order;
  struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *__pyx_v_shapeset = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_cand_list,&__pyx_kp_conv_exp,&__pyx_kp_max_order,&__pyx_kp_shapeset,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_cand_list);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_conv_exp);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_order);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_shapeset);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_cand_list = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_cand_list == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_conv_exp = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_order = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_max_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_shapeset = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)values[3]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_cand_list = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_cand_list == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_conv_exp = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_order = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_max_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_shapeset = ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset *)PyTuple_GET_ITEM(__pyx_args, 3));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1ProjBasedSelector.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shapeset), __pyx_ptype_8hermes2d_9_hermes2d_H1Shapeset, 1, "shapeset", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1247
 *     """
 *     def __cinit__(self, int cand_list, double conv_exp, int max_order, H1Shapeset shapeset):
 *         self.thisptr = <c_ProjBasedSelector*>(new_H1ProjBasedSelector(<c_CandList>cand_list, conv_exp, max_order, shapeset.thisptr))             # <<<<<<<<<<<<<<
 * 
 * cdef class L2ProjBasedSelector(ProjBasedSelector):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1ProjBasedSelector *)__pyx_v_self)->__pyx_base.thisptr = ((RefinementSelectors::ProjBasedSelector *)new RefinementSelectors::H1ProjBasedSelector(((RefinementSelectors::CandList)__pyx_v_cand_list), __pyx_v_conv_exp, __pyx_v_max_order, __pyx_v_shapeset->thisptr));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1ProjBasedSelector.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1264
 * 	- ```l2_shapeset``` expects an instance of the class L2Shapeset.
 *     """
 *     def __cinit__(self, int cand_list, double conv_exp, int max_order, L2Shapeset shapeset):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_ProjBasedSelector*>(new_L2ProjBasedSelector(<c_CandList>cand_list, conv_exp, max_order, shapeset.thisptr))
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_19L2ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_19L2ProjBasedSelector___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_cand_list;
  double __pyx_v_conv_exp;
  int __pyx_v_max_order;
  struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *__pyx_v_shapeset = 0;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_cand_list,&__pyx_kp_conv_exp,&__pyx_kp_max_order,&__pyx_kp_shapeset,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_cand_list);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_conv_exp);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_order);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_shapeset);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_cand_list = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_cand_list == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_conv_exp = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_order = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_max_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_shapeset = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)values[3]);
  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_cand_list = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_cand_list == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_conv_exp = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_order = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_max_order == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_shapeset = ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset *)PyTuple_GET_ITEM(__pyx_args, 3));
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2ProjBasedSelector.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shapeset), __pyx_ptype_8hermes2d_9_hermes2d_L2Shapeset, 1, "shapeset", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1265
 *     """
 *     def __cinit__(self, int cand_list, double conv_exp, int max_order, L2Shapeset shapeset):
 *         self.thisptr = <c_ProjBasedSelector*>(new_L2ProjBasedSelector(<c_CandList>cand_list, conv_exp, max_order, shapeset.thisptr))             # <<<<<<<<<<<<<<
 * 
 * cdef class Adapt:
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2ProjBasedSelector *)__pyx_v_self)->__pyx_base.thisptr = ((RefinementSelectors::ProjBasedSelector *)new RefinementSelectors::L2ProjBasedSelector(((RefinementSelectors::CandList)__pyx_v_cand_list), __pyx_v_conv_exp, __pyx_v_max_order, __pyx_v_shapeset->thisptr));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2ProjBasedSelector.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1270
 *     """ A base class for adaptivity. Adaptivity provides framework for modyfying elements in order to decrease errors of the solution.
 *         Do not use this class directly, use derived classes H1Adapt and L2Adapt instead."""
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_5Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_5Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1273
 *         pass
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_5Adapt___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_5Adapt___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1274
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def set_solutions(self, sln_list, rsln_list):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_Adapt *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1276
 *         delete(self.thisptr)
 * 
 *     def set_solutions(self, sln_list, rsln_list):             # <<<<<<<<<<<<<<
 *         """ Sets coarse solutions and reference solutions.
 * 	    This method has to be called before the method calc_error().
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_set_solutions(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_5Adapt_set_solutions[] = " Sets coarse solutions and reference solutions.\n\t    This method has to be called before the method calc_error().\n\n\t    Suggested Use:\n\n\t    - single component: ```hp.set_solutions([sln1], [rsln1])```\n\t    - multiple components: ```hp.set_solutions([sln1, sln2], [rsl1, rsln2])```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_set_solutions(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sln_list = 0;
  PyObject *__pyx_v_rsln_list = 0;
  Tuple<Solution*> __pyx_v_slns;
  Tuple<Solution*> __pyx_v_rslns;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_t_1;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_sln_list,&__pyx_kp_rsln_list,0};
  __Pyx_SetupRefcountContext("set_solutions");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_sln_list);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_rsln_list);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_solutions", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_solutions") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln_list = values[0];
    __pyx_v_rsln_list = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_sln_list = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_rsln_list = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_solutions", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.set_solutions");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1287
 *         cdef c_SolutionTuple slns
 *         cdef c_SolutionTuple rslns
 *         for i in range(len(sln_list)):             # <<<<<<<<<<<<<<
 *             slns.push_back(<c_Solution*>((<Solution>(sln_list[i])).thisptr))
 *         for i in range(len(rsln_list)):
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_sln_list); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1288
 *         cdef c_SolutionTuple rslns
 *         for i in range(len(sln_list)):
 *             slns.push_back(<c_Solution*>((<Solution>(sln_list[i])).thisptr))             # <<<<<<<<<<<<<<
 *         for i in range(len(rsln_list)):
 *             rslns.push_back(<c_Solution*>((<Solution>(rsln_list[i])).thisptr))
 */
    __pyx_1 = PyObject_GetItem(__pyx_v_sln_list, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __pyx_v_slns.push_back(((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_1)->__pyx_base.__pyx_base.__pyx_base.thisptr));
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1289
 *         for i in range(len(sln_list)):
 *             slns.push_back(<c_Solution*>((<Solution>(sln_list[i])).thisptr))
 *         for i in range(len(rsln_list)):             # <<<<<<<<<<<<<<
 *             rslns.push_back(<c_Solution*>((<Solution>(rsln_list[i])).thisptr))
 *         self.thisptr.set_solutions(slns, rslns)
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_rsln_list); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_4) || PyTuple_CheckExact(__pyx_t_4)) {
    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_4; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_4); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_4); __pyx_t_1++;
    } else {
      __pyx_t_4 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_4) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1290
 *             slns.push_back(<c_Solution*>((<Solution>(sln_list[i])).thisptr))
 *         for i in range(len(rsln_list)):
 *             rslns.push_back(<c_Solution*>((<Solution>(rsln_list[i])).thisptr))             # <<<<<<<<<<<<<<
 *         self.thisptr.set_solutions(slns, rslns)
 * 
 */
    __pyx_1 = PyObject_GetItem(__pyx_v_rsln_list, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __pyx_v_rslns.push_back(((struct Solution *)((struct __pyx_obj_8hermes2d_9_hermes2d_Solution *)__pyx_1)->__pyx_base.__pyx_base.__pyx_base.thisptr));
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1291
 *         for i in range(len(rsln_list)):
 *             rslns.push_back(<c_Solution*>((<Solution>(rsln_list[i])).thisptr))
 *         self.thisptr.set_solutions(slns, rslns)             # <<<<<<<<<<<<<<
 * 
 *     def calc_error(self, int error_flags = H2D_TOTAL_ERROR_REL | H2D_ELEMENT_ERROR_ABS):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Adapt *)__pyx_v_self)->thisptr->set_solutions(__pyx_v_slns, __pyx_v_rslns);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.set_solutions");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1293
 *         self.thisptr.set_solutions(slns, rslns)
 * 
 *     def calc_error(self, int error_flags = H2D_TOTAL_ERROR_REL | H2D_ELEMENT_ERROR_ABS):             # <<<<<<<<<<<<<<
 *         """ Calculates errors of elements and returns a total error.
 * 	    This method has to be called before the method adapt().
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_calc_error(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_5Adapt_calc_error[] = " Calculates errors of elements and returns a total error.\n\t    This method has to be called before the method adapt().\n\n\t    Suggested Use: ```err_percent = hp.calc_error() * 100```\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_calc_error(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_error_flags;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_error_flags,0};
  __Pyx_SetupRefcountContext("calc_error");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_error_flags);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "calc_error") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_error_flags = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_error_flags == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_error_flags = __pyx_k_35;
    }
  } else {
    __pyx_v_error_flags = __pyx_k_35;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_error_flags = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_error_flags == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calc_error", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.calc_error");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1299
 * 	    Suggested Use: ```err_percent = hp.calc_error() * 100```
 * 	"""
 *         return self.thisptr.calc_error(error_flags)             # <<<<<<<<<<<<<<
 * 
 *     def adapt(self, ProjBasedSelector selector, double thr, int strat = 0, int regularize = -1, int same_orders = 0, double to_be_processed = 0.0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Adapt *)__pyx_v_self)->thisptr->calc_error(__pyx_v_error_flags)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.calc_error");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1301
 *         return self.thisptr.calc_error(error_flags)
 * 
 *     def adapt(self, ProjBasedSelector selector, double thr, int strat = 0, int regularize = -1, int same_orders = 0, double to_be_processed = 0.0):             # <<<<<<<<<<<<<<
 *         """ Does adaptive refinement based on errors of elements.
 * 	    Refinements are selected using a supplied selector.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_adapt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_5Adapt_adapt[] = " Does adaptive refinement based on errors of elements.\n\t    Refinements are selected using a supplied selector.\n\n\t    Returns ```True``` if no element was refined.\n\n\t    Suggested Use:\n\t    \n\t        ```hp.adapt(selector, thr, strat, regularize, same_order, to_be_processed)```\n\n\t    where\n\n\t    - ```selector``` is a selector, see the class ProjBasedSelector.\n\t    - ```thr``` is a threshold used by adaptivity strategy.\n\t    - ```strat``` is an adaptivity strategy. Possible values are 0, 1, 2, and 3.\n\t    - ```regularize``` specifies mesh regularization. Default value is `-1`.\n\t    - ```same_orders``` specifies whether all element should have the same order. Default is `False`.\n\t    - ```to_be_procesed``` specifies an error to process. Used by strategy 3. Default is `0.0`.\n\t";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_5Adapt_adapt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *__pyx_v_selector = 0;
  double __pyx_v_thr;
  int __pyx_v_strat;
  int __pyx_v_regularize;
  int __pyx_v_same_orders;
  double __pyx_v_to_be_processed;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_selector,&__pyx_kp_thr,&__pyx_kp_strat,&__pyx_kp_regularize,&__pyx_kp_same_orders,&__pyx_kp_to_be_processed,0};
  __Pyx_SetupRefcountContext("adapt");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[6] = {0,0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_selector);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_thr);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("adapt", 0, 2, 6, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_strat);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_regularize);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_same_orders);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
      case  5:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_to_be_processed);
        if (unlikely(value)) { values[5] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "adapt") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_selector = ((struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *)values[0]);
    __pyx_v_thr = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[2]) {
      __pyx_v_strat = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_strat == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_strat = 0;
    }
    if (values[3]) {
      __pyx_v_regularize = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_regularize == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_regularize = -1;
    }
    if (values[4]) {
      __pyx_v_same_orders = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_same_orders == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_same_orders = 0;
    }
    if (values[5]) {
      __pyx_v_to_be_processed = __pyx_PyFloat_AsDouble(values[5]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_to_be_processed = 0.0;
    }
  } else {
    __pyx_v_strat = 0;
    __pyx_v_regularize = -1;
    __pyx_v_same_orders = 0;
    __pyx_v_to_be_processed = 0.0;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  6:
      __pyx_v_to_be_processed = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 5)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  5:
      __pyx_v_same_orders = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_same_orders == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4:
      __pyx_v_regularize = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_regularize == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3:
      __pyx_v_strat = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_strat == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2:
      __pyx_v_thr = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_selector = ((struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("adapt", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.adapt");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_selector), __pyx_ptype_8hermes2d_9_hermes2d_ProjBasedSelector, 1, "selector", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1320
 * 	    - ```to_be_procesed``` specifies an error to process. Used by strategy 3. Default is `0.0`.
 * 	"""
 *         return self.thisptr.adapt(selector.thisptr, thr, strat, regularize, same_orders, to_be_processed)             # <<<<<<<<<<<<<<
 * 
 * cdef class H1Adapt(Adapt):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Adapt *)__pyx_v_self)->thisptr->adapt(__pyx_v_selector->thisptr, __pyx_v_thr, __pyx_v_strat, __pyx_v_regularize, __pyx_v_same_orders, __pyx_v_to_be_processed)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Adapt.adapt");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1331
 * 	- multiple components: ```hp = H1Adapt([h1_space1, h1_space2])```
 *     """
 *     def __cinit__(self, space_list):             # <<<<<<<<<<<<<<
 *         cdef c_H1SpaceTuple spaces
 *         for i in range(len(space_list)):
 */

static int __pyx_pf_8hermes2d_9_hermes2d_7H1Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_7H1Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_space_list = 0;
  Tuple<Space*> __pyx_v_spaces;
  PyObject *__pyx_v_i;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_t_1;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_space_list,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_space_list);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_space_list = values[0];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_space_list = PyTuple_GET_ITEM(__pyx_args, 0);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Adapt.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1333
 *     def __cinit__(self, space_list):
 *         cdef c_H1SpaceTuple spaces
 *         for i in range(len(space_list)):             # <<<<<<<<<<<<<<
 *             spaces.push_back((<H1Space>(space_list[i])).thisptr)
 *         self.thisptr = <c_Adapt*>(new_H1Adapt(spaces))
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_space_list); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1334
 *         cdef c_H1SpaceTuple spaces
 *         for i in range(len(space_list)):
 *             spaces.push_back((<H1Space>(space_list[i])).thisptr)             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Adapt*>(new_H1Adapt(spaces))
 * 
 */
    __pyx_1 = PyObject_GetItem(__pyx_v_space_list, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __pyx_v_spaces.push_back(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_1)->thisptr);
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1335
 *         for i in range(len(space_list)):
 *             spaces.push_back((<H1Space>(space_list[i])).thisptr)
 *         self.thisptr = <c_Adapt*>(new_H1Adapt(spaces))             # <<<<<<<<<<<<<<
 * 
 * cdef class L2Adapt(Adapt):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_H1Adapt *)__pyx_v_self)->__pyx_base.thisptr = ((Adapt *)new H1Adapt(__pyx_v_spaces));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("hermes2d._hermes2d.H1Adapt.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1346
 * 	- multiple components: ```hp = L2Adapt([l2_space1, l2_space2])```
 *     """
 *     def __cinit__(self, space_list):             # <<<<<<<<<<<<<<
 *         cdef c_L2SpaceTuple spaces
 *         for i in range(len(space_list)):
 */

static int __pyx_pf_8hermes2d_9_hermes2d_7L2Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_7L2Adapt___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_space_list = 0;
  Tuple<Space*> __pyx_v_spaces;
  PyObject *__pyx_v_i;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_t_1;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_space_list,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_space_list);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_space_list = values[0];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_space_list = PyTuple_GET_ITEM(__pyx_args, 0);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Adapt.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1348
 *     def __cinit__(self, space_list):
 *         cdef c_L2SpaceTuple spaces
 *         for i in range(len(space_list)):             # <<<<<<<<<<<<<<
 *             spaces.push_back((<L2Space>(space_list[i])).thisptr)
 *         self.thisptr = <c_Adapt*>(new_L2Adapt(spaces))
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_space_list); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = 0; __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
  } else {
    __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_4))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++;
    } else {
      __pyx_t_3 = PyIter_Next(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1349
 *         cdef c_L2SpaceTuple spaces
 *         for i in range(len(space_list)):
 *             spaces.push_back((<L2Space>(space_list[i])).thisptr)             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Adapt*>(new_L2Adapt(spaces))
 * 
 */
    __pyx_1 = PyObject_GetItem(__pyx_v_space_list, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_1);
    __pyx_v_spaces.push_back(((struct __pyx_obj_8hermes2d_9_hermes2d_L2Space *)__pyx_1)->thisptr);
    __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1350
 *         for i in range(len(space_list)):
 *             spaces.push_back((<L2Space>(space_list[i])).thisptr)
 *         self.thisptr = <c_Adapt*>(new_L2Adapt(spaces))             # <<<<<<<<<<<<<<
 * 
 * cdef class Linearizer:
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_L2Adapt *)__pyx_v_self)->__pyx_base.thisptr = ((Adapt *)new L2Adapt(__pyx_v_spaces));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("hermes2d._hermes2d.L2Adapt.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1388
 *     """
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = new_Linearizer()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10Linearizer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10Linearizer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1389
 * 
 *     def __cinit__(self):
 *         self.thisptr = new_Linearizer()             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr = new Linearizer();

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1391
 *         self.thisptr = new_Linearizer()
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         delete(self.thisptr)
 * 
 */

static void __pyx_pf_8hermes2d_9_hermes2d_10Linearizer___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_8hermes2d_9_hermes2d_10Linearizer___dealloc__(PyObject *__pyx_v_self) {
  __Pyx_SetupRefcountContext("__dealloc__");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1392
 * 
 *     def __dealloc__(self):
 *         delete(self.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def process_solution(self, MeshFunction sln):
 */
  delete(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr);

  __Pyx_FinishRefcountContext();
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1394
 *         delete(self.thisptr)
 * 
 *     def process_solution(self, MeshFunction sln):             # <<<<<<<<<<<<<<
 *         self.thisptr.process_solution(<c_MeshFunction *>sln.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_process_solution(PyObject *__pyx_v_self, PyObject *__pyx_v_sln); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_process_solution(PyObject *__pyx_v_self, PyObject *__pyx_v_sln) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("process_solution");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1395
 * 
 *     def process_solution(self, MeshFunction sln):
 *         self.thisptr.process_solution(<c_MeshFunction *>sln.thisptr)             # <<<<<<<<<<<<<<
 * 
 *     def get_vertices(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->process_solution(((struct MeshFunction *)((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)__pyx_v_sln)->__pyx_base.__pyx_base.thisptr));

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.process_solution");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1397
 *         self.thisptr.process_solution(<c_MeshFunction *>sln.thisptr)
 * 
 *     def get_vertices(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the list of vertices.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_vertices(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_vertices[] = "\n        Returns the list of vertices.\n\n        It's a list of triples, where each triple contains (x, y, val), where\n        x, y are the \"x\" and \"y\" coordinates of the vertex and \"val\" is the\n        value of the solution at the vertex.\n\n        Example::\n\n            In [45]: l.get_vertices()\n            Out[45]:\n            array([[  0.00000000e+00,  -1.00000000e+00,  -2.22396971e-17],\n                   [  1.00000000e+00,  -1.00000000e+00,  -1.64798730e-17],\n                   [ -1.00000000e+00,   0.00000000e+00,   8.09899023e-17],\n                   ...,\n                   [  1.48437500e-01,  -1.56250000e-02,   1.62359362e-01],\n                   [  1.32812500e-01,   0.00000000e+00,   1.56012622e-01],\n                   [  1.32812500e-01,  -1.56250000e-02,   1.50562411e-01]])\n\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_vertices(PyObject *__pyx_v_self, PyObject *unused) {
  double3 *__pyx_v_vert;
  int __pyx_v_nvert;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("get_vertices");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1418
 * 
 *         """
 *         cdef double3 *vert = self.thisptr.get_vertices()             # <<<<<<<<<<<<<<
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 3*nvert)
 */
  __pyx_v_vert = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_vertices();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1419
 *         """
 *         cdef double3 *vert = self.thisptr.get_vertices()
 *         cdef int nvert = self.thisptr.get_num_vertices()             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 3*nvert)
 *         return vec.reshape((nvert, 3))
 */
  __pyx_v_nvert = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_vertices();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1420
 *         cdef double3 *vert = self.thisptr.get_vertices()
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 3*nvert)             # <<<<<<<<<<<<<<
 *         return vec.reshape((nvert, 3))
 * 
 */
  __pyx_t_1 = c2numpy_double(((double *)__pyx_v_vert), (3 * __pyx_v_nvert)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1421
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 3*nvert)
 *         return vec.reshape((nvert, 3))             # <<<<<<<<<<<<<<
 * 
 *     def get_num_vertices(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_nvert); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_vertices");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1423
 *         return vec.reshape((nvert, 3))
 * 
 *     def get_num_vertices(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_vertices()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_vertices(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_vertices(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_num_vertices");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1424
 * 
 *     def get_num_vertices(self):
 *         return self.thisptr.get_num_vertices()             # <<<<<<<<<<<<<<
 * 
 *     def get_triangles(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_vertices()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_num_vertices");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1426
 *         return self.thisptr.get_num_vertices()
 * 
 *     def get_triangles(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a list of triangles.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_triangles(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_triangles[] = "\n        Returns a list of triangles.\n\n        The list contains triples of vertices IDs. Use get_vertices() to obtain\n        vertices coordinates.\n\n        Example::\n\n            In [46]: l.get_triangles()\n            Out[46]:\n            array([[   3, 5448,   29],\n                   [  27, 5445,   28],\n                   [  29,   28,   26],\n                   ...,\n                   [5499, 5498, 5479],\n                   [5510, 5493, 5491],\n                   [5513, 5508, 5491]], dtype=int32)\n\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_triangles(PyObject *__pyx_v_self, PyObject *unused) {
  int3 *__pyx_v_tri;
  int __pyx_v_ntri;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("get_triangles");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1446
 * 
 *         """
 *         cdef int3 *tri = self.thisptr.get_triangles()             # <<<<<<<<<<<<<<
 *         cdef int ntri = self.thisptr.get_num_triangles()
 *         cdef ndarray vec = c2numpy_int(<int *>tri, 3*ntri)
 */
  __pyx_v_tri = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_triangles();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1447
 *         """
 *         cdef int3 *tri = self.thisptr.get_triangles()
 *         cdef int ntri = self.thisptr.get_num_triangles()             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_int(<int *>tri, 3*ntri)
 *         return vec.reshape((ntri, 3))
 */
  __pyx_v_ntri = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_triangles();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1448
 *         cdef int3 *tri = self.thisptr.get_triangles()
 *         cdef int ntri = self.thisptr.get_num_triangles()
 *         cdef ndarray vec = c2numpy_int(<int *>tri, 3*ntri)             # <<<<<<<<<<<<<<
 *         return vec.reshape((ntri, 3))
 * 
 */
  __pyx_t_1 = c2numpy_int(((int *)__pyx_v_tri), (3 * __pyx_v_ntri)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1449
 *         cdef int ntri = self.thisptr.get_num_triangles()
 *         cdef ndarray vec = c2numpy_int(<int *>tri, 3*ntri)
 *         return vec.reshape((ntri, 3))             # <<<<<<<<<<<<<<
 * 
 *     def get_num_triangles(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_ntri); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_triangles");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1451
 *         return vec.reshape((ntri, 3))
 * 
 *     def get_num_triangles(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_triangles()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_triangles(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_triangles(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_num_triangles");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1452
 * 
 *     def get_num_triangles(self):
 *         return self.thisptr.get_num_triangles()             # <<<<<<<<<<<<<<
 * 
 *     def get_edges(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_triangles()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_num_triangles");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1454
 *         return self.thisptr.get_num_triangles()
 * 
 *     def get_edges(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a list of edges.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_edges(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_edges[] = "\n        Returns a list of edges.\n\n        The list contains triples of vertices IDs. Use get_vertices() to obtain\n        vertices coordinates.\n\n        Example::\n\n            In [47]: l.get_edges()\n            Out[47]:\n            array([[   3,   27,    0],\n                   [  27,   24,    0],\n                   [  24,   30,    0],\n                   ...,\n                   [5339, 5070,    4],\n                   [5070, 5077,    4],\n                   [5077,   11,    4]], dtype=int32)\n\n        ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_edges(PyObject *__pyx_v_self, PyObject *unused) {
  int3 *__pyx_v_edges;
  int __pyx_v_nedges;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("get_edges");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1474
 * 
 *         """
 *         cdef int3 *edges = self.thisptr.get_edges()             # <<<<<<<<<<<<<<
 *         cdef int nedges = self.thisptr.get_num_edges()
 *         cdef ndarray vec = c2numpy_int(<int *>edges, 3*nedges)
 */
  __pyx_v_edges = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_edges();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1475
 *         """
 *         cdef int3 *edges = self.thisptr.get_edges()
 *         cdef int nedges = self.thisptr.get_num_edges()             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_int(<int *>edges, 3*nedges)
 *         return vec.reshape((nedges, 3))
 */
  __pyx_v_nedges = ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_edges();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1476
 *         cdef int3 *edges = self.thisptr.get_edges()
 *         cdef int nedges = self.thisptr.get_num_edges()
 *         cdef ndarray vec = c2numpy_int(<int *>edges, 3*nedges)             # <<<<<<<<<<<<<<
 *         return vec.reshape((nedges, 3))
 * 
 */
  __pyx_t_1 = c2numpy_int(((int *)__pyx_v_edges), (3 * __pyx_v_nedges)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1477
 *         cdef int nedges = self.thisptr.get_num_edges()
 *         cdef ndarray vec = c2numpy_int(<int *>edges, 3*nedges)
 *         return vec.reshape((nedges, 3))             # <<<<<<<<<<<<<<
 * 
 *     def get_num_edges(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_nedges); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_edges");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1479
 *         return vec.reshape((nedges, 3))
 * 
 *     def get_num_edges(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_edges()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_edges(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_edges(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_num_edges");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1480
 * 
 *     def get_num_edges(self):
 *         return self.thisptr.get_num_edges()             # <<<<<<<<<<<<<<
 * 
 *     def get_min_value(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_num_edges()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_num_edges");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1482
 *         return self.thisptr.get_num_edges()
 * 
 *     def get_min_value(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_min_value()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_min_value(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_min_value(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_min_value");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1483
 * 
 *     def get_min_value(self):
 *         return self.thisptr.get_min_value()             # <<<<<<<<<<<<<<
 * 
 *     def get_max_value(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_min_value()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_min_value");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1485
 *         return self.thisptr.get_min_value()
 * 
 *     def get_max_value(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_max_value()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_max_value(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_max_value(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_SetupRefcountContext("get_max_value");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1486
 * 
 *     def get_max_value(self):
 *         return self.thisptr.get_max_value()             # <<<<<<<<<<<<<<
 * 
 *     def save_data(self, char* filename):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->get_max_value()); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.get_max_value");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1488
 *         return self.thisptr.get_max_value()
 * 
 *     def save_data(self, char* filename):             # <<<<<<<<<<<<<<
 *         self.thisptr.save_data(filename)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_save_data(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_save_data(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename) {
  char *__pyx_v_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("save_data");
  assert(__pyx_arg_filename); {
    __pyx_v_filename = __Pyx_PyBytes_AsString(__pyx_arg_filename); if (unlikely((!__pyx_v_filename) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.save_data");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1489
 * 
 *     def save_data(self, char* filename):
 *         self.thisptr.save_data(filename)             # <<<<<<<<<<<<<<
 * 
 *     def load_data(self, char* filename):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->save_data(__pyx_v_filename);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1491
 *         self.thisptr.save_data(filename)
 * 
 *     def load_data(self, char* filename):             # <<<<<<<<<<<<<<
 *         self.thisptr.load_data(filename)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_load_data(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_load_data(PyObject *__pyx_v_self, PyObject *__pyx_arg_filename) {
  char *__pyx_v_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("load_data");
  assert(__pyx_arg_filename); {
    __pyx_v_filename = __Pyx_PyBytes_AsString(__pyx_arg_filename); if (unlikely((!__pyx_v_filename) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1491; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Linearizer.load_data");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1492
 * 
 *     def load_data(self, char* filename):
 *         self.thisptr.load_data(filename)             # <<<<<<<<<<<<<<
 * 
 * cdef class Vectorizer(Linearizer):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer *)__pyx_v_self)->thisptr->load_data(__pyx_v_filename);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1496
 * cdef class Vectorizer(Linearizer):
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Linearizer *>new_Vectorizer()
 * 
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10Vectorizer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10Vectorizer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1497
 * 
 *     def __cinit__(self):
 *         self.thisptr = <c_Linearizer *>new_Vectorizer()             # <<<<<<<<<<<<<<
 * 
 *     # this segfaults:
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer *)__pyx_v_self)->__pyx_base.thisptr = ((struct Linearizer *)new Vectorizer());

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1503
 *     #    delete(<c_Vectorizer *>(self.thisptr))
 * 
 *     def process_solution(self, MeshFunction xsln, MeshFunction ysln,             # <<<<<<<<<<<<<<
 *             int xitem=c_H2D_FN_VAL_0, int yitem=c_H2D_FN_VAL_0, double eps=c_H2D_EPS_LOW):
 *         (<c_Vectorizer *>(self.thisptr)).process_solution(
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_process_solution(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_process_solution(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_xsln = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_ysln = 0;
  int __pyx_v_xitem;
  int __pyx_v_yitem;
  double __pyx_v_eps;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_xsln,&__pyx_kp_ysln,&__pyx_kp_xitem,&__pyx_kp_yitem,&__pyx_kp_eps,0};
  __Pyx_SetupRefcountContext("process_solution");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_xsln);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_ysln);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("process_solution", 0, 2, 5, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_xitem);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_yitem);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_eps);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "process_solution") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_xsln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_ysln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    if (values[2]) {
      __pyx_v_xitem = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_xitem == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_xitem = __pyx_k_36;
    }
    if (values[3]) {
      __pyx_v_yitem = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_yitem == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_yitem = __pyx_k_37;
    }
    if (values[4]) {
      __pyx_v_eps = __pyx_PyFloat_AsDouble(values[4]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_eps = __pyx_k_38;
    }
  } else {
    __pyx_v_xitem = __pyx_k_36;
    __pyx_v_yitem = __pyx_k_37;
    __pyx_v_eps = __pyx_k_38;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5:
      __pyx_v_eps = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4:
      __pyx_v_yitem = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_yitem == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3:
      __pyx_v_xitem = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_xitem == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2:
      __pyx_v_ysln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
      __pyx_v_xsln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("process_solution", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Vectorizer.process_solution");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_xsln), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "xsln", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_ysln), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "ysln", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1508
 *                 <c_MeshFunction *>xsln.thisptr, xitem,
 *                 <c_MeshFunction *>ysln.thisptr, yitem,
 *                 eps)             # <<<<<<<<<<<<<<
 * 
 *     def get_vertices(self):
 */
  ((struct Vectorizer *)((struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer *)__pyx_v_self)->__pyx_base.thisptr)->process_solution(((struct MeshFunction *)__pyx_v_xsln->__pyx_base.__pyx_base.thisptr), __pyx_v_xitem, ((struct MeshFunction *)__pyx_v_ysln->__pyx_base.__pyx_base.thisptr), __pyx_v_yitem, __pyx_v_eps);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.Vectorizer.process_solution");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1510
 *                 eps)
 * 
 *     def get_vertices(self):             # <<<<<<<<<<<<<<
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef double4 *vert = _self.get_vertices()
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_vertices(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_vertices(PyObject *__pyx_v_self, PyObject *unused) {
  struct Vectorizer *__pyx_v__self;
  double4 *__pyx_v_vert;
  int __pyx_v_nvert;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("get_vertices");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1511
 * 
 *     def get_vertices(self):
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         cdef double4 *vert = _self.get_vertices()
 *         cdef int nvert = self.thisptr.get_num_vertices()
 */
  __pyx_v__self = ((struct Vectorizer *)((struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer *)__pyx_v_self)->__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1512
 *     def get_vertices(self):
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef double4 *vert = _self.get_vertices()             # <<<<<<<<<<<<<<
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 4*nvert)
 */
  __pyx_v_vert = __pyx_v__self->get_vertices();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1513
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef double4 *vert = _self.get_vertices()
 *         cdef int nvert = self.thisptr.get_num_vertices()             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 4*nvert)
 *         return vec.reshape((nvert, 4))
 */
  __pyx_v_nvert = ((struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer *)__pyx_v_self)->__pyx_base.thisptr->get_num_vertices();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1514
 *         cdef double4 *vert = _self.get_vertices()
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 4*nvert)             # <<<<<<<<<<<<<<
 *         return vec.reshape((nvert, 4))
 * 
 */
  __pyx_t_1 = c2numpy_double(((double *)__pyx_v_vert), (4 * __pyx_v_nvert)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1515
 *         cdef int nvert = self.thisptr.get_num_vertices()
 *         cdef ndarray vec = c2numpy_double(<double *>vert, 4*nvert)
 *         return vec.reshape((nvert, 4))             # <<<<<<<<<<<<<<
 * 
 *     def get_dashes(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_nvert); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Vectorizer.get_vertices");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1517
 *         return vec.reshape((nvert, 4))
 * 
 *     def get_dashes(self):             # <<<<<<<<<<<<<<
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef int2 *dashes = _self.get_dashes()
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_dashes(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_dashes(PyObject *__pyx_v_self, PyObject *unused) {
  struct Vectorizer *__pyx_v__self;
  int2 *__pyx_v_dashes;
  int __pyx_v_ndashes;
  PyArrayObject *__pyx_v_vec = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_SetupRefcountContext("get_dashes");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1518
 * 
 *     def get_dashes(self):
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)             # <<<<<<<<<<<<<<
 *         cdef int2 *dashes = _self.get_dashes()
 *         cdef int ndashes = _self.get_num_dashes()
 */
  __pyx_v__self = ((struct Vectorizer *)((struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer *)__pyx_v_self)->__pyx_base.thisptr);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1519
 *     def get_dashes(self):
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef int2 *dashes = _self.get_dashes()             # <<<<<<<<<<<<<<
 *         cdef int ndashes = _self.get_num_dashes()
 *         cdef ndarray vec = c2numpy_int(<int *>dashes, 2*ndashes)
 */
  __pyx_v_dashes = __pyx_v__self->get_dashes();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1520
 *         cdef c_Vectorizer *_self = <c_Vectorizer *>(self.thisptr)
 *         cdef int2 *dashes = _self.get_dashes()
 *         cdef int ndashes = _self.get_num_dashes()             # <<<<<<<<<<<<<<
 *         cdef ndarray vec = c2numpy_int(<int *>dashes, 2*ndashes)
 *         return vec.reshape((ndashes, 2))
 */
  __pyx_v_ndashes = __pyx_v__self->get_num_dashes();

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1521
 *         cdef int2 *dashes = _self.get_dashes()
 *         cdef int ndashes = _self.get_num_dashes()
 *         cdef ndarray vec = c2numpy_int(<int *>dashes, 2*ndashes)             # <<<<<<<<<<<<<<
 *         return vec.reshape((ndashes, 2))
 * 
 */
  __pyx_t_1 = c2numpy_int(((int *)__pyx_v_dashes), (2 * __pyx_v_ndashes)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_8hermes2d_9_hermes2d_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_vec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1522
 *         cdef int ndashes = _self.get_num_dashes()
 *         cdef ndarray vec = c2numpy_int(<int *>dashes, 2*ndashes)
 *         return vec.reshape((ndashes, 2))             # <<<<<<<<<<<<<<
 * 
 * cdef class View:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_vec), __pyx_kp_reshape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_ndashes); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_2);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_2);
  __Pyx_GIVEREF(__pyx_int_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("hermes2d._hermes2d.Vectorizer.get_dashes");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_vec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1525
 * 
 * cdef class View:
 *     def wait(self):             # <<<<<<<<<<<<<<
 *         View_wait()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4View_wait(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_4View_wait(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("wait");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1526
 * cdef class View:
 *     def wait(self):
 *         View_wait()             # <<<<<<<<<<<<<<
 * 
 * cdef class ScalarView(View):
 */
  View::wait();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1531
 *     cdef c_ScalarView *thisptr
 * 
 *     def __cinit__(self, char *title, int x=-1, int y=-1, int width=1000,             # <<<<<<<<<<<<<<
 *                 int height = 800):
 *         self.thisptr = new_ScalarView(title, x, y, width, height)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10ScalarView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10ScalarView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_title;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_width;
  int __pyx_v_height;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_title,&__pyx_kp_x,&__pyx_kp_y,&__pyx_kp_width,&__pyx_kp_height,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_title);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_width);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_height);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_title = __Pyx_PyBytes_AsString(values[0]); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[1]) {
      __pyx_v_x = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_x = -1;
    }
    if (values[2]) {
      __pyx_v_y = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_y = -1;
    }
    if (values[3]) {
      __pyx_v_width = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_width = 1000;
    }
    if (values[4]) {
      __pyx_v_height = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1532; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_height = 800;
    }
  } else {
    __pyx_v_x = -1;
    __pyx_v_y = -1;
    __pyx_v_width = 1000;
    __pyx_v_height = 800;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: __pyx_v_height = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1532; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4: __pyx_v_width = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3: __pyx_v_y = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_x = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_title = __Pyx_PyBytes_AsString(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 1, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1533
 *     def __cinit__(self, char *title, int x=-1, int y=-1, int width=1000,
 *                 int height = 800):
 *         self.thisptr = new_ScalarView(title, x, y, width, height)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr = new ScalarView(__pyx_v_title, __pyx_v_x, __pyx_v_y, __pyx_v_width, __pyx_v_height);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1538
 *     #    delete(self.thisptr)
 * 
 *     def show(self, MeshFunction sln, eps=None):             # <<<<<<<<<<<<<<
 *         cdef Function s = <Function>sln
 *         if eps is None:
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_sln = 0;
  PyObject *__pyx_v_eps = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_Function *__pyx_v_s = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  double __pyx_t_2;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_sln,&__pyx_kp_eps,0};
  __Pyx_SetupRefcountContext("show");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[1] = Py_None;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_sln);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_eps);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "show") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1538; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_sln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_eps = values[1];
  } else {
    __pyx_v_eps = Py_None;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_eps = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_sln = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("show", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1538; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sln), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "sln", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1539
 * 
 *     def show(self, MeshFunction sln, eps=None):
 *         cdef Function s = <Function>sln             # <<<<<<<<<<<<<<
 *         if eps is None:
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr)
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8hermes2d_9_hermes2d_Function *)__pyx_v_sln)));
  __pyx_v_s = ((struct __pyx_obj_8hermes2d_9_hermes2d_Function *)__pyx_v_sln);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1540
 *     def show(self, MeshFunction sln, eps=None):
 *         cdef Function s = <Function>sln
 *         if eps is None:             # <<<<<<<<<<<<<<
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr)
 *         else:
 */
  __pyx_t_1 = (__pyx_v_eps == Py_None);
  if (__pyx_t_1) {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1541
 *         cdef Function s = <Function>sln
 *         if eps is None:
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr)             # <<<<<<<<<<<<<<
 *         else:
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr, <double>eps)
 */
    ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->show(((struct MeshFunction *)__pyx_v_s->thisptr));
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1543
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr)
 *         else:
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr, <double>eps)             # <<<<<<<<<<<<<<
 * 
 *     def show_mesh(self, show=True):
 */
    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_eps); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->show(((struct MeshFunction *)__pyx_v_s->thisptr), ((double)__pyx_t_2));
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1545
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr, <double>eps)
 * 
 *     def show_mesh(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_mesh(show)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_mesh(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_mesh(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_show = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_show,0};
  __Pyx_SetupRefcountContext("show_mesh");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = __pyx_k_39;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_show);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "show_mesh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1545; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_show = values[0];
  } else {
    __pyx_v_show = __pyx_k_39;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_show = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("show_mesh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1545; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show_mesh");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1546
 * 
 *     def show_mesh(self, show=True):
 *         self.thisptr.show_mesh(show)             # <<<<<<<<<<<<<<
 * 
 *     def show_scale(self, show=True):
 */
  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_show); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->show_mesh(__pyx_t_1);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show_mesh");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1548
 *         self.thisptr.show_mesh(show)
 * 
 *     def show_scale(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_scale(show)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_scale(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_scale(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_show = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_show,0};
  __Pyx_SetupRefcountContext("show_scale");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = __pyx_k_40;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_show);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "show_scale") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1548; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_show = values[0];
  } else {
    __pyx_v_show = __pyx_k_40;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_show = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("show_scale", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1548; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show_scale");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1549
 * 
 *     def show_scale(self, show=True):
 *         self.thisptr.show_scale(show)             # <<<<<<<<<<<<<<
 * 
 *     def set_min_max_range(self, double min, double max):
 */
  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_show); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->show_scale(__pyx_t_1);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.show_scale");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1551
 *         self.thisptr.show_scale(show)
 * 
 *     def set_min_max_range(self, double min, double max):             # <<<<<<<<<<<<<<
 *         self.thisptr.set_min_max_range(min, max)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_min_max_range(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_min_max_range(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_min;
  double __pyx_v_max;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_min,&__pyx_kp_max,0};
  __Pyx_SetupRefcountContext("set_min_max_range");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_min);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_min_max_range", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_min_max_range") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_min = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_min = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_min_max_range", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1551; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.set_min_max_range");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1552
 * 
 *     def set_min_max_range(self, double min, double max):
 *         self.thisptr.set_min_max_range(min, max)             # <<<<<<<<<<<<<<
 * 
 *     def set_title(self, char *title):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->set_min_max_range(__pyx_v_min, __pyx_v_max);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1554
 *         self.thisptr.set_min_max_range(min, max)
 * 
 *     def set_title(self, char *title):             # <<<<<<<<<<<<<<
 *         ((self.thisptr)).set_title(title)
 *         #(<c_View *>(self.thisptr)).set_title(title)
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_title(PyObject *__pyx_v_self, PyObject *__pyx_arg_title); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_title(PyObject *__pyx_v_self, PyObject *__pyx_arg_title) {
  char *__pyx_v_title;
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("set_title");
  assert(__pyx_arg_title); {
    __pyx_v_title = __Pyx_PyBytes_AsString(__pyx_arg_title); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1554; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.ScalarView.set_title");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1555
 * 
 *     def set_title(self, char *title):
 *         ((self.thisptr)).set_title(title)             # <<<<<<<<<<<<<<
 *         #(<c_View *>(self.thisptr)).set_title(title)
 * 
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->set_title(__pyx_v_title);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1558
 *         #(<c_View *>(self.thisptr)).set_title(title)
 * 
 *     def wait(self):             # <<<<<<<<<<<<<<
 *         self.thisptr.wait()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_wait(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_wait(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("wait");

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1559
 * 
 *     def wait(self):
 *         self.thisptr.wait()             # <<<<<<<<<<<<<<
 * 
 * cdef class BaseView(View):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView *)__pyx_v_self)->thisptr->wait();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1564
 *     cdef c_BaseView *thisptr
 * 
 *     def __cinit__(self, char *title="BaseView", int x=-1, int y=-1,             # <<<<<<<<<<<<<<
 *             int width=1000, int height = 800):
 *         self.thisptr = new_BaseView(title, x, y, width, height)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_8BaseView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_8BaseView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_title;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_width;
  int __pyx_v_height;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_title,&__pyx_kp_x,&__pyx_kp_y,&__pyx_kp_width,&__pyx_kp_height,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_title);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_width);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_height);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_title = __Pyx_PyBytes_AsString(values[0]); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_title = __pyx_k_41;
    }
    if (values[1]) {
      __pyx_v_x = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_x = -1;
    }
    if (values[2]) {
      __pyx_v_y = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_y = -1;
    }
    if (values[3]) {
      __pyx_v_width = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_width = 1000;
    }
    if (values[4]) {
      __pyx_v_height = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_height = 800;
    }
  } else {
    __pyx_v_title = __pyx_k_41;
    __pyx_v_x = -1;
    __pyx_v_y = -1;
    __pyx_v_width = 1000;
    __pyx_v_height = 800;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: __pyx_v_height = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4: __pyx_v_width = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3: __pyx_v_y = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_x = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_title = __Pyx_PyBytes_AsString(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 0, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1564; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.BaseView.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1566
 *     def __cinit__(self, char *title="BaseView", int x=-1, int y=-1,
 *             int width=1000, int height = 800):
 *         self.thisptr = new_BaseView(title, x, y, width, height)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_BaseView *)__pyx_v_self)->thisptr = new BaseView(__pyx_v_title, __pyx_v_x, __pyx_v_y, __pyx_v_width, __pyx_v_height);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1571
 *     #    delete(self.thisptr)
 * 
 *     def show(self, H1Space s):             # <<<<<<<<<<<<<<
 *         self.thisptr.show(s.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8BaseView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8BaseView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("show");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_H1Space, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1572
 * 
 *     def show(self, H1Space s):
 *         self.thisptr.show(s.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class MeshView(View):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_BaseView *)__pyx_v_self)->thisptr->show(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_s)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.BaseView.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1577
 *     cdef c_MeshView *thisptr
 * 
 *     def __cinit__(self, char *title="MeshView", int x=-1, int y=-1,             # <<<<<<<<<<<<<<
 *             int width=1000, int height = 800):
 *         self.thisptr = new_MeshView(title, x, y, width, height)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_8MeshView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_8MeshView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_title;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_width;
  int __pyx_v_height;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_title,&__pyx_kp_x,&__pyx_kp_y,&__pyx_kp_width,&__pyx_kp_height,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_title);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_width);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_height);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_title = __Pyx_PyBytes_AsString(values[0]); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_title = __pyx_k_42;
    }
    if (values[1]) {
      __pyx_v_x = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_x = -1;
    }
    if (values[2]) {
      __pyx_v_y = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_y = -1;
    }
    if (values[3]) {
      __pyx_v_width = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_width = 1000;
    }
    if (values[4]) {
      __pyx_v_height = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_height = 800;
    }
  } else {
    __pyx_v_title = __pyx_k_42;
    __pyx_v_x = -1;
    __pyx_v_y = -1;
    __pyx_v_width = 1000;
    __pyx_v_height = 800;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: __pyx_v_height = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4: __pyx_v_width = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3: __pyx_v_y = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_x = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_title = __Pyx_PyBytes_AsString(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 0, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshView.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1579
 *     def __cinit__(self, char *title="MeshView", int x=-1, int y=-1,
 *             int width=1000, int height = 800):
 *         self.thisptr = new_MeshView(title, x, y, width, height)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshView *)__pyx_v_self)->thisptr = new MeshView(__pyx_v_title, __pyx_v_x, __pyx_v_y, __pyx_v_width, __pyx_v_height);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1584
 *     #    delete(self.thisptr)
 * 
 *     def show(self, Mesh s):             # <<<<<<<<<<<<<<
 *         self.thisptr.show(s.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8MeshView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_8MeshView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("show");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_Mesh, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1585
 * 
 *     def show(self, Mesh s):
 *         self.thisptr.show(s.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class OrderView(View):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshView *)__pyx_v_self)->thisptr->show(((struct __pyx_obj_8hermes2d_9_hermes2d_Mesh *)__pyx_v_s)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.MeshView.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1590
 *     cdef c_OrderView *thisptr
 * 
 *     def __cinit__(self, char *title="OrderView", int x=-1, int y=-1,             # <<<<<<<<<<<<<<
 *             int width=1000, int height = 800):
 *         self.thisptr = new_OrderView(title, x, y, width, height)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_9OrderView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_9OrderView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_title;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_width;
  int __pyx_v_height;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_title,&__pyx_kp_x,&__pyx_kp_y,&__pyx_kp_width,&__pyx_kp_height,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_title);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_width);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_height);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_title = __Pyx_PyBytes_AsString(values[0]); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_title = __pyx_k_43;
    }
    if (values[1]) {
      __pyx_v_x = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_x = -1;
    }
    if (values[2]) {
      __pyx_v_y = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_y = -1;
    }
    if (values[3]) {
      __pyx_v_width = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1591; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_width = 1000;
    }
    if (values[4]) {
      __pyx_v_height = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1591; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_height = 800;
    }
  } else {
    __pyx_v_title = __pyx_k_43;
    __pyx_v_x = -1;
    __pyx_v_y = -1;
    __pyx_v_width = 1000;
    __pyx_v_height = 800;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: __pyx_v_height = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1591; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4: __pyx_v_width = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1591; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3: __pyx_v_y = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_x = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_title = __Pyx_PyBytes_AsString(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 0, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.OrderView.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1592
 *     def __cinit__(self, char *title="OrderView", int x=-1, int y=-1,
 *             int width=1000, int height = 800):
 *         self.thisptr = new_OrderView(title, x, y, width, height)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_OrderView *)__pyx_v_self)->thisptr = new OrderView(__pyx_v_title, __pyx_v_x, __pyx_v_y, __pyx_v_width, __pyx_v_height);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1597
 *     #    delete(self.thisptr)
 * 
 *     def show(self, H1Space s):             # <<<<<<<<<<<<<<
 *         self.thisptr.show(s.thisptr)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9OrderView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_9OrderView_show(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("show");
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_8hermes2d_9_hermes2d_H1Space, 1, "s", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1598
 * 
 *     def show(self, H1Space s):
 *         self.thisptr.show(s.thisptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class VectorView(View):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_OrderView *)__pyx_v_self)->thisptr->show(((struct __pyx_obj_8hermes2d_9_hermes2d_H1Space *)__pyx_v_s)->thisptr);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.OrderView.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1603
 *     cdef c_VectorView *thisptr
 * 
 *     def __cinit__(self, char *title, int x=-1, int y=-1, int width=1000,             # <<<<<<<<<<<<<<
 *             int height = 800):
 *         self.thisptr = new_VectorView(title, x, y, width, height)
 */

static int __pyx_pf_8hermes2d_9_hermes2d_10VectorView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8hermes2d_9_hermes2d_10VectorView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_title;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_width;
  int __pyx_v_height;
  int __pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_title,&__pyx_kp_x,&__pyx_kp_y,&__pyx_kp_width,&__pyx_kp_height,0};
  __Pyx_SetupRefcountContext("__cinit__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_title);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_x);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_y);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
      case  3:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_width);
        if (unlikely(value)) { values[3] = value; kw_args--; }
      }
      case  4:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_height);
        if (unlikely(value)) { values[4] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__cinit__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_title = __Pyx_PyBytes_AsString(values[0]); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[1]) {
      __pyx_v_x = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_x = -1;
    }
    if (values[2]) {
      __pyx_v_y = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_y = -1;
    }
    if (values[3]) {
      __pyx_v_width = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_width = 1000;
    }
    if (values[4]) {
      __pyx_v_height = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1604; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_height = 800;
    }
  } else {
    __pyx_v_x = -1;
    __pyx_v_y = -1;
    __pyx_v_width = 1000;
    __pyx_v_height = 800;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: __pyx_v_height = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_height == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1604; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4: __pyx_v_width = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_width == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  3: __pyx_v_y = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_y == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_x = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_x == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_title = __Pyx_PyBytes_AsString(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((!__pyx_v_title) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 1, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.__cinit__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1605
 *     def __cinit__(self, char *title, int x=-1, int y=-1, int width=1000,
 *             int height = 800):
 *         self.thisptr = new_VectorView(title, x, y, width, height)             # <<<<<<<<<<<<<<
 * 
 *     #def __dealloc__(self):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_VectorView *)__pyx_v_self)->thisptr = new VectorView(__pyx_v_title, __pyx_v_x, __pyx_v_y, __pyx_v_width, __pyx_v_height);

  __pyx_r = 0;
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1610
 *     #    delete(self.thisptr)
 * 
 *     def show(self, MeshFunction s1, MeshFunction s2, eps = 0.008):             # <<<<<<<<<<<<<<
 *         (<c_VectorView *>(self.thisptr)).show(<c_MeshFunction *>s1.thisptr, <c_MeshFunction *>s2.thisptr, eps)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_s1 = 0;
  struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *__pyx_v_s2 = 0;
  PyObject *__pyx_v_eps = 0;
  PyObject *__pyx_r = NULL;
  double __pyx_t_1;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_13,&__pyx_kp_14,&__pyx_kp_eps,0};
  __Pyx_SetupRefcountContext("show");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    values[2] = __pyx_k_44;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_13);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_14);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("show", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_eps);
        if (unlikely(value)) { values[2] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "show") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[0]);
    __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)values[1]);
    __pyx_v_eps = values[2];
  } else {
    __pyx_v_eps = __pyx_k_44;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3:
      __pyx_v_eps = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2:
      __pyx_v_s2 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 1));
      __pyx_v_s1 = ((struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("show", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.show");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s1), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "s1", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s2), __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction, 1, "s2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1611
 * 
 *     def show(self, MeshFunction s1, MeshFunction s2, eps = 0.008):
 *         (<c_VectorView *>(self.thisptr)).show(<c_MeshFunction *>s1.thisptr, <c_MeshFunction *>s2.thisptr, eps)             # <<<<<<<<<<<<<<
 * 
 *     def show_scale(self, show=True):
 */
  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_eps); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct VectorView *)((struct __pyx_obj_8hermes2d_9_hermes2d_VectorView *)__pyx_v_self)->thisptr)->show(((struct MeshFunction *)__pyx_v_s1->__pyx_base.__pyx_base.thisptr), ((struct MeshFunction *)__pyx_v_s2->__pyx_base.__pyx_base.thisptr), __pyx_t_1);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.show");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1613
 *         (<c_VectorView *>(self.thisptr)).show(<c_MeshFunction *>s1.thisptr, <c_MeshFunction *>s2.thisptr, eps)
 * 
 *     def show_scale(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_scale(show)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show_scale(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show_scale(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_show = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_show,0};
  __Pyx_SetupRefcountContext("show_scale");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = __pyx_k_45;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_kp_show);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "show_scale") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1613; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_show = values[0];
  } else {
    __pyx_v_show = __pyx_k_45;
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_show = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("show_scale", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1613; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.show_scale");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1614
 * 
 *     def show_scale(self, show=True):
 *         self.thisptr.show_scale(show)             # <<<<<<<<<<<<<<
 * 
 *     def set_min_max_range(self, double min, double max):
 */
  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_show); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_8hermes2d_9_hermes2d_VectorView *)__pyx_v_self)->thisptr->show_scale(__pyx_t_1);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.show_scale");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1616
 *         self.thisptr.show_scale(show)
 * 
 *     def set_min_max_range(self, double min, double max):             # <<<<<<<<<<<<<<
 *         self.thisptr.set_min_max_range(min, max)
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_set_min_max_range(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_10VectorView_set_min_max_range(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_min;
  double __pyx_v_max;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_min,&__pyx_kp_max,0};
  __Pyx_SetupRefcountContext("set_min_max_range");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_min);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("set_min_max_range", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "set_min_max_range") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_min = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_min = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("set_min_max_range", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("hermes2d._hermes2d.VectorView.set_min_max_range");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1617
 * 
 *     def set_min_max_range(self, double min, double max):
 *         self.thisptr.set_min_max_range(min, max)             # <<<<<<<<<<<<<<
 * 
 * #cdef class MatrixView(View):
 */
  ((struct __pyx_obj_8hermes2d_9_hermes2d_VectorView *)__pyx_v_self)->thisptr->set_min_max_range(__pyx_v_min, __pyx_v_max);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1632
 *     #    self.thisptr.show(ep.thisptr)
 * 
 * def init_hermes2d_wrappers():             # <<<<<<<<<<<<<<
 *     init_global_empty_tuple()
 * 
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_init_hermes2d_wrappers(PyObject *__pyx_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_init_hermes2d_wrappers(PyObject *__pyx_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_SetupRefcountContext("init_hermes2d_wrappers");
  __pyx_self = __pyx_self;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1633
 * 
 * def init_hermes2d_wrappers():
 *     init_global_empty_tuple()             # <<<<<<<<<<<<<<
 * 
 * def set_verbose(verbose):
 */
  init_global_empty_tuple();

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1635
 *     init_global_empty_tuple()
 * 
 * def set_verbose(verbose):             # <<<<<<<<<<<<<<
 *     """
 *     Sets the global verbose_mode variable.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_set_verbose(PyObject *__pyx_self, PyObject *__pyx_v_verbose); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_set_verbose[] = "\n    Sets the global verbose_mode variable.\n\n    That variable controls how verbose hermes2d is.\n\n    Returns the old status.\n    ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_set_verbose(PyObject *__pyx_self, PyObject *__pyx_v_verbose) {
  PyObject *__pyx_v_old_flag;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  __Pyx_SetupRefcountContext("set_verbose");
  __pyx_self = __pyx_self;
  __pyx_v_old_flag = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1645
 *     global c_verbose_mode
 *     global c_info_mode
 *     old_flag = c_verbose_mode             # <<<<<<<<<<<<<<
 *     c_verbose_mode = verbose
 *     c_info_mode = verbose
 */
  __pyx_t_1 = PyInt_FromLong(__h2d_report_verbose); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_old_flag);
  __pyx_v_old_flag = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1646
 *     global c_info_mode
 *     old_flag = c_verbose_mode
 *     c_verbose_mode = verbose             # <<<<<<<<<<<<<<
 *     c_info_mode = verbose
 *     return old_flag
 */
  __pyx_t_2 = __Pyx_PyInt_AsInt(__pyx_v_verbose); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __h2d_report_verbose = __pyx_t_2;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1647
 *     old_flag = c_verbose_mode
 *     c_verbose_mode = verbose
 *     c_info_mode = verbose             # <<<<<<<<<<<<<<
 *     return old_flag
 * 
 */
  __pyx_t_2 = __Pyx_PyInt_AsInt(__pyx_v_verbose); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __h2d_report_info = __pyx_t_2;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1648
 *     c_verbose_mode = verbose
 *     c_info_mode = verbose
 *     return old_flag             # <<<<<<<<<<<<<<
 * 
 * def set_warn_integration(warn_integration):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_old_flag);
  __pyx_r = __pyx_v_old_flag;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.set_verbose");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_old_flag);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

/* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1650
 *     return old_flag
 * 
 * def set_warn_integration(warn_integration):             # <<<<<<<<<<<<<<
 *     """
 *     Sets the global warn_integration variable.
 */

static PyObject *__pyx_pf_8hermes2d_9_hermes2d_set_warn_integration(PyObject *__pyx_self, PyObject *__pyx_v_warn_integration); /*proto*/
static char __pyx_doc_8hermes2d_9_hermes2d_set_warn_integration[] = "\n    Sets the global warn_integration variable.\n\n    That variable controls if warn_order() in the C++ hermes2d should emit the\n    warning about integration rules.\n\n    Returns the old status.\n    ";
static PyObject *__pyx_pf_8hermes2d_9_hermes2d_set_warn_integration(PyObject *__pyx_self, PyObject *__pyx_v_warn_integration) {
  PyObject *__pyx_v_old_flag;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  __Pyx_SetupRefcountContext("set_warn_integration");
  __pyx_self = __pyx_self;
  __pyx_v_old_flag = Py_None; __Pyx_INCREF(Py_None);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1660
 *     """
 *     global c_warn_integration
 *     old_flag = c_warn_integration             # <<<<<<<<<<<<<<
 *     c_warn_integration = warn_integration
 *     return old_flag
 */
  __pyx_t_1 = PyInt_FromLong(__h2d_report_warn_intr); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_old_flag);
  __pyx_v_old_flag = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1661
 *     global c_warn_integration
 *     old_flag = c_warn_integration
 *     c_warn_integration = warn_integration             # <<<<<<<<<<<<<<
 *     return old_flag
 * 
 */
  __pyx_t_2 = __Pyx_PyInt_AsInt(__pyx_v_warn_integration); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __h2d_report_warn_intr = __pyx_t_2;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1662
 *     old_flag = c_warn_integration
 *     c_warn_integration = warn_integration
 *     return old_flag             # <<<<<<<<<<<<<<
 * 
 * #def glut_main_loop():
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_old_flag);
  __pyx_r = __pyx_v_old_flag;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("hermes2d._hermes2d.set_warn_integration");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_old_flag);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_FinishRefcountContext();
  return __pyx_r;
}

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_LinSystem(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)o);
  p->_spaces = Py_None; Py_INCREF(Py_None);
  p->_pss = Py_None; Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_LinSystem(PyObject *o) {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *p = (struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)o;
  Py_XDECREF(p->_spaces);
  Py_XDECREF(p->_pss);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_8hermes2d_9_hermes2d_LinSystem(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *p = (struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)o;
  if (p->_spaces) {
    e = (*v)(p->_spaces, a); if (e) return e;
  }
  if (p->_pss) {
    e = (*v)(p->_pss, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_8hermes2d_9_hermes2d_LinSystem(PyObject *o) {
  struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *p = (struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->_spaces);
  p->_spaces = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->_pss);
  p->_pss = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_LinSystem[] = {
  {__Pyx_NAMESTR("set_spaces"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_spaces, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_pss"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_set_pss, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("solve_system"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_solve_system, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_9LinSystem_solve_system)},
  {__Pyx_NAMESTR("assemble"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_assemble, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_matrix_csc"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix_csc, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_matrix_csc)},
  {__Pyx_NAMESTR("get_matrix"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_matrix, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_matrix)},
  {__Pyx_NAMESTR("get_rhs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9LinSystem_get_rhs, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_9LinSystem_get_rhs)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_LinSystem = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_LinSystem = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_LinSystem = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_LinSystem = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_LinSystem = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.LinSystem"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_LinSystem), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_LinSystem, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_LinSystem, /*tp_as_number*/
  &__pyx_tp_as_sequence_LinSystem, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_LinSystem, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_LinSystem, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_8hermes2d_9_hermes2d_LinSystem, /*tp_traverse*/
  __pyx_tp_clear_8hermes2d_9_hermes2d_LinSystem, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_LinSystem, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8hermes2d_9_hermes2d_9LinSystem___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_LinSystem, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_RefSystem(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_LinSystem(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_RefSystem[] = {
  {__Pyx_NAMESTR("assemble"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9RefSystem_assemble, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_RefSystem = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_RefSystem = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_RefSystem = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_RefSystem = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_RefSystem = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.RefSystem"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_RefSystem), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_LinSystem, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_RefSystem, /*tp_as_number*/
  &__pyx_tp_as_sequence_RefSystem, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_RefSystem, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_RefSystem, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_8hermes2d_9_hermes2d_LinSystem, /*tp_traverse*/
  __pyx_tp_clear_8hermes2d_9_hermes2d_LinSystem, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_RefSystem, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8hermes2d_9_hermes2d_9RefSystem___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_RefSystem, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Solver(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Solver(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Solver[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Solver = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Solver = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Solver = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Solver = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Solver = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Solver"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Solver), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Solver, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Solver, /*tp_as_number*/
  &__pyx_tp_as_sequence_Solver, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Solver, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Solver, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Solver, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Solver, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_DummySolver(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Solver(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_11DummySolver___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_DummySolver(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_11DummySolver___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Solver(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_DummySolver[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_DummySolver = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_DummySolver = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_DummySolver = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_DummySolver = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_DummySolver = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.DummySolver"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_DummySolver), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_DummySolver, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_DummySolver, /*tp_as_number*/
  &__pyx_tp_as_sequence_DummySolver, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_DummySolver, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_DummySolver, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_DummySolver, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_DummySolver, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_WeakForm(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_8WeakForm___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_WeakForm(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_8WeakForm___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_WeakForm[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_WeakForm = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_WeakForm = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_WeakForm = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_WeakForm = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_WeakForm = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.WeakForm"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_WeakForm), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_WeakForm, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_WeakForm, /*tp_as_number*/
  &__pyx_tp_as_sequence_WeakForm, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_WeakForm, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_WeakForm, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_WeakForm, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_WeakForm, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_H1Space(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_H1Space(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_7H1Space___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_H1Space[] = {
  {__Pyx_NAMESTR("set_uniform_order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7H1Space_set_uniform_order, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("assign_dofs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7H1Space_assign_dofs, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("copy_orders"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7H1Space_copy_orders, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_element_order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_element_order, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_num_dofs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7H1Space_get_num_dofs, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_H1Space = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_H1Space = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_H1Space = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_H1Space = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_H1Space = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.H1Space"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_H1Space), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_H1Space, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_H1Space, /*tp_as_number*/
  &__pyx_tp_as_sequence_H1Space, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_H1Space, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_H1Space, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_H1Space, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8hermes2d_9_hermes2d_7H1Space___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_H1Space, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_L2Space(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_L2Space(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_7L2Space___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_L2Space[] = {
  {__Pyx_NAMESTR("set_uniform_order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7L2Space_set_uniform_order, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_7L2Space_set_uniform_order)},
  {__Pyx_NAMESTR("assign_dofs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7L2Space_assign_dofs, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_7L2Space_assign_dofs)},
  {__Pyx_NAMESTR("copy_orders"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7L2Space_copy_orders, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_7L2Space_copy_orders)},
  {__Pyx_NAMESTR("get_element_order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_element_order, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_7L2Space_get_element_order)},
  {__Pyx_NAMESTR("get_num_dofs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7L2Space_get_num_dofs, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_7L2Space_get_num_dofs)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_L2Space = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_L2Space = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_L2Space = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_L2Space = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_L2Space = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.L2Space"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_L2Space), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_L2Space, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_L2Space, /*tp_as_number*/
  &__pyx_tp_as_sequence_L2Space, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_L2Space, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_L2Space, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" L2 Space.\n\n        Suggested Use: ```l2_space = L2Space(mesh, l2_shapeset)```\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_L2Space, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8hermes2d_9_hermes2d_7L2Space___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_L2Space, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Transformable(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Transformable[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Transformable = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Transformable = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Transformable = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Transformable = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Transformable = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Transformable"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Transformable), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Transformable, /*tp_as_number*/
  &__pyx_tp_as_sequence_Transformable, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Transformable, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Transformable, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Transformable, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Transformable, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Function(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Function[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Function = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Function = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Function = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Function = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Function = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Function"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Function), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Function, /*tp_as_number*/
  &__pyx_tp_as_sequence_Function, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Function, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Function, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Function, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Function, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_ScalarFunction(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_ScalarFunction[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ScalarFunction = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ScalarFunction = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ScalarFunction = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ScalarFunction = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_ScalarFunction = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.ScalarFunction"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_ScalarFunction), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ScalarFunction, /*tp_as_number*/
  &__pyx_tp_as_sequence_ScalarFunction, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ScalarFunction, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ScalarFunction, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_ScalarFunction, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_ScalarFunction, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_MeshFunction(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_MeshFunction[] = {
  {__Pyx_NAMESTR("__add__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___add__, METH_O|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("__sub__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___sub__, METH_O|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("__neg__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___neg__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("l2_norm"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_l2_norm, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("h1_norm"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_h1_norm, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_pt_value"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_pt_value, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_mesh"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_12MeshFunction_get_mesh, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_MeshFunction = {
  __pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___add__, /*nb_add*/
  __pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___sub__, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  __pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___pow__, /*nb_power*/
  __pyx_pf_8hermes2d_9_hermes2d_12MeshFunction___neg__, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_MeshFunction = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_MeshFunction = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_MeshFunction = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_MeshFunction = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.MeshFunction"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_MeshFunction), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_MeshFunction, /*tp_as_number*/
  &__pyx_tp_as_sequence_MeshFunction, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_MeshFunction, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_MeshFunction, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_MeshFunction, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_MeshFunction, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Solution(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_8Solution___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Solution[] = {
  {__Pyx_NAMESTR("copy"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("copy_by_reference"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_copy_by_reference, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_zero"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_zero, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_const"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_const, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_fe_solution"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_set_fe_solution, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_8Solution_set_fe_solution)},
  {__Pyx_NAMESTR("plot"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_plot, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_8Solution_plot)},
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8Solution_show, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_8Solution_show)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Solution = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Solution = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Solution = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Solution = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Solution = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Solution"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Solution), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Solution, /*tp_as_number*/
  &__pyx_tp_as_sequence_Solution, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Solution, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Solution, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Solution, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Solution, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Linearizer(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10Linearizer___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Linearizer(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_10Linearizer___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Linearizer[] = {
  {__Pyx_NAMESTR("process_solution"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_process_solution, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_vertices"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_vertices, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_vertices)},
  {__Pyx_NAMESTR("get_num_vertices"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_vertices, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_triangles"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_triangles, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_triangles)},
  {__Pyx_NAMESTR("get_num_triangles"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_triangles, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_edges"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_edges, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_10Linearizer_get_edges)},
  {__Pyx_NAMESTR("get_num_edges"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_num_edges, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_min_value"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_min_value, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_max_value"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_get_max_value, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("save_data"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_save_data, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("load_data"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Linearizer_load_data, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Linearizer = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Linearizer = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Linearizer = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Linearizer = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Linearizer = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Linearizer"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Linearizer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Linearizer, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Linearizer, /*tp_as_number*/
  &__pyx_tp_as_sequence_Linearizer, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Linearizer, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Linearizer, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR("\n    Linearizes the solution.\n\n    It returns the triangles and vertices and you can then use it to visualize\n    the solution.\n\n    Example::\n\n        In [40]: l = Linearizer(sln)\n\n        In [44]: l.process_solution(sln)\n        Linearizer: 5519 verts, 10847 tris in 0.05 sec\n\n        In [45]: l.get_vertices()\n        Out[45]:\n        array([[  0.00000000e+00,  -1.00000000e+00,  -2.22396971e-17],\n               [  1.00000000e+00,  -1.00000000e+00,  -1.64798730e-17],\n               [ -1.00000000e+00,   0.00000000e+00,   8.09899023e-17],\n               ...,\n               [  1.48437500e-01,  -1.56250000e-02,   1.62359362e-01],\n               [  1.32812500e-01,   0.00000000e+00,   1.56012622e-01],\n               [  1.32812500e-01,  -1.56250000e-02,   1.50562411e-01]])\n\n        In [46]: l.get_triangles()\n        Out[46]:\n        array([[   3, 5448,   29],\n               [  27, 5445,   28],\n               [  29,   28,   26],\n               ...,\n               [5499, 5498, 5479],\n               [5510, 5493, 5491],\n               [5513, 5508, 5491]], dtype=int32)\n\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Linearizer, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Linearizer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Vectorizer(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Linearizer(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Vectorizer[] = {
  {__Pyx_NAMESTR("process_solution"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_process_solution, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_vertices"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_vertices, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_dashes"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10Vectorizer_get_dashes, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Vectorizer = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Vectorizer = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Vectorizer = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Vectorizer = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Vectorizer = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Vectorizer"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Vectorizer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Linearizer, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Vectorizer, /*tp_as_number*/
  &__pyx_tp_as_sequence_Vectorizer, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Vectorizer, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Vectorizer, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Vectorizer, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Vectorizer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_ProjBasedSelector(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_ProjBasedSelector(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_ProjBasedSelector[] = {
  {__Pyx_NAMESTR("set_error_weights"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_error_weights, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_17ProjBasedSelector_set_error_weights)},
  {__Pyx_NAMESTR("set_option"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_17ProjBasedSelector_set_option, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_17ProjBasedSelector_set_option)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ProjBasedSelector = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ProjBasedSelector = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ProjBasedSelector = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ProjBasedSelector = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_ProjBasedSelector = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.ProjBasedSelector"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_ProjBasedSelector), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_ProjBasedSelector, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ProjBasedSelector, /*tp_as_number*/
  &__pyx_tp_as_sequence_ProjBasedSelector, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ProjBasedSelector, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ProjBasedSelector, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" A base class for projection based selector.\n\n        Suggests a refinement based on en error of proposed refinements (candidates).\n\tAn error of a candidate is a combination of errors of\n\telements of a candidate. Each element of a candidate is calculated\n\tseparatelly.\n\n        Do not use this class directly,\n\tuse derived classes H1ProjBasedSelector and L2ProjBasedSelector instead.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_ProjBasedSelector, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_ProjBasedSelector, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_H1ProjBasedSelector(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_ProjBasedSelector(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_19H1ProjBasedSelector___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_H1ProjBasedSelector[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_H1ProjBasedSelector = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_H1ProjBasedSelector = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_H1ProjBasedSelector = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_H1ProjBasedSelector = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_H1ProjBasedSelector = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.H1ProjBasedSelector"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_H1ProjBasedSelector), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_ProjBasedSelector, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_H1ProjBasedSelector, /*tp_as_number*/
  &__pyx_tp_as_sequence_H1ProjBasedSelector, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_H1ProjBasedSelector, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_H1ProjBasedSelector, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" A projection based selector for H1 space by the method adapt() of the class Adapt\n        The selector should be instantiated outside the adaptivity loop.\n\n\tSuggested Use:\n\n\t```selector = H1ProjBasedSelector(cand_list, conv_exp, max_order, h1_shapeset)```\n\n\twhere:\n\n\t- ```cand_list``` defines possible candidates, e.g., CandList.HP_ANISO.\n\t- ```conv_exp``` specifies a convergence exponent which incluences selecting of a candidate. For more detials, refer to User Documentation.\n\t- ```max_order``` defined a maximum order which should be used by the refinement. Currently, the maximum order is 9. Supply -1 to use the maximum supported order.\n\t- ```h1_shapeset``` expects an instance of the class H1Shapeset.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_H1ProjBasedSelector, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_H1ProjBasedSelector, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_L2ProjBasedSelector(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_ProjBasedSelector(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_19L2ProjBasedSelector___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_L2ProjBasedSelector[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_L2ProjBasedSelector = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_L2ProjBasedSelector = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_L2ProjBasedSelector = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_L2ProjBasedSelector = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_L2ProjBasedSelector = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.L2ProjBasedSelector"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_L2ProjBasedSelector), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_ProjBasedSelector, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_L2ProjBasedSelector, /*tp_as_number*/
  &__pyx_tp_as_sequence_L2ProjBasedSelector, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_L2ProjBasedSelector, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_L2ProjBasedSelector, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" A projection based selector for L2 space used by the method adapt() of the class Adapt.\n        The selector should be instantiated outside the adaptivity loop.\n\n\tSuggested Use:\n\n\t    ```selector = L2ProjBasedSelector(cand_list, conv_exp, max_order, l2_shapeset)```\n\n\twhere:\n\n\t- ```cand_list``` defines possible candidates, e.g., CandList.HP_ANISO.\n\t- ```conv_exp``` specifies a convergence exponent which incluences selecting of a candidate. For more detials, refer to User Documentation.\n\t- ```max_order``` defined a maximum order which should be used by the refinement. Currently, the maximum order is 9. Supply -1 to use the maximum supported order.\n\t- ```l2_shapeset``` expects an instance of the class L2Shapeset.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_L2ProjBasedSelector, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_L2ProjBasedSelector, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Adapt(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_5Adapt___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Adapt(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_5Adapt___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Adapt[] = {
  {__Pyx_NAMESTR("set_solutions"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Adapt_set_solutions, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_5Adapt_set_solutions)},
  {__Pyx_NAMESTR("calc_error"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Adapt_calc_error, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_5Adapt_calc_error)},
  {__Pyx_NAMESTR("adapt"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Adapt_adapt, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_5Adapt_adapt)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Adapt = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Adapt = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Adapt = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Adapt = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Adapt = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Adapt"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Adapt), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Adapt, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Adapt, /*tp_as_number*/
  &__pyx_tp_as_sequence_Adapt, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Adapt, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Adapt, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" A base class for adaptivity. Adaptivity provides framework for modyfying elements in order to decrease errors of the solution.\n        Do not use this class directly, use derived classes H1Adapt and L2Adapt instead."), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Adapt, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Adapt, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_H1Adapt(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Adapt(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_7H1Adapt___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_H1Adapt[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_H1Adapt = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_H1Adapt = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_H1Adapt = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_H1Adapt = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_H1Adapt = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.H1Adapt"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_H1Adapt), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Adapt, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_H1Adapt, /*tp_as_number*/
  &__pyx_tp_as_sequence_H1Adapt, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_H1Adapt, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_H1Adapt, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" Adaptivity class for H1 space.\n        For details on class members, see the parent class Adapt.\n\n        Suggested Use:\n\n\t- single component: ```hp = H1Adapt([h1_space1])```\n\t- multiple components: ```hp = H1Adapt([h1_space1, h1_space2])```\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_H1Adapt, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_H1Adapt, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_L2Adapt(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Adapt(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_7L2Adapt___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_L2Adapt[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_L2Adapt = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_L2Adapt = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_L2Adapt = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_L2Adapt = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_L2Adapt = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.L2Adapt"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_L2Adapt), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Adapt, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_L2Adapt, /*tp_as_number*/
  &__pyx_tp_as_sequence_L2Adapt, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_L2Adapt, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_L2Adapt, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" Adaptivity class for L2 space.\n        For details on class members, see the parent class Adapt.\n\n        Suggested Use:\n\n\t- single component: ```hp = L2Adapt([l2_space1])```\n\t- multiple components: ```hp = L2Adapt([l2_space1, l2_space2])```\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_L2Adapt, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_L2Adapt, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Mesh(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_4Mesh___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Mesh(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_4Mesh___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Mesh[] = {
  {__Pyx_NAMESTR("copy"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_copy, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("load"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("load_str"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_str, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("elements_markers"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements_markers, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_elements_markers)},
  {__Pyx_NAMESTR("elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_elements, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_elements)},
  {__Pyx_NAMESTR("active_elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_active_elements, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_active_elements)},
  {__Pyx_NAMESTR("nodes"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_nodes)},
  {__Pyx_NAMESTR("nodes_dict"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_nodes_dict, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_nodes_dict)},
  {__Pyx_NAMESTR("curves"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_curves, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_curves)},
  {__Pyx_NAMESTR("get_polygonal_boundary"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_polygonal_boundary, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_get_polygonal_boundary)},
  {__Pyx_NAMESTR("num_elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_elements, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("num_base_elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_base_elements, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("num_active_elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_num_active_elements, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("max_element_id"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_max_element_id, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("__str__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh___str__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("load_hermes"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_load_hermes, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_load_hermes)},
  {__Pyx_NAMESTR("get_elements_order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_elements_order, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_get_elements_order)},
  {__Pyx_NAMESTR("create"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_create, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_create)},
  {__Pyx_NAMESTR("save"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_save, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("refine_element"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_element, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("refine_all_elements"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_all_elements, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("refine_towards_boundary"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_boundary, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("refine_towards_vertex"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_refine_towards_vertex, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_element"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_get_element, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("plot"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_plot, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_plot)},
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_show, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_4Mesh_show)},
  {__Pyx_NAMESTR("convert_triangles_to_quads"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_triangles_to_quads, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("convert_quads_to_triangles"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Mesh_convert_quads_to_triangles, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Mesh = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Mesh = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Mesh = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Mesh = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Mesh = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Mesh"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Mesh), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Mesh, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Mesh, /*tp_as_number*/
  &__pyx_tp_as_sequence_Mesh, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Mesh, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pf_8hermes2d_9_hermes2d_4Mesh___str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Mesh, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Mesh, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Mesh, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Nurbs(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Nurbs(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Nurbs[] = {
  {__Pyx_NAMESTR("degree"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_degree, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("np"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_np, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("pt"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_pt, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("nk"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_nk, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("kv"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_kv, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("ref"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_5Nurbs_ref, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Nurbs = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Nurbs = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Nurbs = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Nurbs = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Nurbs = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Nurbs"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Nurbs), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Nurbs, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Nurbs, /*tp_as_number*/
  &__pyx_tp_as_sequence_Nurbs, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Nurbs, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Nurbs, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Nurbs, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Nurbs, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_CurvMap(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_CurvMap(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_CurvMap[] = {
  {__Pyx_NAMESTR("order"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_order, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("toplevel"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_toplevel, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_nurbs"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7CurvMap_get_nurbs, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_CurvMap = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_CurvMap = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_CurvMap = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_CurvMap = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_CurvMap = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.CurvMap"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_CurvMap), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_CurvMap, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_CurvMap, /*tp_as_number*/
  &__pyx_tp_as_sequence_CurvMap, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_CurvMap, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_CurvMap, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_CurvMap, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_CurvMap, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Node(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Node(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Node[] = {
  {__Pyx_NAMESTR("id"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_id, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("ref"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_ref, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("type"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_type, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("bnd"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_bnd, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("marker"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_marker, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("used"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_used, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("__str__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node___str__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("coord"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4Node_coord, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Node = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Node = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Node = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Node = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Node = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Node"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Node), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Node, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Node, /*tp_as_number*/
  &__pyx_tp_as_sequence_Node, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Node, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pf_8hermes2d_9_hermes2d_4Node___str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Node, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Node, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Node, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Element(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_Element(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Element[] = {
  {__Pyx_NAMESTR("id"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_id, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("nvert"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_nvert, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("active"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_active, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("used"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_used, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("marker"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_marker, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("nodes_vertex"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("nodes_vertex_id"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_vertex_id, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("nodes_edge"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_nodes_edge, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_vertex_node"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_get_vertex_node, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("curved_map"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_curved_map, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_edge_node"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_get_edge_node, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_son_element"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_get_son_element, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("__str__"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element___str__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_diameter"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_get_diameter, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("get_area"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_7Element_get_area, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Element = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Element = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Element = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Element = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Element = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Element"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Element), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Element, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Element, /*tp_as_number*/
  &__pyx_tp_as_sequence_Element, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Element, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pf_8hermes2d_9_hermes2d_7Element___str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Element, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Element, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Element, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_H1Shapeset(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_H1Shapeset(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_10H1Shapeset___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_H1Shapeset[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_H1Shapeset = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_H1Shapeset = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_H1Shapeset = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_H1Shapeset = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_H1Shapeset = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.H1Shapeset"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_H1Shapeset), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_H1Shapeset, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_H1Shapeset, /*tp_as_number*/
  &__pyx_tp_as_sequence_H1Shapeset, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_H1Shapeset, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_H1Shapeset, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_H1Shapeset, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_H1Shapeset, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_L2Shapeset(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_L2Shapeset(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_10L2Shapeset___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_L2Shapeset[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_L2Shapeset = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_L2Shapeset = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_L2Shapeset = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_L2Shapeset = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_L2Shapeset = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.L2Shapeset"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_L2Shapeset), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_L2Shapeset, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_L2Shapeset, /*tp_as_number*/
  &__pyx_tp_as_sequence_L2Shapeset, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_L2Shapeset, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_L2Shapeset, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" L2 Shapeset.\n\n        Suggested Use: ```l2_shapeset = L2Shapeset()```\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_L2Shapeset, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_L2Shapeset, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_PrecalcShapeset(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_PrecalcShapeset(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_8hermes2d_9_hermes2d_15PrecalcShapeset___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_PrecalcShapeset[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_PrecalcShapeset = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_PrecalcShapeset = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_PrecalcShapeset = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_PrecalcShapeset = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_PrecalcShapeset = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.PrecalcShapeset"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_PrecalcShapeset), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_PrecalcShapeset, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_PrecalcShapeset, /*tp_as_number*/
  &__pyx_tp_as_sequence_PrecalcShapeset, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_PrecalcShapeset, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_PrecalcShapeset, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_PrecalcShapeset, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_PrecalcShapeset, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_Filter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_Filter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Filter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Filter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Filter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Filter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_Filter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.Filter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_Filter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Filter, /*tp_as_number*/
  &__pyx_tp_as_sequence_Filter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Filter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Filter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_Filter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_Filter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_SimpleFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_SimpleFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SimpleFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_SimpleFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SimpleFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SimpleFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_SimpleFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.SimpleFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_SimpleFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SimpleFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_SimpleFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SimpleFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SimpleFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_SimpleFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_SimpleFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_VonMisesFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_14VonMisesFilter___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_VonMisesFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_VonMisesFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_VonMisesFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_VonMisesFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_VonMisesFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_VonMisesFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.VonMisesFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_VonMisesFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_VonMisesFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_VonMisesFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_VonMisesFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_VonMisesFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_VonMisesFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_VonMisesFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_MagFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_9MagFilter___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_MagFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_MagFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_MagFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_MagFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_MagFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_MagFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.MagFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_MagFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_MagFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_MagFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_MagFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_MagFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_MagFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_MagFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_DiffFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10DiffFilter___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_DiffFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_DiffFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_DiffFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_DiffFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_DiffFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_DiffFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.DiffFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_DiffFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_DiffFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_DiffFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_DiffFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_DiffFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_DiffFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_DiffFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_SumFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_9SumFilter___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_SumFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SumFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_SumFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SumFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SumFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_SumFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.SumFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_SumFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SumFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_SumFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SumFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SumFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_SumFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_SumFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_SquareFilter(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_Transformable(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_12SquareFilter___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_SquareFilter[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SquareFilter = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_SquareFilter = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SquareFilter = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SquareFilter = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_SquareFilter = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.SquareFilter"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_SquareFilter), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_Transformable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SquareFilter, /*tp_as_number*/
  &__pyx_tp_as_sequence_SquareFilter, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SquareFilter, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SquareFilter, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_SquareFilter, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_SquareFilter, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_CandList(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_CandList(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_CandList[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_CandList = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_CandList = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_CandList = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_CandList = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_CandList = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.CandList"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_CandList), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_CandList, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_CandList, /*tp_as_number*/
  &__pyx_tp_as_sequence_CandList, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_CandList, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_CandList, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" A prefined list of andidates.\n\n        Possible values are attributes of the class:\n\n        - P_ISO: P-candidates only. Orders are modified uniformly.\n\t- P_ANISO: P-candidates only. Orders are modified non-uniformly.\n\t- H_ISO: H-candidates only. Orders are not modified.\n\t- H_ANISO: H- and ANISO-candidates only. Orders are not modified.\n\t- HP_ISO: H- and P-candidates only. Orders are modified uniformly.\n\t- HP_ANISO_H: H-, ANISO- and P-candidates. Orders are modified uniformly.\n\t- HP_ANISO_P: H- and P-candidates only. Orders are modified non-uniformly.\n\t- HP_ANISO: H-, ANISO- and P-candidates. Orders are modified non-uniformly.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_CandList, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_CandList, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_SelOption(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_SelOption(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_SelOption[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SelOption = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_SelOption = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SelOption = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SelOption = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_SelOption = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.SelOption"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_SelOption), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_SelOption, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SelOption, /*tp_as_number*/
  &__pyx_tp_as_sequence_SelOption, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SelOption, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SelOption, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  __Pyx_DOCSTR(" Options of the selector.\n\n        Possible values are attributes of the class:\n\n\t- PREFER_SYMMETRIC_MESH: Prefer symmetric mesh when selection of the best candidate is done. If two or more candiates has the same score, they are skipped. This option is set by default.\n\t- APPLY_CONV_EXP_DOF: Use $d^c - d_0^c$, where $c$ is the convergence exponent, instead of $(d - d_0)^c$ to evaluate the score. This option is not set by default.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_SelOption, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_SelOption, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_View(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8hermes2d_9_hermes2d_View(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_View[] = {
  {__Pyx_NAMESTR("wait"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_4View_wait, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_View = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_View = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_View = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_View = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_View = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.View"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_View), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_View, /*tp_as_number*/
  &__pyx_tp_as_sequence_View, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_View, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_View, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_View, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_View, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_ScalarView(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_View(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10ScalarView___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_ScalarView[] = {
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("show_mesh"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_mesh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("show_scale"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_show_scale, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_min_max_range"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_min_max_range, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_title"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_set_title, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("wait"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10ScalarView_wait, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ScalarView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ScalarView = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ScalarView = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ScalarView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_ScalarView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.ScalarView"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_ScalarView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ScalarView, /*tp_as_number*/
  &__pyx_tp_as_sequence_ScalarView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ScalarView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ScalarView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_ScalarView, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_ScalarView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_BaseView(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_View(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_8BaseView___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_BaseView[] = {
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8BaseView_show, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_BaseView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_BaseView = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_BaseView = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_BaseView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_BaseView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.BaseView"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_BaseView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_BaseView, /*tp_as_number*/
  &__pyx_tp_as_sequence_BaseView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_BaseView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_BaseView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_BaseView, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_BaseView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_MeshView(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_View(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_8MeshView___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_MeshView[] = {
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_8MeshView_show, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_MeshView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_MeshView = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_MeshView = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_MeshView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_MeshView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.MeshView"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_MeshView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_MeshView, /*tp_as_number*/
  &__pyx_tp_as_sequence_MeshView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_MeshView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_MeshView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_MeshView, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_MeshView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_OrderView(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_View(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_9OrderView___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_OrderView[] = {
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_9OrderView_show, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_OrderView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_OrderView = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_OrderView = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_OrderView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_OrderView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.OrderView"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_OrderView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_OrderView, /*tp_as_number*/
  &__pyx_tp_as_sequence_OrderView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_OrderView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_OrderView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_OrderView, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_OrderView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_8hermes2d_9_hermes2d_VectorView(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_tp_new_8hermes2d_9_hermes2d_View(t, a, k);
  if (!o) return 0;
  if (__pyx_pf_8hermes2d_9_hermes2d_10VectorView___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static struct PyMethodDef __pyx_methods_8hermes2d_9_hermes2d_VectorView[] = {
  {__Pyx_NAMESTR("show"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("show_scale"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10VectorView_show_scale, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_min_max_range"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_10VectorView_set_min_max_range, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_VectorView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_VectorView = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_VectorView = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_VectorView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8hermes2d_9_hermes2d_VectorView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("hermes2d._hermes2d.VectorView"), /*tp_name*/
  sizeof(struct __pyx_obj_8hermes2d_9_hermes2d_VectorView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8hermes2d_9_hermes2d_View, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_VectorView, /*tp_as_number*/
  &__pyx_tp_as_sequence_VectorView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_VectorView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_VectorView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8hermes2d_9_hermes2d_VectorView, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8hermes2d_9_hermes2d_VectorView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {__Pyx_NAMESTR("get_node_id"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_get_node_id, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("init_hermes2d_wrappers"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_init_hermes2d_wrappers, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("set_verbose"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_set_verbose, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_set_verbose)},
  {__Pyx_NAMESTR("set_warn_integration"), (PyCFunction)__pyx_pf_8hermes2d_9_hermes2d_set_warn_integration, METH_O, __Pyx_DOCSTR(__pyx_doc_8hermes2d_9_hermes2d_set_warn_integration)},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    __Pyx_NAMESTR("_hermes2d"),
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp___main__, __pyx_k___main__, sizeof(__pyx_k___main__), 1, 1, 1},
  {&__pyx_kp_degree, __pyx_k_degree, sizeof(__pyx_k_degree), 1, 1, 1},
  {&__pyx_kp_np, __pyx_k_np, sizeof(__pyx_k_np), 1, 1, 1},
  {&__pyx_kp_pt, __pyx_k_pt, sizeof(__pyx_k_pt), 1, 1, 1},
  {&__pyx_kp_nk, __pyx_k_nk, sizeof(__pyx_k_nk), 1, 1, 1},
  {&__pyx_kp_kv, __pyx_k_kv, sizeof(__pyx_k_kv), 1, 1, 1},
  {&__pyx_kp_ref, __pyx_k_ref, sizeof(__pyx_k_ref), 1, 1, 1},
  {&__pyx_kp_order, __pyx_k_order, sizeof(__pyx_k_order), 1, 1, 1},
  {&__pyx_kp_toplevel, __pyx_k_toplevel, sizeof(__pyx_k_toplevel), 1, 1, 1},
  {&__pyx_kp_get_nurbs, __pyx_k_get_nurbs, sizeof(__pyx_k_get_nurbs), 1, 1, 1},
  {&__pyx_kp_id, __pyx_k_id, sizeof(__pyx_k_id), 1, 1, 1},
  {&__pyx_kp_type, __pyx_k_type, sizeof(__pyx_k_type), 1, 1, 1},
  {&__pyx_kp_bnd, __pyx_k_bnd, sizeof(__pyx_k_bnd), 1, 1, 1},
  {&__pyx_kp_marker, __pyx_k_marker, sizeof(__pyx_k_marker), 1, 1, 1},
  {&__pyx_kp_used, __pyx_k_used, sizeof(__pyx_k_used), 1, 1, 1},
  {&__pyx_kp___str__, __pyx_k___str__, sizeof(__pyx_k___str__), 1, 1, 1},
  {&__pyx_kp_coord, __pyx_k_coord, sizeof(__pyx_k_coord), 1, 1, 1},
  {&__pyx_kp_nvert, __pyx_k_nvert, sizeof(__pyx_k_nvert), 1, 1, 1},
  {&__pyx_kp_active, __pyx_k_active, sizeof(__pyx_k_active), 1, 1, 1},
  {&__pyx_kp_nodes_vertex, __pyx_k_nodes_vertex, sizeof(__pyx_k_nodes_vertex), 1, 1, 1},
  {&__pyx_kp_nodes_vertex_id, __pyx_k_nodes_vertex_id, sizeof(__pyx_k_nodes_vertex_id), 1, 1, 1},
  {&__pyx_kp_nodes_edge, __pyx_k_nodes_edge, sizeof(__pyx_k_nodes_edge), 1, 1, 1},
  {&__pyx_kp_get_vertex_node, __pyx_k_get_vertex_node, sizeof(__pyx_k_get_vertex_node), 1, 1, 1},
  {&__pyx_kp_curved_map, __pyx_k_curved_map, sizeof(__pyx_k_curved_map), 1, 1, 1},
  {&__pyx_kp_get_edge_node, __pyx_k_get_edge_node, sizeof(__pyx_k_get_edge_node), 1, 1, 1},
  {&__pyx_kp_get_son_element, __pyx_k_get_son_element, sizeof(__pyx_k_get_son_element), 1, 1, 1},
  {&__pyx_kp_get_diameter, __pyx_k_get_diameter, sizeof(__pyx_k_get_diameter), 1, 1, 1},
  {&__pyx_kp_get_area, __pyx_k_get_area, sizeof(__pyx_k_get_area), 1, 1, 1},
  {&__pyx_kp___cinit__, __pyx_k___cinit__, sizeof(__pyx_k___cinit__), 1, 1, 1},
  {&__pyx_kp___dealloc__, __pyx_k___dealloc__, sizeof(__pyx_k___dealloc__), 1, 1, 1},
  {&__pyx_kp_copy, __pyx_k_copy, sizeof(__pyx_k_copy), 1, 1, 1},
  {&__pyx_kp_load, __pyx_k_load, sizeof(__pyx_k_load), 1, 1, 1},
  {&__pyx_kp_load_str, __pyx_k_load_str, sizeof(__pyx_k_load_str), 1, 1, 1},
  {&__pyx_kp_elements_markers, __pyx_k_elements_markers, sizeof(__pyx_k_elements_markers), 1, 1, 1},
  {&__pyx_kp_elements, __pyx_k_elements, sizeof(__pyx_k_elements), 1, 1, 1},
  {&__pyx_kp_active_elements, __pyx_k_active_elements, sizeof(__pyx_k_active_elements), 1, 1, 1},
  {&__pyx_kp_nodes, __pyx_k_nodes, sizeof(__pyx_k_nodes), 1, 1, 1},
  {&__pyx_kp_nodes_dict, __pyx_k_nodes_dict, sizeof(__pyx_k_nodes_dict), 1, 1, 1},
  {&__pyx_kp_curves, __pyx_k_curves, sizeof(__pyx_k_curves), 1, 1, 1},
  {&__pyx_kp_1, __pyx_k_1, sizeof(__pyx_k_1), 1, 1, 1},
  {&__pyx_kp_num_elements, __pyx_k_num_elements, sizeof(__pyx_k_num_elements), 1, 1, 1},
  {&__pyx_kp_num_base_elements, __pyx_k_num_base_elements, sizeof(__pyx_k_num_base_elements), 1, 1, 1},
  {&__pyx_kp_num_active_elements, __pyx_k_num_active_elements, sizeof(__pyx_k_num_active_elements), 1, 1, 1},
  {&__pyx_kp_max_element_id, __pyx_k_max_element_id, sizeof(__pyx_k_max_element_id), 1, 1, 1},
  {&__pyx_kp_load_hermes, __pyx_k_load_hermes, sizeof(__pyx_k_load_hermes), 1, 1, 1},
  {&__pyx_kp_get_elements_order, __pyx_k_get_elements_order, sizeof(__pyx_k_get_elements_order), 1, 1, 1},
  {&__pyx_kp_create, __pyx_k_create, sizeof(__pyx_k_create), 1, 1, 1},
  {&__pyx_kp_save, __pyx_k_save, sizeof(__pyx_k_save), 1, 1, 1},
  {&__pyx_kp_refine_element, __pyx_k_refine_element, sizeof(__pyx_k_refine_element), 1, 1, 1},
  {&__pyx_kp_refine_all_elements, __pyx_k_refine_all_elements, sizeof(__pyx_k_refine_all_elements), 1, 1, 1},
  {&__pyx_kp_2, __pyx_k_2, sizeof(__pyx_k_2), 1, 1, 1},
  {&__pyx_kp_3, __pyx_k_3, sizeof(__pyx_k_3), 1, 1, 1},
  {&__pyx_kp_get_element, __pyx_k_get_element, sizeof(__pyx_k_get_element), 1, 1, 1},
  {&__pyx_kp_plot, __pyx_k_plot, sizeof(__pyx_k_plot), 1, 1, 1},
  {&__pyx_kp_show, __pyx_k_show, sizeof(__pyx_k_show), 1, 1, 1},
  {&__pyx_kp_4, __pyx_k_4, sizeof(__pyx_k_4), 1, 1, 1},
  {&__pyx_kp_5, __pyx_k_5, sizeof(__pyx_k_5), 1, 1, 1},
  {&__pyx_kp___init__, __pyx_k___init__, sizeof(__pyx_k___init__), 1, 1, 1},
  {&__pyx_kp_set_uniform_order, __pyx_k_set_uniform_order, sizeof(__pyx_k_set_uniform_order), 1, 1, 1},
  {&__pyx_kp_assign_dofs, __pyx_k_assign_dofs, sizeof(__pyx_k_assign_dofs), 1, 1, 1},
  {&__pyx_kp_copy_orders, __pyx_k_copy_orders, sizeof(__pyx_k_copy_orders), 1, 1, 1},
  {&__pyx_kp_get_element_order, __pyx_k_get_element_order, sizeof(__pyx_k_get_element_order), 1, 1, 1},
  {&__pyx_kp_get_num_dofs, __pyx_k_get_num_dofs, sizeof(__pyx_k_get_num_dofs), 1, 1, 1},
  {&__pyx_kp___add__, __pyx_k___add__, sizeof(__pyx_k___add__), 1, 1, 1},
  {&__pyx_kp___sub__, __pyx_k___sub__, sizeof(__pyx_k___sub__), 1, 1, 1},
  {&__pyx_kp___pow__, __pyx_k___pow__, sizeof(__pyx_k___pow__), 1, 1, 1},
  {&__pyx_kp___neg__, __pyx_k___neg__, sizeof(__pyx_k___neg__), 1, 1, 1},
  {&__pyx_kp_6, __pyx_k_6, sizeof(__pyx_k_6), 1, 1, 1},
  {&__pyx_kp_7, __pyx_k_7, sizeof(__pyx_k_7), 1, 1, 1},
  {&__pyx_kp_get_pt_value, __pyx_k_get_pt_value, sizeof(__pyx_k_get_pt_value), 1, 1, 1},
  {&__pyx_kp_get_mesh, __pyx_k_get_mesh, sizeof(__pyx_k_get_mesh), 1, 1, 1},
  {&__pyx_kp_copy_by_reference, __pyx_k_copy_by_reference, sizeof(__pyx_k_copy_by_reference), 1, 1, 1},
  {&__pyx_kp_set_zero, __pyx_k_set_zero, sizeof(__pyx_k_set_zero), 1, 1, 1},
  {&__pyx_kp_set_const, __pyx_k_set_const, sizeof(__pyx_k_set_const), 1, 1, 1},
  {&__pyx_kp_set_fe_solution, __pyx_k_set_fe_solution, sizeof(__pyx_k_set_fe_solution), 1, 1, 1},
  {&__pyx_kp_set_spaces, __pyx_k_set_spaces, sizeof(__pyx_k_set_spaces), 1, 1, 1},
  {&__pyx_kp_set_pss, __pyx_k_set_pss, sizeof(__pyx_k_set_pss), 1, 1, 1},
  {&__pyx_kp_solve_system, __pyx_k_solve_system, sizeof(__pyx_k_solve_system), 1, 1, 1},
  {&__pyx_kp_assemble, __pyx_k_assemble, sizeof(__pyx_k_assemble), 1, 1, 1},
  {&__pyx_kp_get_matrix_csc, __pyx_k_get_matrix_csc, sizeof(__pyx_k_get_matrix_csc), 1, 1, 1},
  {&__pyx_kp_get_matrix, __pyx_k_get_matrix, sizeof(__pyx_k_get_matrix), 1, 1, 1},
  {&__pyx_kp_get_rhs, __pyx_k_get_rhs, sizeof(__pyx_k_get_rhs), 1, 1, 1},
  {&__pyx_kp_P_ISO, __pyx_k_P_ISO, sizeof(__pyx_k_P_ISO), 1, 1, 1},
  {&__pyx_kp_P_ANISO, __pyx_k_P_ANISO, sizeof(__pyx_k_P_ANISO), 1, 1, 1},
  {&__pyx_kp_H_ISO, __pyx_k_H_ISO, sizeof(__pyx_k_H_ISO), 1, 1, 1},
  {&__pyx_kp_H_ANISO, __pyx_k_H_ANISO, sizeof(__pyx_k_H_ANISO), 1, 1, 1},
  {&__pyx_kp_HP_ISO, __pyx_k_HP_ISO, sizeof(__pyx_k_HP_ISO), 1, 1, 1},
  {&__pyx_kp_HP_ANISO_H, __pyx_k_HP_ANISO_H, sizeof(__pyx_k_HP_ANISO_H), 1, 1, 1},
  {&__pyx_kp_HP_ANISO_P, __pyx_k_HP_ANISO_P, sizeof(__pyx_k_HP_ANISO_P), 1, 1, 1},
  {&__pyx_kp_HP_ANISO, __pyx_k_HP_ANISO, sizeof(__pyx_k_HP_ANISO), 1, 1, 1},
  {&__pyx_kp_8, __pyx_k_8, sizeof(__pyx_k_8), 1, 1, 1},
  {&__pyx_kp_APPLY_CONV_EXP_DOF, __pyx_k_APPLY_CONV_EXP_DOF, sizeof(__pyx_k_APPLY_CONV_EXP_DOF), 1, 1, 1},
  {&__pyx_kp_set_error_weights, __pyx_k_set_error_weights, sizeof(__pyx_k_set_error_weights), 1, 1, 1},
  {&__pyx_kp_set_option, __pyx_k_set_option, sizeof(__pyx_k_set_option), 1, 1, 1},
  {&__pyx_kp_set_solutions, __pyx_k_set_solutions, sizeof(__pyx_k_set_solutions), 1, 1, 1},
  {&__pyx_kp_calc_error, __pyx_k_calc_error, sizeof(__pyx_k_calc_error), 1, 1, 1},
  {&__pyx_kp_adapt, __pyx_k_adapt, sizeof(__pyx_k_adapt), 1, 1, 1},
  {&__pyx_kp_process_solution, __pyx_k_process_solution, sizeof(__pyx_k_process_solution), 1, 1, 1},
  {&__pyx_kp_get_vertices, __pyx_k_get_vertices, sizeof(__pyx_k_get_vertices), 1, 1, 1},
  {&__pyx_kp_get_num_vertices, __pyx_k_get_num_vertices, sizeof(__pyx_k_get_num_vertices), 1, 1, 1},
  {&__pyx_kp_get_triangles, __pyx_k_get_triangles, sizeof(__pyx_k_get_triangles), 1, 1, 1},
  {&__pyx_kp_get_num_triangles, __pyx_k_get_num_triangles, sizeof(__pyx_k_get_num_triangles), 1, 1, 1},
  {&__pyx_kp_get_edges, __pyx_k_get_edges, sizeof(__pyx_k_get_edges), 1, 1, 1},
  {&__pyx_kp_get_num_edges, __pyx_k_get_num_edges, sizeof(__pyx_k_get_num_edges), 1, 1, 1},
  {&__pyx_kp_get_min_value, __pyx_k_get_min_value, sizeof(__pyx_k_get_min_value), 1, 1, 1},
  {&__pyx_kp_get_max_value, __pyx_k_get_max_value, sizeof(__pyx_k_get_max_value), 1, 1, 1},
  {&__pyx_kp_save_data, __pyx_k_save_data, sizeof(__pyx_k_save_data), 1, 1, 1},
  {&__pyx_kp_load_data, __pyx_k_load_data, sizeof(__pyx_k_load_data), 1, 1, 1},
  {&__pyx_kp_get_dashes, __pyx_k_get_dashes, sizeof(__pyx_k_get_dashes), 1, 1, 1},
  {&__pyx_kp_wait, __pyx_k_wait, sizeof(__pyx_k_wait), 1, 1, 1},
  {&__pyx_kp_show_mesh, __pyx_k_show_mesh, sizeof(__pyx_k_show_mesh), 1, 1, 1},
  {&__pyx_kp_show_scale, __pyx_k_show_scale, sizeof(__pyx_k_show_scale), 1, 1, 1},
  {&__pyx_kp_set_min_max_range, __pyx_k_set_min_max_range, sizeof(__pyx_k_set_min_max_range), 1, 1, 1},
  {&__pyx_kp_set_title, __pyx_k_set_title, sizeof(__pyx_k_set_title), 1, 1, 1},
  {&__pyx_kp_k, __pyx_k_k, sizeof(__pyx_k_k), 1, 1, 1},
  {&__pyx_kp_node, __pyx_k_node, sizeof(__pyx_k_node), 1, 1, 1},
  {&__pyx_kp_m, __pyx_k_m, sizeof(__pyx_k_m), 1, 1, 1},
  {&__pyx_kp_filename, __pyx_k_filename, sizeof(__pyx_k_filename), 1, 1, 1},
  {&__pyx_kp_mesh, __pyx_k_mesh, sizeof(__pyx_k_mesh), 1, 1, 1},
  {&__pyx_kp_space, __pyx_k_space, sizeof(__pyx_k_space), 1, 1, 1},
  {&__pyx_kp_boundary, __pyx_k_boundary, sizeof(__pyx_k_boundary), 1, 1, 1},
  {&__pyx_kp_nurbs, __pyx_k_nurbs, sizeof(__pyx_k_nurbs), 1, 1, 1},
  {&__pyx_kp_refinement, __pyx_k_refinement, sizeof(__pyx_k_refinement), 1, 1, 1},
  {&__pyx_kp_depth, __pyx_k_depth, sizeof(__pyx_k_depth), 1, 1, 1},
  {&__pyx_kp_h, __pyx_k_h, sizeof(__pyx_k_h), 1, 1, 1},
  {&__pyx_kp_tri_order, __pyx_k_tri_order, sizeof(__pyx_k_tri_order), 1, 1, 1},
  {&__pyx_kp_first_dof, __pyx_k_first_dof, sizeof(__pyx_k_first_dof), 1, 1, 1},
  {&__pyx_kp_stride, __pyx_k_stride, sizeof(__pyx_k_stride), 1, 1, 1},
  {&__pyx_kp_s, __pyx_k_s, sizeof(__pyx_k_s), 1, 1, 1},
  {&__pyx_kp_inc, __pyx_k_inc, sizeof(__pyx_k_inc), 1, 1, 1},
  {&__pyx_kp_el_id, __pyx_k_el_id, sizeof(__pyx_k_el_id), 1, 1, 1},
  {&__pyx_kp_x, __pyx_k_x, sizeof(__pyx_k_x), 1, 1, 1},
  {&__pyx_kp_y, __pyx_k_y, sizeof(__pyx_k_y), 1, 1, 1},
  {&__pyx_kp_z, __pyx_k_z, sizeof(__pyx_k_z), 1, 1, 1},
  {&__pyx_kp_scalar, __pyx_k_scalar, sizeof(__pyx_k_scalar), 1, 1, 1},
  {&__pyx_kp_pss, __pyx_k_pss, sizeof(__pyx_k_pss), 1, 1, 1},
  {&__pyx_kp_v, __pyx_k_v, sizeof(__pyx_k_v), 1, 1, 1},
  {&__pyx_kp_9, __pyx_k_9, sizeof(__pyx_k_9), 1, 1, 1},
  {&__pyx_kp_10, __pyx_k_10, sizeof(__pyx_k_10), 1, 1, 1},
  {&__pyx_kp_l, __pyx_k_l, sizeof(__pyx_k_l), 1, 1, 1},
  {&__pyx_kp_11, __pyx_k_11, sizeof(__pyx_k_11), 1, 1, 1},
  {&__pyx_kp_12, __pyx_k_12, sizeof(__pyx_k_12), 1, 1, 1},
  {&__pyx_kp_sln, __pyx_k_sln, sizeof(__pyx_k_sln), 1, 1, 1},
  {&__pyx_kp_item, __pyx_k_item, sizeof(__pyx_k_item), 1, 1, 1},
  {&__pyx_kp_neq, __pyx_k_neq, sizeof(__pyx_k_neq), 1, 1, 1},
  {&__pyx_kp_wf, __pyx_k_wf, sizeof(__pyx_k_wf), 1, 1, 1},
  {&__pyx_kp_solver, __pyx_k_solver, sizeof(__pyx_k_solver), 1, 1, 1},
  {&__pyx_kp_lib, __pyx_k_lib, sizeof(__pyx_k_lib), 1, 1, 1},
  {&__pyx_kp_ls, __pyx_k_ls, sizeof(__pyx_k_ls), 1, 1, 1},
  {&__pyx_kp_weight_h, __pyx_k_weight_h, sizeof(__pyx_k_weight_h), 1, 1, 1},
  {&__pyx_kp_weight_p, __pyx_k_weight_p, sizeof(__pyx_k_weight_p), 1, 1, 1},
  {&__pyx_kp_weight_aniso, __pyx_k_weight_aniso, sizeof(__pyx_k_weight_aniso), 1, 1, 1},
  {&__pyx_kp_option, __pyx_k_option, sizeof(__pyx_k_option), 1, 1, 1},
  {&__pyx_kp_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 1, 1, 1},
  {&__pyx_kp_cand_list, __pyx_k_cand_list, sizeof(__pyx_k_cand_list), 1, 1, 1},
  {&__pyx_kp_conv_exp, __pyx_k_conv_exp, sizeof(__pyx_k_conv_exp), 1, 1, 1},
  {&__pyx_kp_max_order, __pyx_k_max_order, sizeof(__pyx_k_max_order), 1, 1, 1},
  {&__pyx_kp_shapeset, __pyx_k_shapeset, sizeof(__pyx_k_shapeset), 1, 1, 1},
  {&__pyx_kp_sln_list, __pyx_k_sln_list, sizeof(__pyx_k_sln_list), 1, 1, 1},
  {&__pyx_kp_rsln_list, __pyx_k_rsln_list, sizeof(__pyx_k_rsln_list), 1, 1, 1},
  {&__pyx_kp_error_flags, __pyx_k_error_flags, sizeof(__pyx_k_error_flags), 1, 1, 1},
  {&__pyx_kp_selector, __pyx_k_selector, sizeof(__pyx_k_selector), 1, 1, 1},
  {&__pyx_kp_thr, __pyx_k_thr, sizeof(__pyx_k_thr), 1, 1, 1},
  {&__pyx_kp_strat, __pyx_k_strat, sizeof(__pyx_k_strat), 1, 1, 1},
  {&__pyx_kp_regularize, __pyx_k_regularize, sizeof(__pyx_k_regularize), 1, 1, 1},
  {&__pyx_kp_same_orders, __pyx_k_same_orders, sizeof(__pyx_k_same_orders), 1, 1, 1},
  {&__pyx_kp_to_be_processed, __pyx_k_to_be_processed, sizeof(__pyx_k_to_be_processed), 1, 1, 1},
  {&__pyx_kp_space_list, __pyx_k_space_list, sizeof(__pyx_k_space_list), 1, 1, 1},
  {&__pyx_kp_xsln, __pyx_k_xsln, sizeof(__pyx_k_xsln), 1, 1, 1},
  {&__pyx_kp_ysln, __pyx_k_ysln, sizeof(__pyx_k_ysln), 1, 1, 1},
  {&__pyx_kp_xitem, __pyx_k_xitem, sizeof(__pyx_k_xitem), 1, 1, 1},
  {&__pyx_kp_yitem, __pyx_k_yitem, sizeof(__pyx_k_yitem), 1, 1, 1},
  {&__pyx_kp_eps, __pyx_k_eps, sizeof(__pyx_k_eps), 1, 1, 1},
  {&__pyx_kp_title, __pyx_k_title, sizeof(__pyx_k_title), 1, 1, 1},
  {&__pyx_kp_width, __pyx_k_width, sizeof(__pyx_k_width), 1, 1, 1},
  {&__pyx_kp_height, __pyx_k_height, sizeof(__pyx_k_height), 1, 1, 1},
  {&__pyx_kp_min, __pyx_k_min, sizeof(__pyx_k_min), 1, 1, 1},
  {&__pyx_kp_max, __pyx_k_max, sizeof(__pyx_k_max), 1, 1, 1},
  {&__pyx_kp_13, __pyx_k_13, sizeof(__pyx_k_13), 1, 1, 1},
  {&__pyx_kp_14, __pyx_k_14, sizeof(__pyx_k_14), 1, 1, 1},
  {&__pyx_kp_verbose, __pyx_k_verbose, sizeof(__pyx_k_verbose), 1, 1, 1},
  {&__pyx_kp_warn_integration, __pyx_k_warn_integration, sizeof(__pyx_k_warn_integration), 1, 1, 1},
  {&__pyx_kp_15, __pyx_k_15, sizeof(__pyx_k_15), 1, 1, 1},
  {&__pyx_kp_16, __pyx_k_16, sizeof(__pyx_k_16), 1, 1, 1},
  {&__pyx_kp_17, __pyx_k_17, sizeof(__pyx_k_17), 1, 1, 1},
  {&__pyx_kp_18, __pyx_k_18, sizeof(__pyx_k_18), 1, 1, 1},
  {&__pyx_kp_19, __pyx_k_19, sizeof(__pyx_k_19), 1, 1, 1},
  {&__pyx_kp_20, __pyx_k_20, sizeof(__pyx_k_20), 1, 1, 1},
  {&__pyx_kp_21, __pyx_k_21, sizeof(__pyx_k_21), 1, 1, 1},
  {&__pyx_kp_22, __pyx_k_22, sizeof(__pyx_k_22), 1, 1, 1},
  {&__pyx_kp_23, __pyx_k_23, sizeof(__pyx_k_23), 1, 1, 1},
  {&__pyx_kp_24, __pyx_k_24, sizeof(__pyx_k_24), 1, 1, 1},
  {&__pyx_kp_25, __pyx_k_25, sizeof(__pyx_k_25), 1, 1, 1},
  {&__pyx_kp_26, __pyx_k_26, sizeof(__pyx_k_26), 1, 1, 1},
  {&__pyx_kp_27, __pyx_k_27, sizeof(__pyx_k_27), 1, 1, 1},
  {&__pyx_kp_28, __pyx_k_28, sizeof(__pyx_k_28), 1, 1, 1},
  {&__pyx_kp_property, __pyx_k_property, sizeof(__pyx_k_property), 1, 1, 1},
  {&__pyx_kp_34, __pyx_k_34, sizeof(__pyx_k_34), 0, 1, 0},
  {&__pyx_kp_46, __pyx_k_46, sizeof(__pyx_k_46), 1, 1, 1},
  {&__pyx_kp_reshape, __pyx_k_reshape, sizeof(__pyx_k_reshape), 1, 1, 1},
  {&__pyx_kp_range, __pyx_k_range, sizeof(__pyx_k_range), 1, 1, 1},
  {&__pyx_kp_append, __pyx_k_append, sizeof(__pyx_k_append), 1, 1, 1},
  {&__pyx_kp_extend, __pyx_k_extend, sizeof(__pyx_k_extend), 1, 1, 1},
  {&__pyx_kp_values, __pyx_k_values, sizeof(__pyx_k_values), 1, 1, 1},
  {&__pyx_kp_sort, __pyx_k_sort, sizeof(__pyx_k_sort), 1, 1, 1},
  {&__pyx_kp_key, __pyx_k_key, sizeof(__pyx_k_key), 1, 1, 1},
  {&__pyx_kp_get_node_id, __pyx_k_get_node_id, sizeof(__pyx_k_get_node_id), 1, 1, 1},
  {&__pyx_kp_read_hermes_format, __pyx_k_read_hermes_format, sizeof(__pyx_k_read_hermes_format), 1, 1, 1},
  {&__pyx_kp_math, __pyx_k_math, sizeof(__pyx_k_math), 1, 1, 1},
  {&__pyx_kp_61, __pyx_k_61, sizeof(__pyx_k_61), 1, 1, 1},
  {&__pyx_kp_MeshView, __pyx_k_MeshView, sizeof(__pyx_k_MeshView), 1, 1, 1},
  {&__pyx_kp_NotImplemented, __pyx_k_NotImplemented, sizeof(__pyx_k_NotImplemented), 1, 1, 1},
  {&__pyx_kp_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 1, 1, 1},
  {&__pyx_kp_array, __pyx_k_array, sizeof(__pyx_k_array), 1, 1, 1},
  {&__pyx_kp_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 1, 1, 1},
  {&__pyx_kp_62, __pyx_k_62, sizeof(__pyx_k_62), 0, 1, 0},
  {&__pyx_kp_ScalarView, __pyx_k_ScalarView, sizeof(__pyx_k_ScalarView), 1, 1, 1},
  {&__pyx_kp_NotImplementedError, __pyx_k_NotImplementedError, sizeof(__pyx_k_NotImplementedError), 1, 1, 1},
  {&__pyx_kp_63, __pyx_k_63, sizeof(__pyx_k_63), 0, 1, 0},
  {&__pyx_kp_64, __pyx_k_64, sizeof(__pyx_k_64), 0, 1, 0},
  {&__pyx_kp_warnings, __pyx_k_warnings, sizeof(__pyx_k_warnings), 1, 1, 1},
  {&__pyx_kp_65, __pyx_k_65, sizeof(__pyx_k_65), 1, 1, 1},
  {&__pyx_kp_cg, __pyx_k_cg, sizeof(__pyx_k_cg), 1, 1, 1},
  {&__pyx_kp_spsolve, __pyx_k_spsolve, sizeof(__pyx_k_spsolve), 1, 1, 1},
  {&__pyx_kp_catch_warnings, __pyx_k_catch_warnings, sizeof(__pyx_k_catch_warnings), 1, 1, 1},
  {&__pyx_kp___exit__, __pyx_k___exit__, sizeof(__pyx_k___exit__), 1, 1, 1},
  {&__pyx_kp___enter__, __pyx_k___enter__, sizeof(__pyx_k___enter__), 1, 1, 1},
  {&__pyx_kp_simplefilter, __pyx_k_simplefilter, sizeof(__pyx_k_simplefilter), 1, 1, 1},
  {&__pyx_kp_66, __pyx_k_66, sizeof(__pyx_k_66), 0, 1, 0},
  {&__pyx_kp_67, __pyx_k_67, sizeof(__pyx_k_67), 0, 1, 0},
  {&__pyx_kp_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 1, 1, 1},
  {&__pyx_kp_69, __pyx_k_69, sizeof(__pyx_k_69), 1, 1, 1},
  {&__pyx_kp_csc_matrix, __pyx_k_csc_matrix, sizeof(__pyx_k_csc_matrix), 1, 1, 1},
  {&__pyx_kp_47, __pyx_k_47, sizeof(__pyx_k_47), 0, 0, 0},
  {&__pyx_kp_48, __pyx_k_48, sizeof(__pyx_k_48), 0, 0, 0},
  {&__pyx_kp_49, __pyx_k_49, sizeof(__pyx_k_49), 0, 0, 0},
  {&__pyx_kp_50, __pyx_k_50, sizeof(__pyx_k_50), 0, 0, 0},
  {&__pyx_kp_51, __pyx_k_51, sizeof(__pyx_k_51), 0, 0, 0},
  {&__pyx_kp_52, __pyx_k_52, sizeof(__pyx_k_52), 0, 0, 0},
  {&__pyx_kp_53, __pyx_k_53, sizeof(__pyx_k_53), 0, 0, 0},
  {&__pyx_kp_54, __pyx_k_54, sizeof(__pyx_k_54), 0, 0, 0},
  {&__pyx_kp_55, __pyx_k_55, sizeof(__pyx_k_55), 0, 0, 0},
  {&__pyx_kp_56, __pyx_k_56, sizeof(__pyx_k_56), 0, 0, 0},
  {&__pyx_kp_57, __pyx_k_57, sizeof(__pyx_k_57), 0, 0, 0},
  {&__pyx_kp_58, __pyx_k_58, sizeof(__pyx_k_58), 0, 0, 0},
  {&__pyx_kp_59, __pyx_k_59, sizeof(__pyx_k_59), 0, 0, 0},
  {&__pyx_kp_60, __pyx_k_60, sizeof(__pyx_k_60), 0, 0, 0},
  {&__pyx_kp_68, __pyx_k_68, sizeof(__pyx_k_68), 0, 0, 0},
  {0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_property = __Pyx_GetName(__pyx_b, __pyx_kp_property); if (!__pyx_builtin_property) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_kp_range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_max = __Pyx_GetName(__pyx_b, __pyx_kp_max); if (!__pyx_builtin_max) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_NotImplemented = __Pyx_GetName(__pyx_b, __pyx_kp_NotImplemented); if (!__pyx_builtin_NotImplemented) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_NotImplementedError = __Pyx_GetName(__pyx_b, __pyx_kp_NotImplementedError); if (!__pyx_builtin_NotImplementedError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_enumerate = __Pyx_GetName(__pyx_b, __pyx_kp_enumerate); if (!__pyx_builtin_enumerate) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitGlobals(void) {
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_5 = PyInt_FromLong(5); if (unlikely(!__pyx_int_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC init_hermes2d(void); /*proto*/
PyMODINIT_FUNC init_hermes2d(void)
#else
PyMODINIT_FUNC PyInit__hermes2d(void); /*proto*/
PyMODINIT_FUNC PyInit__hermes2d(void)
#endif
{
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  #ifdef CYTHON_REFNANNY
  void* __pyx_refchk = NULL;
  __Pyx_Refnanny = __Pyx_ImportRefcountAPI("refnanny");
  if (!__Pyx_Refnanny) {
      PyErr_Clear();
      __Pyx_Refnanny = __Pyx_ImportRefcountAPI("Cython.Runtime.refnanny");
      if (!__Pyx_Refnanny)
          Py_FatalError("failed to import refnanny module");
  }
  __pyx_refchk = __Pyx_Refnanny->NewContext("PyMODINIT_FUNC PyInit__hermes2d(void)", __LINE__, __FILE__);
  #endif
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Library function declarations ---*/
  __pyx_init_filenames();
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4(__Pyx_NAMESTR("_hermes2d"), __pyx_methods, 0, 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_NAMESTR(__Pyx_BUILTIN_MODULE_NAME));
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__pyx_module_is_main_hermes2d___hermes2d) {
    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_kp___main__) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_skip_dispatch = 0;
  /*--- Global init code ---*/
  /*--- Function export code ---*/
  if (__Pyx_ExportFunction("H1Space_from_C", (void (*)(void))H1Space_from_C, "PyObject *(struct H1Space *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("Mesh_from_C", (void (*)(void))Mesh_from_C, "PyObject *(struct Mesh *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("LinSystem_from_C", (void (*)(void))LinSystem_from_C, "PyObject *(struct LinSystem *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("Solution_from_C", (void (*)(void))Solution_from_C, "PyObject *(struct Solution *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Type init code ---*/
  __pyx_ptype_8hermes2d_9_hermes2d_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject)); if (unlikely(!__pyx_ptype_8hermes2d_9_hermes2d_ndarray)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_LinSystem) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "LinSystem", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_LinSystem) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_LinSystem = &__pyx_type_8hermes2d_9_hermes2d_LinSystem;
  __pyx_type_8hermes2d_9_hermes2d_RefSystem.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_LinSystem;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_RefSystem) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "RefSystem", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_RefSystem) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_RefSystem = &__pyx_type_8hermes2d_9_hermes2d_RefSystem;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Solver) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Solver", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Solver) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Solver = &__pyx_type_8hermes2d_9_hermes2d_Solver;
  __pyx_type_8hermes2d_9_hermes2d_DummySolver.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Solver;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_DummySolver) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "DummySolver", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_DummySolver) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_DummySolver = &__pyx_type_8hermes2d_9_hermes2d_DummySolver;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_WeakForm) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "WeakForm", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_WeakForm) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_WeakForm = &__pyx_type_8hermes2d_9_hermes2d_WeakForm;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_H1Space) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "H1Space", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_H1Space) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_H1Space = &__pyx_type_8hermes2d_9_hermes2d_H1Space;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_L2Space) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "L2Space", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_L2Space) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_L2Space = &__pyx_type_8hermes2d_9_hermes2d_L2Space;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Transformable) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Transformable", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Transformable) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Transformable = &__pyx_type_8hermes2d_9_hermes2d_Transformable;
  __pyx_type_8hermes2d_9_hermes2d_Function.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Transformable;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Function) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Function", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Function) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Function = &__pyx_type_8hermes2d_9_hermes2d_Function;
  __pyx_type_8hermes2d_9_hermes2d_ScalarFunction.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Function;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_ScalarFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "ScalarFunction", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_ScalarFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_ScalarFunction = &__pyx_type_8hermes2d_9_hermes2d_ScalarFunction;
  __pyx_type_8hermes2d_9_hermes2d_MeshFunction.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_ScalarFunction;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_MeshFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "MeshFunction", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_MeshFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction = &__pyx_type_8hermes2d_9_hermes2d_MeshFunction;
  __pyx_type_8hermes2d_9_hermes2d_Solution.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Solution) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Solution", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Solution) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Solution = &__pyx_type_8hermes2d_9_hermes2d_Solution;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Linearizer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Linearizer", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Linearizer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Linearizer = &__pyx_type_8hermes2d_9_hermes2d_Linearizer;
  __pyx_type_8hermes2d_9_hermes2d_Vectorizer.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Linearizer;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Vectorizer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Vectorizer", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Vectorizer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Vectorizer = &__pyx_type_8hermes2d_9_hermes2d_Vectorizer;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "ProjBasedSelector", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_ProjBasedSelector = &__pyx_type_8hermes2d_9_hermes2d_ProjBasedSelector;
  __pyx_type_8hermes2d_9_hermes2d_H1ProjBasedSelector.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_ProjBasedSelector;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_H1ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "H1ProjBasedSelector", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_H1ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_H1ProjBasedSelector = &__pyx_type_8hermes2d_9_hermes2d_H1ProjBasedSelector;
  __pyx_type_8hermes2d_9_hermes2d_L2ProjBasedSelector.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_ProjBasedSelector;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_L2ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "L2ProjBasedSelector", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_L2ProjBasedSelector) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_L2ProjBasedSelector = &__pyx_type_8hermes2d_9_hermes2d_L2ProjBasedSelector;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Adapt", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Adapt = &__pyx_type_8hermes2d_9_hermes2d_Adapt;
  __pyx_type_8hermes2d_9_hermes2d_H1Adapt.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Adapt;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_H1Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "H1Adapt", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_H1Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_H1Adapt = &__pyx_type_8hermes2d_9_hermes2d_H1Adapt;
  __pyx_type_8hermes2d_9_hermes2d_L2Adapt.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Adapt;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_L2Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "L2Adapt", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_L2Adapt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_L2Adapt = &__pyx_type_8hermes2d_9_hermes2d_L2Adapt;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Mesh) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Mesh", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Mesh) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Mesh = &__pyx_type_8hermes2d_9_hermes2d_Mesh;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Nurbs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Nurbs", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Nurbs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Nurbs = &__pyx_type_8hermes2d_9_hermes2d_Nurbs;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_CurvMap) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "CurvMap", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_CurvMap) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_CurvMap = &__pyx_type_8hermes2d_9_hermes2d_CurvMap;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Node) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Node", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Node) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Node = &__pyx_type_8hermes2d_9_hermes2d_Node;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Element) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Element", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Element) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Element = &__pyx_type_8hermes2d_9_hermes2d_Element;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_H1Shapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "H1Shapeset", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_H1Shapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_H1Shapeset = &__pyx_type_8hermes2d_9_hermes2d_H1Shapeset;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_L2Shapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "L2Shapeset", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_L2Shapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_L2Shapeset = &__pyx_type_8hermes2d_9_hermes2d_L2Shapeset;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_PrecalcShapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "PrecalcShapeset", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_PrecalcShapeset) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_PrecalcShapeset = &__pyx_type_8hermes2d_9_hermes2d_PrecalcShapeset;
  __pyx_type_8hermes2d_9_hermes2d_Filter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_MeshFunction;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_Filter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Filter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_Filter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_Filter = &__pyx_type_8hermes2d_9_hermes2d_Filter;
  __pyx_type_8hermes2d_9_hermes2d_SimpleFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Filter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_SimpleFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "SimpleFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_SimpleFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter = &__pyx_type_8hermes2d_9_hermes2d_SimpleFilter;
  __pyx_type_8hermes2d_9_hermes2d_VonMisesFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_Filter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_VonMisesFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "VonMisesFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_VonMisesFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_VonMisesFilter = &__pyx_type_8hermes2d_9_hermes2d_VonMisesFilter;
  __pyx_type_8hermes2d_9_hermes2d_MagFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_MagFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "MagFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_MagFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_MagFilter = &__pyx_type_8hermes2d_9_hermes2d_MagFilter;
  __pyx_type_8hermes2d_9_hermes2d_DiffFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_DiffFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "DiffFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_DiffFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_DiffFilter = &__pyx_type_8hermes2d_9_hermes2d_DiffFilter;
  __pyx_type_8hermes2d_9_hermes2d_SumFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_SumFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "SumFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_SumFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_SumFilter = &__pyx_type_8hermes2d_9_hermes2d_SumFilter;
  __pyx_type_8hermes2d_9_hermes2d_SquareFilter.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_SimpleFilter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_SquareFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 858; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "SquareFilter", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_SquareFilter) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 858; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_SquareFilter = &__pyx_type_8hermes2d_9_hermes2d_SquareFilter;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_CandList) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "CandList", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_CandList) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_CandList = &__pyx_type_8hermes2d_9_hermes2d_CandList;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_SelOption) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "SelOption", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_SelOption) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_SelOption = &__pyx_type_8hermes2d_9_hermes2d_SelOption;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_View) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "View", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_View) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_View = &__pyx_type_8hermes2d_9_hermes2d_View;
  __pyx_type_8hermes2d_9_hermes2d_ScalarView.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_View;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_ScalarView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "ScalarView", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_ScalarView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_ScalarView = &__pyx_type_8hermes2d_9_hermes2d_ScalarView;
  __pyx_type_8hermes2d_9_hermes2d_BaseView.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_View;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_BaseView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "BaseView", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_BaseView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_BaseView = &__pyx_type_8hermes2d_9_hermes2d_BaseView;
  __pyx_type_8hermes2d_9_hermes2d_MeshView.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_View;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_MeshView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "MeshView", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_MeshView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_MeshView = &__pyx_type_8hermes2d_9_hermes2d_MeshView;
  __pyx_type_8hermes2d_9_hermes2d_OrderView.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_View;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_OrderView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "OrderView", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_OrderView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_OrderView = &__pyx_type_8hermes2d_9_hermes2d_OrderView;
  __pyx_type_8hermes2d_9_hermes2d_VectorView.tp_base = __pyx_ptype_8hermes2d_9_hermes2d_View;
  if (PyType_Ready(&__pyx_type_8hermes2d_9_hermes2d_VectorView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "VectorView", (PyObject *)&__pyx_type_8hermes2d_9_hermes2d_VectorView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8hermes2d_9_hermes2d_VectorView = &__pyx_type_8hermes2d_9_hermes2d_VectorView;
  /*--- Type import code ---*/
  __pyx_ptype_14_hermes_common_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject)); if (unlikely(!__pyx_ptype_14_hermes_common_ndarray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Function import code ---*/
  __pyx_2 = __Pyx_ImportModule("_hermes_common"); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_2, "c2numpy_int", (void (**)(void))&c2numpy_int, "PyObject *(int *, int)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_2, "c2numpy_double", (void (**)(void))&c2numpy_double, "PyObject *(double *, int)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_2, "PY_NEW", (void (**)(void))&__pyx_f_14_hermes_common_PY_NEW, "PyObject *(PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  /*--- Execution code ---*/

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":3
 * from _hermes_common cimport c2numpy_double, c2numpy_int
 * 
 * H2D_FN_DX = c_H2D_FN_DX             # <<<<<<<<<<<<<<
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_VAL = c_H2D_FN_VAL
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DX); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_15, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":4
 * 
 * H2D_FN_DX = c_H2D_FN_DX
 * H2D_FN_DY = c_H2D_FN_DY             # <<<<<<<<<<<<<<
 * H2D_FN_VAL = c_H2D_FN_VAL
 * H2D_FN_DX = c_H2D_FN_DX
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DY); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_16, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":5
 * H2D_FN_DX = c_H2D_FN_DX
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_VAL = c_H2D_FN_VAL             # <<<<<<<<<<<<<<
 * H2D_FN_DX = c_H2D_FN_DX
 * H2D_FN_DY = c_H2D_FN_DY
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_VAL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_17, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":6
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_VAL = c_H2D_FN_VAL
 * H2D_FN_DX = c_H2D_FN_DX             # <<<<<<<<<<<<<<
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_DXX = c_H2D_FN_DXX
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DX); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_15, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":7
 * H2D_FN_VAL = c_H2D_FN_VAL
 * H2D_FN_DX = c_H2D_FN_DX
 * H2D_FN_DY = c_H2D_FN_DY             # <<<<<<<<<<<<<<
 * H2D_FN_DXX = c_H2D_FN_DXX
 * H2D_FN_DYY = c_H2D_FN_DYY
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DY); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_16, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":8
 * H2D_FN_DX = c_H2D_FN_DX
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_DXX = c_H2D_FN_DXX             # <<<<<<<<<<<<<<
 * H2D_FN_DYY = c_H2D_FN_DYY
 * H2D_FN_DXY = c_H2D_FN_DXY
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DXX); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_18, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":9
 * H2D_FN_DY = c_H2D_FN_DY
 * H2D_FN_DXX = c_H2D_FN_DXX
 * H2D_FN_DYY = c_H2D_FN_DYY             # <<<<<<<<<<<<<<
 * H2D_FN_DXY = c_H2D_FN_DXY
 * H2D_FN_DEFAULT = c_H2D_FN_DEFAULT
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DYY); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_19, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":10
 * H2D_FN_DXX = c_H2D_FN_DXX
 * H2D_FN_DYY = c_H2D_FN_DYY
 * H2D_FN_DXY = c_H2D_FN_DXY             # <<<<<<<<<<<<<<
 * H2D_FN_DEFAULT = c_H2D_FN_DEFAULT
 * H2D_FN_ALL = c_H2D_FN_ALL
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DXY); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_20, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":11
 * H2D_FN_DYY = c_H2D_FN_DYY
 * H2D_FN_DXY = c_H2D_FN_DXY
 * H2D_FN_DEFAULT = c_H2D_FN_DEFAULT             # <<<<<<<<<<<<<<
 * H2D_FN_ALL = c_H2D_FN_ALL
 * H2D_EPS_NORMAL = c_H2D_EPS_NORMAL
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_DEFAULT); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_21, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":12
 * H2D_FN_DXY = c_H2D_FN_DXY
 * H2D_FN_DEFAULT = c_H2D_FN_DEFAULT
 * H2D_FN_ALL = c_H2D_FN_ALL             # <<<<<<<<<<<<<<
 * H2D_EPS_NORMAL = c_H2D_EPS_NORMAL
 * H2D_EPS_HIGH = c_H2D_EPS_HIGH
 */
  __pyx_t_1 = PyInt_FromLong(H2D_FN_ALL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_22, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":13
 * H2D_FN_DEFAULT = c_H2D_FN_DEFAULT
 * H2D_FN_ALL = c_H2D_FN_ALL
 * H2D_EPS_NORMAL = c_H2D_EPS_NORMAL             # <<<<<<<<<<<<<<
 * H2D_EPS_HIGH = c_H2D_EPS_HIGH
 * 
 */
  __pyx_t_1 = PyInt_FromLong(H2D_EPS_NORMAL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_23, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":14
 * H2D_FN_ALL = c_H2D_FN_ALL
 * H2D_EPS_NORMAL = c_H2D_EPS_NORMAL
 * H2D_EPS_HIGH = c_H2D_EPS_HIGH             # <<<<<<<<<<<<<<
 * 
 * H2D_TOTAL_ERROR_REL = c_H2D_TOTAL_ERROR_REL
 */
  __pyx_t_1 = PyInt_FromLong(H2D_EPS_HIGH); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_24, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":16
 * H2D_EPS_HIGH = c_H2D_EPS_HIGH
 * 
 * H2D_TOTAL_ERROR_REL = c_H2D_TOTAL_ERROR_REL             # <<<<<<<<<<<<<<
 * H2D_TOTAL_ERROR_ABS = c_H2D_TOTAL_ERROR_ABS
 * H2D_ELEMENT_ERROR_REL = c_H2D_ELEMENT_ERROR_REL
 */
  __pyx_t_1 = PyInt_FromLong(H2D_TOTAL_ERROR_REL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_25, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":17
 * 
 * H2D_TOTAL_ERROR_REL = c_H2D_TOTAL_ERROR_REL
 * H2D_TOTAL_ERROR_ABS = c_H2D_TOTAL_ERROR_ABS             # <<<<<<<<<<<<<<
 * H2D_ELEMENT_ERROR_REL = c_H2D_ELEMENT_ERROR_REL
 * H2D_ELEMENT_ERROR_ABS = c_H2D_ELEMENT_ERROR_ABS
 */
  __pyx_t_1 = PyInt_FromLong(H2D_TOTAL_ERROR_ABS); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_26, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":18
 * H2D_TOTAL_ERROR_REL = c_H2D_TOTAL_ERROR_REL
 * H2D_TOTAL_ERROR_ABS = c_H2D_TOTAL_ERROR_ABS
 * H2D_ELEMENT_ERROR_REL = c_H2D_ELEMENT_ERROR_REL             # <<<<<<<<<<<<<<
 * H2D_ELEMENT_ERROR_ABS = c_H2D_ELEMENT_ERROR_ABS
 * 
 */
  __pyx_t_1 = PyInt_FromLong(H2D_ELEMENT_ERROR_REL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_27, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":19
 * H2D_TOTAL_ERROR_ABS = c_H2D_TOTAL_ERROR_ABS
 * H2D_ELEMENT_ERROR_REL = c_H2D_ELEMENT_ERROR_REL
 * H2D_ELEMENT_ERROR_ABS = c_H2D_ELEMENT_ERROR_ABS             # <<<<<<<<<<<<<<
 * 
 * cdef class Nurbs:
 */
  __pyx_t_1 = PyInt_FromLong(H2D_ELEMENT_ERROR_ABS); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_28, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":25
 * 
 *     @property
 *     def degree(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.degree
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_degree); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_degree, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":29
 * 
 *     @property
 *     def np(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.np
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_np); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":33
 * 
 *     @property
 *     def pt(self):             # <<<<<<<<<<<<<<
 *         cdef double3 *pt = self.thisptr.pt
 *         cdef int np = self.thisptr.np
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_pt); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_pt, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":40
 * 
 *     @property
 *     def nk(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nk
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_nk); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_nk, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":44
 * 
 *     @property
 *     def kv(self):             # <<<<<<<<<<<<<<
 *         cdef double *kv = self.thisptr.kv
 *         cdef int nk = self.thisptr.nk
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_kv); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_kv, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":52
 * 
 *     @property
 *     def ref(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nk
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs, __pyx_kp_ref); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Nurbs->tp_dict, __pyx_kp_ref, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Nurbs);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":59
 * 
 *     @property
 *     def order(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.order
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CurvMap, __pyx_kp_order); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CurvMap->tp_dict, __pyx_kp_order, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CurvMap);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":63
 * 
 *     @property
 *     def toplevel(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.toplevel
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CurvMap, __pyx_kp_toplevel); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CurvMap->tp_dict, __pyx_kp_toplevel, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CurvMap);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":80
 * 
 *     @property
 *     def id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.id
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_id); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_id, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":84
 * 
 *     @property
 *     def ref(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.ref
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_ref); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_ref, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":88
 * 
 *     @property
 *     def type(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.type
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_type); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_type, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":92
 * 
 *     @property
 *     def bnd(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.bnd
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_bnd); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_bnd, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":96
 * 
 *     @property
 *     def marker(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.marker
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_marker); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_marker, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":100
 * 
 *     @property
 *     def used(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.used == 1
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_used); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_used, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":107
 * 
 *     @property
 *     def coord(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.x, self.thisptr.y
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node, __pyx_kp_coord); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Node->tp_dict, __pyx_kp_coord, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Node);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":114
 * 
 *     @property
 *     def id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.id
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_id); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_id, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":118
 * 
 *     @property
 *     def nvert(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.nvert
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_nvert); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_nvert, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":122
 * 
 *     @property
 *     def active(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.active == 1
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_active); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_active, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":126
 * 
 *     @property
 *     def used(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.used == 1
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_used); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_used, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":130
 * 
 *     @property
 *     def marker(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.marker
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_marker); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_marker, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":134
 * 
 *     @property
 *     def nodes_vertex(self):             # <<<<<<<<<<<<<<
 *         return [self.get_vertex_node(i) for i in range(self.nvert)]
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_nodes_vertex); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_nodes_vertex, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":138
 * 
 *     @property
 *     def nodes_vertex_id(self):             # <<<<<<<<<<<<<<
 *         return [node.id for node in self.nodes_vertex]
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_nodes_vertex_id); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_nodes_vertex_id, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":142
 * 
 *     @property
 *     def nodes_edge(self):             # <<<<<<<<<<<<<<
 *         return [self.get_edge_node(i) for i in range(self.nvert)]
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_nodes_edge); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_nodes_edge, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":151
 * 
 *     @property
 *     def curved_map(self):             # <<<<<<<<<<<<<<
 *         if self.thisptr.cm == NULL:
 *             return None
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element, __pyx_kp_curved_map); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Element->tp_dict, __pyx_kp_curved_map, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Element);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":206
 * 
 *     @property
 *     def elements_markers(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the list of elements (as ids) made up by their corresponding vertices,
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_elements_markers); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_elements_markers, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":261
 * 
 *     @property
 *     def elements(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the list of elements (as ids) made up by their corresponding vertices.
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_elements); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_elements, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":311
 * 
 *     @property
 *     def active_elements(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the list of active elements (as Element instances).
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_active_elements); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_active_elements, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":323
 * 
 *     @property
 *     def nodes(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a list of nodes coordinates.
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_nodes); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_nodes, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":347
 * 
 *     @property
 *     def nodes_dict(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a dict of all active nodes coordinates.
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_nodes_dict); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_nodes_dict, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":362
 * 
 *     @property
 *     def curves(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return curves
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_curves); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_curves, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":416
 * 
 *     @property
 *     def num_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_elements()
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_num_elements); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_num_elements, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":420
 * 
 *     @property
 *     def num_base_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_base_elements()
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_num_base_elements); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_num_base_elements, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":424
 * 
 *     @property
 *     def num_active_elements(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_num_active_elements()
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_num_active_elements); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_num_active_elements, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":428
 * 
 *     @property
 *     def max_element_id(self):             # <<<<<<<<<<<<<<
 *         return self.thisptr.get_max_element_id()
 * 
 */
  __pyx_1 = __Pyx_GetName((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh, __pyx_kp_max_element_id); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_1);
  __Pyx_GIVEREF(__pyx_1);
  __pyx_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_property, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_Mesh->tp_dict, __pyx_kp_max_element_id, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_Mesh);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":843
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_DiffFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)
 * 
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_17); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_k_29 = __pyx_t_3;
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_17); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_k_30 = __pyx_t_3;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":852
 * 
 *     def __cinit__(self, MeshFunction sln1, MeshFunction sln2,
 *             int item1=H2D_FN_VAL, int item2=H2D_FN_VAL):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_SumFilter(<c_MeshFunction *>sln1.thisptr, <c_MeshFunction *>sln2.thisptr, item1, item2)
 * 
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_17); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_k_31 = __pyx_t_3;
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_17); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 852; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_k_32 = __pyx_t_3;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":860
 * cdef class SquareFilter(SimpleFilter):
 * 
 *     def __cinit__(self, MeshFunction sln, int item=H2D_FN_VAL):             # <<<<<<<<<<<<<<
 *         self.thisptr = <c_Function *>new_SquareFilter(<c_MeshFunction *>sln.thisptr, item)
 * 
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_17); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_k_33 = __pyx_t_3;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1168
 * 	- HP_ANISO: H-, ANISO- and P-candidates. Orders are modified non-uniformly.
 *     """
 *     P_ISO = c_H2D_P_ISO             # <<<<<<<<<<<<<<
 *     P_ANISO = c_H2D_P_ANISO
 *     H_ISO = c_H2D_H_ISO
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_P_ISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_P_ISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1169
 *     """
 *     P_ISO = c_H2D_P_ISO
 *     P_ANISO = c_H2D_P_ANISO             # <<<<<<<<<<<<<<
 *     H_ISO = c_H2D_H_ISO
 *     H_ANISO = c_H2D_H_ANISO
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_P_ANISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_P_ANISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1170
 *     P_ISO = c_H2D_P_ISO
 *     P_ANISO = c_H2D_P_ANISO
 *     H_ISO = c_H2D_H_ISO             # <<<<<<<<<<<<<<
 *     H_ANISO = c_H2D_H_ANISO
 *     HP_ISO = c_H2D_HP_ISO
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_H_ISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_H_ISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1171
 *     P_ANISO = c_H2D_P_ANISO
 *     H_ISO = c_H2D_H_ISO
 *     H_ANISO = c_H2D_H_ANISO             # <<<<<<<<<<<<<<
 *     HP_ISO = c_H2D_HP_ISO
 *     HP_ANISO_H = c_H2D_HP_ANISO_H
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_H_ANISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_H_ANISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1172
 *     H_ISO = c_H2D_H_ISO
 *     H_ANISO = c_H2D_H_ANISO
 *     HP_ISO = c_H2D_HP_ISO             # <<<<<<<<<<<<<<
 *     HP_ANISO_H = c_H2D_HP_ANISO_H
 *     HP_ANISO_P = c_H2D_HP_ANISO_P
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_HP_ISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_HP_ISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1173
 *     H_ANISO = c_H2D_H_ANISO
 *     HP_ISO = c_H2D_HP_ISO
 *     HP_ANISO_H = c_H2D_HP_ANISO_H             # <<<<<<<<<<<<<<
 *     HP_ANISO_P = c_H2D_HP_ANISO_P
 *     HP_ANISO = c_H2D_HP_ANISO
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_HP_ANISO_H); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_HP_ANISO_H, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1174
 *     HP_ISO = c_H2D_HP_ISO
 *     HP_ANISO_H = c_H2D_HP_ANISO_H
 *     HP_ANISO_P = c_H2D_HP_ANISO_P             # <<<<<<<<<<<<<<
 *     HP_ANISO = c_H2D_HP_ANISO
 * 
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_HP_ANISO_P); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_HP_ANISO_P, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1175
 *     HP_ANISO_H = c_H2D_HP_ANISO_H
 *     HP_ANISO_P = c_H2D_HP_ANISO_P
 *     HP_ANISO = c_H2D_HP_ANISO             # <<<<<<<<<<<<<<
 * 
 * cdef class SelOption:
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_HP_ANISO); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_CandList->tp_dict, __pyx_kp_HP_ANISO, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_CandList);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1185
 * 	- APPLY_CONV_EXP_DOF: Use $d^c - d_0^c$, where $c$ is the convergence exponent, instead of $(d - d_0)^c$ to evaluate the score. This option is not set by default.
 *     """
 *     PREFER_SYMMETRIC_MESH = c_H2D_PREFER_SYMMETRIC_MESH             # <<<<<<<<<<<<<<
 *     APPLY_CONV_EXP_DOF = c_H2D_APPLY_CONV_EXP_DOF
 * 
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_PREFER_SYMMETRIC_MESH); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_SelOption->tp_dict, __pyx_kp_8, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_SelOption);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1186
 *     """
 *     PREFER_SYMMETRIC_MESH = c_H2D_PREFER_SYMMETRIC_MESH
 *     APPLY_CONV_EXP_DOF = c_H2D_APPLY_CONV_EXP_DOF             # <<<<<<<<<<<<<<
 * 
 * cdef class ProjBasedSelector:
 */
  __pyx_t_1 = PyInt_FromLong(RefinementSelectors::H2D_APPLY_CONV_EXP_DOF); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_8hermes2d_9_hermes2d_SelOption->tp_dict, __pyx_kp_APPLY_CONV_EXP_DOF, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  PyType_Modified(__pyx_ptype_8hermes2d_9_hermes2d_SelOption);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1293
 *         self.thisptr.set_solutions(slns, rslns)
 * 
 *     def calc_error(self, int error_flags = H2D_TOTAL_ERROR_REL | H2D_ELEMENT_ERROR_ABS):             # <<<<<<<<<<<<<<
 *         """ Calculates errors of elements and returns a total error.
 * 	    This method has to be called before the method adapt().
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_25); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_kp_28); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_2);
  __pyx_t_1 = PyNumber_Or(__pyx_1, __pyx_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __Pyx_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_t_3 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k_35 = __pyx_t_3;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1504
 * 
 *     def process_solution(self, MeshFunction xsln, MeshFunction ysln,
 *             int xitem=c_H2D_FN_VAL_0, int yitem=c_H2D_FN_VAL_0, double eps=c_H2D_EPS_LOW):             # <<<<<<<<<<<<<<
 *         (<c_Vectorizer *>(self.thisptr)).process_solution(
 *                 <c_MeshFunction *>xsln.thisptr, xitem,
 */
  __pyx_k_36 = H2D_FN_VAL_0;
  __pyx_k_37 = H2D_FN_VAL_0;
  __pyx_k_38 = H2D_EPS_LOW;

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1545
 *             self.thisptr.show(<c_MeshFunction *>s.thisptr, <double>eps)
 * 
 *     def show_mesh(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_mesh(show)
 * 
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_39 = __pyx_t_1;
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_k_39);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1548
 *         self.thisptr.show_mesh(show)
 * 
 *     def show_scale(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_scale(show)
 * 
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_40 = __pyx_t_1;
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_k_40);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1610
 *     #    delete(self.thisptr)
 * 
 *     def show(self, MeshFunction s1, MeshFunction s2, eps = 0.008):             # <<<<<<<<<<<<<<
 *         (<c_VectorView *>(self.thisptr)).show(<c_MeshFunction *>s1.thisptr, <c_MeshFunction *>s2.thisptr, eps)
 * 
 */
  __pyx_t_1 = PyFloat_FromDouble(0.0080000000000000002); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_44 = __pyx_t_1;
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_k_44);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1613
 *         (<c_VectorView *>(self.thisptr)).show(<c_MeshFunction *>s1.thisptr, <c_MeshFunction *>s2.thisptr, eps)
 * 
 *     def show_scale(self, show=True):             # <<<<<<<<<<<<<<
 *         self.thisptr.show_scale(show)
 * 
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_45 = __pyx_t_1;
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_k_45);

  /* "/home/sameer/hpfem/up_py/hermes2d/python/hermes2d/_hermes2d.pyx":1675
 * #    finish_glut_main_loop(False)
 * 
 * init_hermes2d_wrappers()             # <<<<<<<<<<<<<<
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_46); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_1);
  __pyx_t_1 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_1); __pyx_1 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "../../hermes_common/ref.pxd":1
 * # Taken for Cython 0.12.1, so that hermes_common compiles with older cythons             # <<<<<<<<<<<<<<
 * 
 * cdef extern from "Python.h":
 */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_1);
  __Pyx_XDECREF(__pyx_2);
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("hermes2d._hermes2d");
  Py_DECREF(__pyx_m); __pyx_m = 0;
  __pyx_L0:;
  __Pyx_FinishRefcountContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

static const char *__pyx_filenames[] = {
  "_hermes2d.pyx",
  "stringsource",
  "_hermes2d.pxd",
  "_hermes_common.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *number, *more_or_less;

    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    number = (num_expected == 1) ? "" : "s";
    PyErr_Format(PyExc_TypeError,
        #if PY_VERSION_HEX < 0x02050000
            "%s() takes %s %d positional argument%s (%d given)",
        #else
            "%s() takes %s %zd positional argument%s (%zd given)",
        #endif
        func_name, more_or_less, num_expected, number, num_found);
}

static INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key)))
        #endif
            goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    return 0;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}


static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AS_STRING(kw_name));
        #endif
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;

    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
        } else {
            #if PY_MAJOR_VERSION < 3
            if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key))) {
            #else
            if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key))) {
            #endif
                goto invalid_keyword_type;
            } else {
                for (name = first_kw_arg; *name; name++) {
                    #if PY_MAJOR_VERSION >= 3
                    if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                        PyUnicode_Compare(**name, key) == 0) break;
                    #else
                    if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                        _PyString_Eq(**name, key)) break;
                    #endif
                }
                if (*name) {
                    values[name-argnames] = value;
                } else {
                    /* unexpected keyword found */
                    for (name=argnames; name != first_kw_arg; name++) {
                        if (**name == key) goto arg_passed_twice;
                        #if PY_MAJOR_VERSION >= 3
                        if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                            PyUnicode_Compare(**name, key) == 0) goto arg_passed_twice;
                        #else
                        if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                            _PyString_Eq(**name, key)) goto arg_passed_twice;
                        #endif
                    }
                    if (kwds2) {
                        if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                    } else {
                        goto invalid_keyword;
                    }
                }
            }
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, **name);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
    PyErr_NormalizeException(type, value, tb);
    if (PyErr_Occurred())
        goto bad;
    Py_INCREF(*type);
    Py_INCREF(*value);
    Py_INCREF(*tb);
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = *type;
    tstate->exc_value = *value;
    tstate->exc_traceback = *tb;
    /* Make sure tstate is in a consistent state when we XDECREF
    these objects (XDECREF may run arbitrary code). */
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
    return 0;
bad:
    Py_XDECREF(*type);
    Py_XDECREF(*value);
    Py_XDECREF(*tb);
    return -1;
}


static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();

#if PY_MAJOR_VERSION >= 3
    /* Note: this is a temporary work-around to prevent crashes in Python 3.0 */
    if ((tstate->exc_type != NULL) & (tstate->exc_type != Py_None)) {
        tmp_type = tstate->exc_type;
        tmp_value = tstate->exc_value;
        tmp_tb = tstate->exc_traceback;
        PyErr_NormalizeException(&type, &value, &tb);
        PyErr_NormalizeException(&tmp_type, &tmp_value, &tmp_tb);
        tstate->exc_type = 0;
        tstate->exc_value = 0;
        tstate->exc_traceback = 0;
        PyException_SetContext(value, tmp_value);
        Py_DECREF(tmp_type);
        Py_XDECREF(tmp_tb);
    }
#endif

    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;

    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}


static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (Py_TYPE(obj) == type) return 1;
    }
    else {
        if (PyObject_TypeCheck(obj, type)) return 1;
    }
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
    return 0;
}

static INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
}

static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

#if PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject((char *)"stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_Print(PyObject *arg_tuple, int newline) {
    PyObject *f;
    PyObject* v;
    int i;

    if (!(f = __Pyx_GetStdout()))
        return -1;
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                return -1;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            return -1;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0 &&
                isspace(Py_CHARMASK(s[len-1])) &&
                s[len-1] != ' ')
                    PyFile_SoftSpace(f, 0);
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            return -1;
        PyFile_SoftSpace(f, 0);
    }
    return 0;
}

#else /* Python 3 has a print function */

static int __Pyx_Print(PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (!__pyx_print) {
        __pyx_print = __Pyx_GetAttrString(__pyx_b, "print");
        if (!__pyx_print)
            return -1;
    }
    if (!newline) {
        if (!__pyx_print_kwargs) {
            __pyx_print_kwargs = PyDict_New();
            if (!__pyx_print_kwargs)
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (!end_string)
                return -1;
            if (PyDict_SetItemString(__pyx_print_kwargs, "end", end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
}

#endif

#if PY_MAJOR_VERSION < 3

static int __Pyx_PrintOne(PyObject *o) {
    PyObject *f;
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_SoftSpace(f, 0)) {
        if (PyFile_WriteString(" ", f) < 0)
            return -1;
    }
    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
        return -1;
    if (PyFile_WriteString("\n", f) < 0)
        return -1;
    return 0;
    /* the line below is just to avoid compiler
     * compiler warnings about unused functions */
    return __Pyx_Print(NULL, 0);
}

#else /* Python 3 has a print function */

static int __Pyx_PrintOne(PyObject *o) {
    int res;
    PyObject* arg_tuple = PyTuple_New(1);
    if (unlikely(!arg_tuple))
        return -1;
    Py_INCREF(o);
    PyTuple_SET_ITEM(arg_tuple, 0, o);
    res = __Pyx_Print(arg_tuple, 1);
    Py_DECREF(arg_tuple);
    return res;
}

#endif

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = __Pyx_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunctionObjArgs(__import__,
        name, global_dict, empty_dict, list, NULL);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
        #if PY_VERSION_HEX < 0x02050000
                 "need more than %d value%s to unpack", (int)index,
        #else
                 "need more than %zd value%s to unpack", index,
        #endif
                 (index == 1) ? "" : "s");
}

static INLINE void __Pyx_RaiseTooManyValuesError(void) {
    PyErr_SetString(PyExc_ValueError, "too many values to unpack");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter, Py_ssize_t index) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred()) {
            __Pyx_RaiseNeedMoreValuesError(index);
        }
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_RaiseTooManyValuesError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                type = 0;
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) Py_TYPE(type);
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static INLINE int __Pyx_StrEq(const char *s1, const char *s2) {
     while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
     return *s1 == *s2;
}

static INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject* x) {
    if (sizeof(unsigned char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned char)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (unsigned char)-1;
            if (unlikely(val < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned char");
                return (unsigned char)-1;
            }
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to unsigned char");
            return (unsigned char)-1;
        }
        return (unsigned char)val;
    }
    return (unsigned char)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject* x) {
    if (sizeof(unsigned short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned short)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (unsigned short)-1;
            if (unlikely(val < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned short");
                return (unsigned short)-1;
            }
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to unsigned short");
            return (unsigned short)-1;
        }
        return (unsigned short)val;
    }
    return (unsigned short)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject* x) {
    if (sizeof(unsigned int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned int)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (unsigned int)-1;
            if (unlikely(val < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned int");
                return (unsigned int)-1;
            }
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to unsigned int");
            return (unsigned int)-1;
        }
        return (unsigned int)val;
    }
    return (unsigned int)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE char __Pyx_PyInt_AsChar(PyObject* x) {
    if (sizeof(char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(char)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (char)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to char");
            return (char)-1;
        }
        return (char)val;
    }
    return (char)__Pyx_PyInt_AsLong(x);
}

static INLINE short __Pyx_PyInt_AsShort(PyObject* x) {
    if (sizeof(short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(short)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (short)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to short");
            return (short)-1;
        }
        return (short)val;
    }
    return (short)__Pyx_PyInt_AsLong(x);
}

static INLINE int __Pyx_PyInt_AsInt(PyObject* x) {
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (int)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to int");
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject* x) {
    if (sizeof(signed char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed char)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (signed char)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to signed char");
            return (signed char)-1;
        }
        return (signed char)val;
    }
    return (signed char)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject* x) {
    if (sizeof(signed short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed short)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (signed short)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to signed short");
            return (signed short)-1;
        }
        return (signed short)val;
    }
    return (signed short)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject* x) {
    if (sizeof(signed int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed int)val)) {
            if (unlikely(val == -1 && PyErr_Occurred()))
                return (signed int)-1;
            PyErr_SetString(PyExc_OverflowError,
                           "value too large to convert to signed int");
            return (signed int)-1;
        }
        return (signed int)val;
    }
    return (signed int)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned long");
            return (unsigned long)-1;
        }
        return (unsigned long)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        if (unlikely(Py_SIZE(x) < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned long");
            return (unsigned long)-1;
        }
        return PyLong_AsUnsignedLong(x);
    } else {
        unsigned long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned long)-1;
        val = __Pyx_PyInt_AsUnsignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned PY_LONG_LONG");
            return (unsigned PY_LONG_LONG)-1;
        }
        return (unsigned PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        if (unlikely(Py_SIZE(x) < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned PY_LONG_LONG");
            return (unsigned PY_LONG_LONG)-1;
        }
        return PyLong_AsUnsignedLongLong(x);
    } else {
        unsigned PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE long __Pyx_PyInt_AsLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        return (long)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        return PyLong_AsLong(x);
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long)-1;
        val = __Pyx_PyInt_AsLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        return (PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        return PyLong_AsLongLong(x);
    } else {
        PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        return (signed long)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        return PyLong_AsLong(x);
    } else {
        signed long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed long)-1;
        val = __Pyx_PyInt_AsSignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject* x) {
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_CheckExact(x) || PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        return (signed PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_CheckExact(x) || PyLong_Check(x))) {
        return PyLong_AsLongLong(x);
    } else {
        signed PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsSignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig) {
#if PY_VERSION_HEX < 0x02050000
    char *api = (char *)"__pyx_capi__";
#else
    const char *api = "__pyx_capi__";
#endif
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;


    d = PyObject_GetAttrString(__pyx_m, api);
    if (!d) {
        PyErr_Clear();
        d = PyDict_New();
        if (!d)
            goto bad;
        Py_INCREF(d);
        if (PyModule_AddObject(__pyx_m, api, d) < 0)
            goto bad;
    }
    tmp.fp = f;
    cobj = PyCObject_FromVoidPtrAndDesc(tmp.p, (void *)sig, 0);
    if (!cobj)
        goto bad;
    if (PyDict_SetItemString(d, name, cobj) < 0)
        goto bad;
    Py_DECREF(cobj);
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(cobj);
    Py_XDECREF(d);
    return -1;
}

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    long size)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;

    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(class_name);
    #else
    py_name = PyUnicode_FromString(class_name);
    #endif
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;

    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(name);
    #else
    py_name = PyUnicode_FromString(name);
    #endif
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportFunction
#define __PYX_HAVE_RT_ImportFunction
static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
#if PY_VERSION_HEX < 0x02050000
    char *api = (char *)"__pyx_capi__";
#else
    const char *api = "__pyx_capi__";
#endif
    PyObject *d = 0;
    PyObject *cobj = 0;
    const char *desc;
    const char *s1, *s2;
    union {
        void (*fp)(void);
        void *p;
    } tmp;

    d = PyObject_GetAttrString(module, api);
    if (!d)
        goto bad;
    cobj = PyDict_GetItemString(d, funcname);
    if (!cobj) {
        PyErr_Format(PyExc_ImportError,
            "%s does not export expected C function %s",
                PyModule_GetName(module), funcname);
        goto bad;
    }
    desc = (const char *)PyCObject_GetDesc(cobj);
    if (!desc)
        goto bad;
    s1 = desc; s2 = sig;
    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
    if (*s1 != *s2) {
        PyErr_Format(PyExc_TypeError,
            "C function %s.%s has wrong signature (expected %s, got %s)",
             PyModule_GetName(module), funcname, sig, desc);
        goto bad;
    }
    tmp.p = PyCObject_AsVoidPtr(cobj);
    *f = tmp.fp;
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(d);
    return -1;
}
#endif

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    #if PY_MAJOR_VERSION < 3
    empty_string = PyString_FromStringAndSize("", 0);
    #else
    empty_string = PyBytes_FromStringAndSize("", 0);
    #endif
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode && (!t->is_identifier)) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_identifier || (t->is_unicode && t->intern)) {
            *t->p = PyUnicode_InternFromString(t->s);
        } else if (t->is_unicode) {
            *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

/* Type Conversion Functions */

static INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   if (x == Py_True) return 1;
   else if ((x == Py_False) | (x == Py_None)) return 0;
   else return PyObject_IsTrue(x);
}

static INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_VERSION_HEX < 0x03000000
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_VERSION_HEX < 0x03000000
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_VERSION_HEX < 0x03000000
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%s__ returned non-%s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}

static INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
#if PY_VERSION_HEX < 0x02050000
   if (ival <= LONG_MAX)
       return PyInt_FromLong((long)ival);
   else {
       unsigned char *bytes = (unsigned char *) &ival;
       int one = 1; int little = (int)*(unsigned char*)&one;
       return _PyLong_FromByteArray(bytes, sizeof(size_t), little, 0);
   }
#else
   return PyInt_FromSize_t(ival);
#endif
}

static INLINE size_t __Pyx_PyInt_AsSize_t(PyObject* x) {
   unsigned PY_LONG_LONG val = __Pyx_PyInt_AsUnsignedLongLong(x);
   if (unlikely(val == (unsigned PY_LONG_LONG)-1 && PyErr_Occurred())) {
       return (size_t)-1;
   } else if (unlikely(val != (unsigned PY_LONG_LONG)(size_t)val)) {
       PyErr_SetString(PyExc_OverflowError,
                       "value too large to convert to size_t");
       return (size_t)-1;
   }
   return (size_t)val;
}


